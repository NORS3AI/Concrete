import{_}from"./module-gl-DpMMjp0h.js";const _t={id:"concrete.estimating",name:"Estimating & Bid Management",description:"Estimate creation, assembly-based line items, markup/margin, bid solicitation, tabulation, estimate-to-budget transfer, historical cost database, and win/loss analysis",version:"1.0.0",phase:13,dependencies:["concrete.gl","concrete.entity","concrete.job"],collections:["job/estimate","job/estimateLine","job/bid"],routes:[{path:"/estimating",component:()=>_(()=>Promise.resolve().then(()=>Y),void 0,import.meta.url),title:"Estimates",icon:"calculator"},{path:"/estimating/new",component:()=>_(()=>Promise.resolve().then(()=>W),void 0,import.meta.url),title:"New Estimate",icon:"plus"},{path:"/estimating/:id",component:()=>_(()=>Promise.resolve().then(()=>W),void 0,import.meta.url),title:"Edit Estimate",icon:"edit"},{path:"/estimating/:id/lines",component:()=>_(()=>Promise.resolve().then(()=>ot),void 0,import.meta.url),title:"Estimate Lines",icon:"list"},{path:"/estimating/:id/bids",component:()=>_(()=>Promise.resolve().then(()=>st),void 0,import.meta.url),title:"Bid Solicitation",icon:"send"},{path:"/estimating/bid-tab",component:()=>_(()=>Promise.resolve().then(()=>xt),void 0,import.meta.url),title:"Bid Tabulation",icon:"columns"},{path:"/estimating/history",component:()=>_(()=>Promise.resolve().then(()=>gt),void 0,import.meta.url),title:"Cost History",icon:"database"},{path:"/estimating/win-loss",component:()=>_(()=>Promise.resolve().then(()=>Et),void 0,import.meta.url),title:"Win/Loss Analysis",icon:"bar-chart-2"}],navItems:[{id:"estimating",label:"Estimating",icon:"calculator",path:"/estimating",order:130},{id:"estimating-list",label:"Estimates",icon:"file-text",path:"/estimating",order:1,parent:"estimating"},{id:"estimating-new",label:"New Estimate",icon:"plus",path:"/estimating/new",order:2,parent:"estimating"},{id:"estimating-bid-tab",label:"Bid Tabulation",icon:"columns",path:"/estimating/bid-tab",order:3,parent:"estimating"},{id:"estimating-history",label:"Cost History",icon:"database",path:"/estimating/history",order:4,parent:"estimating"},{id:"estimating-win-loss",label:"Win/Loss",icon:"bar-chart-2",path:"/estimating/win-loss",order:5,parent:"estimating"}],dashboardWidgets:[],settings:[],permissions:[{resource:"estimate",actions:["create","read","update","delete","submit","export"],description:"Estimate management"},{resource:"estimate.line",actions:["create","read","update","delete","import"],description:"Estimate line management"},{resource:"estimate.bid",actions:["create","read","update","select","reject"],description:"Bid solicitation and tracking"},{resource:"estimate.budget",actions:["transfer"],description:"Estimate-to-budget transfer"},{resource:"estimate.report",actions:["read","export"],description:"Estimating reports (tabulation, win/loss, history)"}],workflows:[],importTypes:[{id:"estimate-lines",label:"Import Estimate Lines",collection:"job/estimateLine",fields:[{name:"description",type:"string",required:!0,label:"Description"},{name:"costType",type:"string",required:!0,label:"Cost Type (labor/material/equipment/subcontract/other)"},{name:"quantity",type:"number",label:"Quantity"},{name:"unit",type:"string",label:"Unit of Measure"},{name:"unitCost",type:"number",label:"Unit Cost"},{name:"amount",type:"number",label:"Amount"},{name:"markupPct",type:"number",label:"Markup %"},{name:"costCodeId",type:"string",label:"Cost Code ID"}],autoDetectHeaders:!0}],exportTypes:[{id:"estimate-lines",label:"Export Estimate Lines",collection:"job/estimateLine",defaultFields:["description","costType","quantity","unit","unitCost","amount","markupPct","markupAmount","totalPrice"]},{id:"estimate-summary",label:"Export Estimate Summary",collection:"job/estimate",defaultFields:["name","revision","status","totalCost","totalMarkup","totalPrice","marginPct","clientName","projectName","bidDate"]},{id:"bid-tabulation",label:"Export Bid Tabulation",collection:"job/bid",defaultFields:["trade","vendorId","amount","status","isLowBid","receivedDate","notes"]}],hooks:[]},I=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"}),H=r=>`${r.toFixed(1)}%`;function x(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const G=[{value:"",label:"All Statuses"},{value:"draft",label:"Draft"},{value:"submitted",label:"Submitted"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"withdrawn",label:"Withdrawn"}],N={draft:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20",submitted:"bg-blue-500/10 text-blue-400 border border-blue-500/20",won:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",lost:"bg-red-500/10 text-red-400 border border-red-500/20",withdrawn:"bg-amber-500/10 text-amber-400 border border-amber-500/20"};function q(r){const t=x("div","flex flex-wrap items-center gap-3 mb-4"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",n=x("input",d);n.type="text",n.placeholder="Search estimates...",t.appendChild(n);const a=x("select",d);for(const e of G){const o=x("option","",e.label);o.value=e.value,a.appendChild(o)}t.appendChild(a);const i=()=>r(a.value,n.value);return a.addEventListener("change",i),n.addEventListener("input",i),t}function Q(r){const t=x("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=x("table","w-full text-sm"),n=x("thead"),a=x("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const e of["Name","Rev","Status","Client","Project","Total Cost","Total Price","Margin","Bid Date","Actions"]){const o=["Total Cost","Total Price","Margin"].includes(e)?"py-2 px-3 font-medium text-right":"py-2 px-3 font-medium";a.appendChild(x("th",o,e))}n.appendChild(a),d.appendChild(n);const i=x("tbody");if(r.length===0){const e=x("tr"),o=x("td","py-8 px-3 text-center text-[var(--text-muted)]","No estimates found. Create your first estimate to get started.");o.setAttribute("colspan","10"),e.appendChild(o),i.appendChild(e)}for(const e of r){const o=x("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors"),p=x("td","py-2 px-3 font-medium"),m=x("a","text-[var(--accent)] hover:underline",e.name);m.href=`#/estimating/${e.id}`,p.appendChild(m),o.appendChild(p),o.appendChild(x("td","py-2 px-3 text-[var(--text-muted)]",String(e.revision)));const v=x("td","py-2 px-3"),C=x("span",`px-2 py-0.5 rounded-full text-xs font-medium ${N[e.status]??N.draft}`,e.status.charAt(0).toUpperCase()+e.status.slice(1));v.appendChild(C),o.appendChild(v),o.appendChild(x("td","py-2 px-3 text-[var(--text-muted)]",e.clientName)),o.appendChild(x("td","py-2 px-3 text-[var(--text-muted)]",e.projectName)),o.appendChild(x("td","py-2 px-3 text-right font-mono",I(e.totalCost))),o.appendChild(x("td","py-2 px-3 text-right font-mono",I(e.totalPrice)));const f=e.marginPct>=15?"text-emerald-400":e.marginPct>=5?"text-amber-400":"text-red-400";o.appendChild(x("td",`py-2 px-3 text-right font-mono ${f}`,H(e.marginPct))),o.appendChild(x("td","py-2 px-3 text-[var(--text-muted)]",e.bidDate??""));const g=x("td","py-2 px-3"),y=x("div","flex items-center gap-2"),L=x("a","text-[var(--accent)] hover:underline text-sm","Edit");L.href=`#/estimating/${e.id}`,y.appendChild(L);const S=x("a","text-[var(--accent)] hover:underline text-sm","Lines");S.href=`#/estimating/${e.id}/lines`,y.appendChild(S);const E=x("a","text-[var(--accent)] hover:underline text-sm","Bids");E.href=`#/estimating/${e.id}/bids`,y.appendChild(E),g.appendChild(y),o.appendChild(g),i.appendChild(o)}return d.appendChild(i),t.appendChild(d),t}const J={render(r){r.innerHTML="";const t=x("div","space-y-0"),d=x("div","flex items-center justify-between mb-4");d.appendChild(x("h1","text-2xl font-bold text-[var(--text)]","Estimates"));const n=x("a","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90");n.href="#/estimating/new",n.textContent="New Estimate",d.appendChild(n),t.appendChild(d),t.appendChild(q((i,e)=>{}));const a=[];t.appendChild(Q(a)),r.appendChild(t)}},Y=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));function u(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const K=[{value:"draft",label:"Draft"},{value:"submitted",label:"Submitted"},{value:"won",label:"Won"},{value:"lost",label:"Lost"},{value:"withdrawn",label:"Withdrawn"}];function w(r,t,d){const n=u("div",d===2?"col-span-2":"");return n.appendChild(u("label","block text-sm font-medium text-[var(--text-muted)] mb-1",r)),n.appendChild(t),n}function B(r,t){const d=u("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.type="text",d.name=r,t&&(d.placeholder=t),d}function j(r,t){const d=u("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.type="number",d.name=r,d.step="0.01",t&&(d.placeholder=t),d}function O(r){const t=u("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return t.type="date",t.name=r,t}function U(r,t){const d=u("select","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");d.name=r;for(const n of t){const a=u("option","",n.label);a.value=n.value,d.appendChild(a)}return d}function X(r,t){const d=u("textarea","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.name=r,d.rows=t,d}const Z={render(r){r.innerHTML="";const t=u("div","space-y-0"),d=u("div","flex items-center justify-between mb-6");d.appendChild(u("h1","text-2xl font-bold text-[var(--text)]","Estimate Details"));const n=u("a","text-sm text-[var(--text-muted)] hover:text-[var(--text)]","Back to Estimates");n.href="#/estimating",d.appendChild(n),t.appendChild(d);const a=u("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-6"),i=u("form","space-y-6");i.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mb-2","General Information"));const e=u("div","grid grid-cols-2 gap-4");e.appendChild(w("Estimate Name",B("name","Enter estimate name"))),e.appendChild(w("Job",U("jobId",[{value:"",label:"Select a job..."}]))),e.appendChild(w("Status",U("status",K))),e.appendChild(w("Revision",j("revision","1"))),e.appendChild(w("Client Name",B("clientName","Client name"))),e.appendChild(w("Project Name",B("projectName","Project name"))),e.appendChild(w("Description",X("description",3),2)),i.appendChild(e),i.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Bid Day Information"));const o=u("div","grid grid-cols-2 gap-4");o.appendChild(w("Bid Date",O("bidDate"))),o.appendChild(w("Submitted Date",O("submittedDate"))),o.appendChild(w("Created By",B("createdBy","Estimator name"))),i.appendChild(o),i.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Markup & Margin"));const p=u("div","grid grid-cols-2 gap-4");p.appendChild(w("Default Markup %",j("defaultMarkupPct","0"))),i.appendChild(p),i.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Totals"));const m=u("div","grid grid-cols-4 gap-4"),v=u("div","bg-[var(--surface)] border border-[var(--border)] rounded-md p-4 text-center");v.appendChild(u("div","text-xs text-[var(--text-muted)] uppercase tracking-wider","Total Cost")),v.appendChild(u("div","text-xl font-bold text-[var(--text)] mt-1 font-mono","$0.00")),m.appendChild(v);const C=u("div","bg-[var(--surface)] border border-[var(--border)] rounded-md p-4 text-center");C.appendChild(u("div","text-xs text-[var(--text-muted)] uppercase tracking-wider","Total Markup")),C.appendChild(u("div","text-xl font-bold text-[var(--text)] mt-1 font-mono","$0.00")),m.appendChild(C);const f=u("div","bg-[var(--surface)] border border-[var(--border)] rounded-md p-4 text-center");f.appendChild(u("div","text-xs text-[var(--text-muted)] uppercase tracking-wider","Total Price")),f.appendChild(u("div","text-xl font-bold text-[var(--text)] mt-1 font-mono","$0.00")),m.appendChild(f);const g=u("div","bg-[var(--surface)] border border-[var(--border)] rounded-md p-4 text-center");g.appendChild(u("div","text-xs text-[var(--text-muted)] uppercase tracking-wider","Margin")),g.appendChild(u("div","text-xl font-bold text-emerald-400 mt-1 font-mono","0.0%")),m.appendChild(g),i.appendChild(m),i.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Win/Loss Information"));const y=u("div","grid grid-cols-2 gap-4");y.appendChild(w("Lost Reason",B("lostReason","Reason for loss"))),y.appendChild(w("Competitor Name",B("competitorName","Winning competitor"))),y.appendChild(w("Competitor Price",j("competitorPrice","0.00"))),i.appendChild(y);const L=u("div","flex items-center gap-3 mt-6"),S=u("button","px-6 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Save Estimate");S.type="button",S.addEventListener("click",()=>{}),L.appendChild(S);const E=u("button","px-6 py-2 rounded-md text-sm font-medium bg-blue-600 text-white hover:opacity-90","Submit Estimate");E.type="button",E.addEventListener("click",()=>{}),L.appendChild(E);const A=u("button","px-6 py-2 rounded-md text-sm font-medium bg-zinc-600 text-white hover:opacity-90","Create Revision");A.type="button",A.addEventListener("click",()=>{}),L.appendChild(A);const D=u("button","px-6 py-2 rounded-md text-sm font-medium bg-emerald-600 text-white hover:opacity-90","Transfer to Budget");D.type="button",D.addEventListener("click",()=>{}),L.appendChild(D);const R=u("a","px-6 py-2 rounded-md text-sm font-medium text-[var(--text-muted)] hover:text-[var(--text)] border border-[var(--border)]","Cancel");R.href="#/estimating",L.appendChild(R),i.appendChild(L),a.appendChild(i),t.appendChild(a),r.appendChild(t)}},W=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"})),k=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"}),tt=r=>`${r.toFixed(1)}%`;function c(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const z={labor:"bg-blue-500/10 text-blue-400 border border-blue-500/20",material:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",equipment:"bg-amber-500/10 text-amber-400 border border-amber-500/20",subcontract:"bg-purple-500/10 text-purple-400 border border-purple-500/20",other:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20"};function et(r){const t=c("div","grid grid-cols-5 gap-4 mb-6"),d=["labor","material","equipment","subcontract","other"];for(const n of d){const i=r.filter(o=>o.costType===n&&!o.isAssembly&&!o.isAlternate).reduce((o,p)=>o+p.amount,0),e=c("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-md p-3 text-center");e.appendChild(c("div","text-xs text-[var(--text-muted)] uppercase tracking-wider",n.charAt(0).toUpperCase()+n.slice(1))),e.appendChild(c("div","text-lg font-bold text-[var(--text)] mt-1 font-mono",k(i))),t.appendChild(e)}return t}function dt(r){const t=c("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=c("table","w-full text-sm"),n=c("thead"),a=c("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const e of["#","Description","Type","Qty","Unit","Unit Cost","Amount","Markup %","Markup $","Total Price","Flags","Actions"]){const o=["Qty","Unit Cost","Amount","Markup %","Markup $","Total Price"].includes(e)?"py-2 px-2 font-medium text-right":"py-2 px-2 font-medium";a.appendChild(c("th",o,e))}n.appendChild(a),d.appendChild(n);const i=c("tbody");if(r.length===0){const e=c("tr"),o=c("td","py-8 px-2 text-center text-[var(--text-muted)]","No line items. Add lines manually or import from CSV.");o.setAttribute("colspan","12"),e.appendChild(o),i.appendChild(e)}for(const e of r){const o=!!e.parentId,p=e.isAssembly?"border-b border-[var(--border)] bg-[var(--surface)] font-semibold":`border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors ${o?"pl-4":""}`,m=c("tr",p);m.appendChild(c("td","py-2 px-2 text-[var(--text-muted)] font-mono text-xs",String(e.sortOrder)));const v=c("td",`py-2 px-2 text-[var(--text)] ${o?"pl-6":""}`);e.isAssembly?v.appendChild(c("span","text-[var(--accent)]",`[Assembly] ${e.assemblyName||e.description}`)):v.textContent=e.description,m.appendChild(v);const C=c("td","py-2 px-2"),f=c("span",`px-2 py-0.5 rounded-full text-xs font-medium ${z[e.costType]??z.other}`,e.costType);C.appendChild(f),m.appendChild(C),m.appendChild(c("td","py-2 px-2 text-right font-mono",e.isAssembly?"":String(e.quantity))),m.appendChild(c("td","py-2 px-2 text-right text-[var(--text-muted)]",e.unit)),m.appendChild(c("td","py-2 px-2 text-right font-mono",e.isAssembly?"":k(e.unitCost))),m.appendChild(c("td","py-2 px-2 text-right font-mono",k(e.amount))),m.appendChild(c("td","py-2 px-2 text-right font-mono",tt(e.markupPct))),m.appendChild(c("td","py-2 px-2 text-right font-mono",k(e.markupAmount))),m.appendChild(c("td","py-2 px-2 text-right font-mono font-semibold",k(e.totalPrice)));const g=c("td","py-2 px-2"),y=c("div","flex items-center gap-1");e.isAlternate&&y.appendChild(c("span","px-1.5 py-0.5 rounded text-xs bg-amber-500/10 text-amber-400","ALT")),e.isAllowance&&y.appendChild(c("span","px-1.5 py-0.5 rounded text-xs bg-cyan-500/10 text-cyan-400","ALLOW")),g.appendChild(y),m.appendChild(g);const L=c("td","py-2 px-2"),S=c("div","flex items-center gap-2"),E=c("button","text-[var(--accent)] hover:underline text-xs","Edit");E.addEventListener("click",()=>{}),S.appendChild(E);const A=c("button","text-red-400 hover:underline text-xs","Remove");A.addEventListener("click",()=>{}),S.appendChild(A),L.appendChild(S),m.appendChild(L),i.appendChild(m)}return d.appendChild(i),t.appendChild(d),t}function rt(){const r=c("div","flex flex-wrap items-center gap-3 mb-4"),t=c("button","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Add Line");t.addEventListener("click",()=>{}),r.appendChild(t);const d=c("button","px-4 py-2 rounded-md text-sm font-medium bg-zinc-600 text-white hover:opacity-90","Add Assembly");d.addEventListener("click",()=>{}),r.appendChild(d);const n=c("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Import CSV");n.addEventListener("click",()=>{}),r.appendChild(n);const a=c("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Export CSV");a.addEventListener("click",()=>{}),r.appendChild(a);const i=c("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Apply Overall Markup");return i.addEventListener("click",()=>{}),r.appendChild(i),r}const nt={render(r){r.innerHTML="";const t=c("div","space-y-0"),d=c("div","flex items-center justify-between mb-4");d.appendChild(c("h1","text-2xl font-bold text-[var(--text)]","Estimate Line Items"));const n=c("a","text-sm text-[var(--text-muted)] hover:text-[var(--text)]","Back to Estimate");n.href="#/estimating",d.appendChild(n),t.appendChild(d);const a=[];t.appendChild(et(a)),t.appendChild(rt()),t.appendChild(dt(a)),r.appendChild(t)}},ot=Object.freeze(Object.defineProperty({__proto__:null,default:nt},Symbol.toStringTag,{value:"Module"})),at=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"});function l(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const V={solicited:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20",received:"bg-blue-500/10 text-blue-400 border border-blue-500/20",selected:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",rejected:"bg-red-500/10 text-red-400 border border-red-500/20"};function it(){const r=l("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4 mb-6");r.appendChild(l("h3","text-md font-semibold text-[var(--text)] mb-3","Solicit New Bid"));const t="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",d=l("div","grid grid-cols-4 gap-3"),n=l("input",t);n.type="text",n.placeholder="Trade (e.g., Concrete, Steel)";const a=l("div");a.appendChild(l("label","block text-xs text-[var(--text-muted)] mb-1","Trade")),a.appendChild(n),d.appendChild(a);const i=l("input",t);i.type="text",i.placeholder="Vendor / Subcontractor";const e=l("div");e.appendChild(l("label","block text-xs text-[var(--text-muted)] mb-1","Vendor")),e.appendChild(i),d.appendChild(e);const o=l("input",t);o.type="text",o.placeholder="Scope description";const p=l("div");p.appendChild(l("label","block text-xs text-[var(--text-muted)] mb-1","Description")),p.appendChild(o),d.appendChild(p);const m=l("input",t);m.type="date";const v=l("div");v.appendChild(l("label","block text-xs text-[var(--text-muted)] mb-1","Expiration Date")),v.appendChild(m),d.appendChild(v),r.appendChild(d);const C=l("div","flex items-center gap-3 mt-3"),f=l("button","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Send Solicitation");return f.addEventListener("click",()=>{}),C.appendChild(f),r.appendChild(C),r}function pt(r){const t=l("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=l("table","w-full text-sm"),n=l("thead"),a=l("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const e of["Trade","Vendor","Description","Amount","Status","Received","Expires","Low Bid","Actions"]){const o=e==="Amount"?"py-2 px-3 font-medium text-right":"py-2 px-3 font-medium";a.appendChild(l("th",o,e))}n.appendChild(a),d.appendChild(n);const i=l("tbody");if(r.length===0){const e=l("tr"),o=l("td","py-8 px-3 text-center text-[var(--text-muted)]","No bids yet. Use the form above to solicit bids from subcontractors.");o.setAttribute("colspan","9"),e.appendChild(o),i.appendChild(e)}for(const e of r){const o=l("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors");o.appendChild(l("td","py-2 px-3 font-medium text-[var(--text)]",e.trade)),o.appendChild(l("td","py-2 px-3 text-[var(--text)]",e.vendorName)),o.appendChild(l("td","py-2 px-3 text-[var(--text-muted)]",e.description)),o.appendChild(l("td","py-2 px-3 text-right font-mono",e.amount>0?at(e.amount):"--"));const p=l("td","py-2 px-3"),m=l("span",`px-2 py-0.5 rounded-full text-xs font-medium ${V[e.status]??V.solicited}`,e.status.charAt(0).toUpperCase()+e.status.slice(1));p.appendChild(m),o.appendChild(p),o.appendChild(l("td","py-2 px-3 text-[var(--text-muted)]",e.receivedDate??"")),o.appendChild(l("td","py-2 px-3 text-[var(--text-muted)]",e.expirationDate??""));const v=l("td","py-2 px-3");e.isLowBid&&v.appendChild(l("span","px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20","LOW")),o.appendChild(v);const C=l("td","py-2 px-3"),f=l("div","flex items-center gap-2");if(e.status==="solicited"){const g=l("button","text-blue-400 hover:underline text-xs","Record Bid");g.addEventListener("click",()=>{}),f.appendChild(g)}if(e.status==="received"){const g=l("button","text-emerald-400 hover:underline text-xs","Select");g.addEventListener("click",()=>{}),f.appendChild(g);const y=l("button","text-red-400 hover:underline text-xs","Reject");y.addEventListener("click",()=>{}),f.appendChild(y)}C.appendChild(f),o.appendChild(C),i.appendChild(o)}return d.appendChild(i),t.appendChild(d),t}const lt={render(r){r.innerHTML="";const t=l("div","space-y-0"),d=l("div","flex items-center justify-between mb-4");d.appendChild(l("h1","text-2xl font-bold text-[var(--text)]","Bid Solicitation"));const n=l("a","text-sm text-[var(--text-muted)] hover:text-[var(--text)]","Back to Estimate");n.href="#/estimating",d.appendChild(n),t.appendChild(d),t.appendChild(it());const a=[];t.appendChild(pt(a)),r.appendChild(t)}},st=Object.freeze(Object.defineProperty({__proto__:null,default:lt},Symbol.toStringTag,{value:"Module"})),T=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"});function s(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const F={solicited:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20",received:"bg-blue-500/10 text-blue-400 border border-blue-500/20",selected:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",rejected:"bg-red-500/10 text-red-400 border border-red-500/20"};function ct(r){const t=s("div","flex items-center gap-3 mb-6"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]";t.appendChild(s("label","text-sm font-medium text-[var(--text)]","Select Estimate:"));const n=s("select",d),a=s("option","","Choose an estimate...");return a.value="",n.appendChild(a),t.appendChild(n),n.addEventListener("change",()=>{r(n.value)}),t}function mt(r){const t=s("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4 mb-4"),d=s("div","flex items-center justify-between mb-3");d.appendChild(s("h3","text-md font-semibold text-[var(--text)]",r.trade));const n=s("div","flex items-center gap-4 text-xs text-[var(--text-muted)]");n.appendChild(s("span","",`Low: ${r.lowBidAmount!==null?T(r.lowBidAmount):"--"}`)),n.appendChild(s("span","",`High: ${r.highBidAmount!==null?T(r.highBidAmount):"--"}`)),n.appendChild(s("span","",`Avg: ${T(r.averageBidAmount)}`)),n.appendChild(s("span","",`Spread: ${T(r.spread)}`)),d.appendChild(n),t.appendChild(d);const a=s("table","w-full text-sm"),i=s("thead"),e=s("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const p of["Vendor","Bid Amount","Status","Low Bid","Notes"]){const m=p==="Bid Amount"?"py-1 px-2 font-medium text-right":"py-1 px-2 font-medium";e.appendChild(s("th",m,p))}i.appendChild(e),a.appendChild(i);const o=s("tbody");for(const p of r.bids){const m=s("tr",`border-b border-[var(--border)] ${p.isLowBid?"bg-emerald-500/5":""}`);m.appendChild(s("td","py-1 px-2 text-[var(--text)]",p.vendorName)),m.appendChild(s("td","py-1 px-2 text-right font-mono",p.amount>0?T(p.amount):"--"));const v=s("td","py-1 px-2"),C=s("span",`px-2 py-0.5 rounded-full text-xs font-medium ${F[p.status]??F.solicited}`,p.status.charAt(0).toUpperCase()+p.status.slice(1));v.appendChild(C),m.appendChild(v);const f=s("td","py-1 px-2");p.isLowBid&&f.appendChild(s("span","px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20","LOW")),m.appendChild(f),m.appendChild(s("td","py-1 px-2 text-[var(--text-muted)] text-xs",p.notes)),o.appendChild(m)}return a.appendChild(o),t.appendChild(a),t}function ut(r){const t=s("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4 mb-6");t.appendChild(s("h3","text-md font-semibold text-[var(--text)] mb-3","Tabulation Summary"));const d=s("table","w-full text-sm"),n=s("thead"),a=s("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const e of["Trade","Bids Received","Low Bid","High Bid","Average","Spread"]){const o=["Low Bid","High Bid","Average","Spread"].includes(e)?"py-2 px-3 font-medium text-right":"py-2 px-3 font-medium";a.appendChild(s("th",o,e))}n.appendChild(a),d.appendChild(n);const i=s("tbody");for(const e of r){const o=e.bids.filter(m=>m.status==="received"||m.status==="selected").length,p=s("tr","border-b border-[var(--border)]");p.appendChild(s("td","py-2 px-3 font-medium text-[var(--text)]",e.trade)),p.appendChild(s("td","py-2 px-3 text-[var(--text-muted)]",String(o))),p.appendChild(s("td","py-2 px-3 text-right font-mono",e.lowBidAmount!==null?T(e.lowBidAmount):"--")),p.appendChild(s("td","py-2 px-3 text-right font-mono",e.highBidAmount!==null?T(e.highBidAmount):"--")),p.appendChild(s("td","py-2 px-3 text-right font-mono",T(e.averageBidAmount))),p.appendChild(s("td","py-2 px-3 text-right font-mono",T(e.spread))),i.appendChild(p)}return d.appendChild(i),t.appendChild(d),t}const bt={render(r){r.innerHTML="";const t=s("div","space-y-0"),d=s("div","flex items-center justify-between mb-4");d.appendChild(s("h1","text-2xl font-bold text-[var(--text)]","Bid Tabulation"));const n=s("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Export PDF");n.addEventListener("click",()=>{}),d.appendChild(n),t.appendChild(d),t.appendChild(ct(i=>{}));const a=[];t.appendChild(ut(a));for(const i of a)t.appendChild(mt(i));a.length===0&&t.appendChild(s("div","text-center py-12 text-[var(--text-muted)]","Select an estimate to view bid tabulation.")),r.appendChild(t)}},xt=Object.freeze(Object.defineProperty({__proto__:null,default:bt},Symbol.toStringTag,{value:"Module"})),M=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"});function h(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}const ht=[{value:"",label:"All Cost Types"},{value:"labor",label:"Labor"},{value:"material",label:"Material"},{value:"equipment",label:"Equipment"},{value:"subcontract",label:"Subcontract"},{value:"other",label:"Other"}];function vt(r){const t=h("div","flex flex-wrap items-center gap-3 mb-4"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",n=h("input",d);n.type="text",n.placeholder="Search by cost code...",t.appendChild(n);const a=h("select",d);for(const e of ht){const o=h("option","",e.label);o.value=e.value,a.appendChild(o)}t.appendChild(a);const i=()=>r(a.value,n.value);return a.addEventListener("change",i),n.addEventListener("input",i),t}function ft(r){const t=h("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=h("table","w-full text-sm"),n=h("thead"),a=h("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const e of["Cost Code","Description","Cost Type","Avg Unit Cost","Min Unit Cost","Max Unit Cost","Total Qty","Job Count"]){const o=["Avg Unit Cost","Min Unit Cost","Max Unit Cost","Total Qty","Job Count"].includes(e)?"py-2 px-3 font-medium text-right":"py-2 px-3 font-medium";a.appendChild(h("th",o,e))}n.appendChild(a),d.appendChild(n);const i=h("tbody");if(r.length===0){const e=h("tr"),o=h("td","py-8 px-3 text-center text-[var(--text-muted)]","No historical cost data available. Data is populated from won estimates.");o.setAttribute("colspan","8"),e.appendChild(o),i.appendChild(e)}for(const e of r){const o=h("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors");o.appendChild(h("td","py-2 px-3 font-mono text-[var(--text)]",e.costCodeId||"--")),o.appendChild(h("td","py-2 px-3 text-[var(--text)]",e.costCodeDescription||"--")),o.appendChild(h("td","py-2 px-3 text-[var(--text-muted)]",e.costType)),o.appendChild(h("td","py-2 px-3 text-right font-mono font-semibold text-[var(--accent)]",M(e.averageUnitCost))),o.appendChild(h("td","py-2 px-3 text-right font-mono text-emerald-400",M(e.minUnitCost))),o.appendChild(h("td","py-2 px-3 text-right font-mono text-red-400",M(e.maxUnitCost))),o.appendChild(h("td","py-2 px-3 text-right font-mono",String(e.totalQuantity))),o.appendChild(h("td","py-2 px-3 text-right font-mono",String(e.jobCount))),i.appendChild(o)}return d.appendChild(i),t.appendChild(d),t}const Ct={render(r){r.innerHTML="";const t=h("div","space-y-0"),d=h("div","flex items-center justify-between mb-4");d.appendChild(h("h1","text-2xl font-bold text-[var(--text)]","Historical Cost Database"));const n=h("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Export CSV");n.addEventListener("click",()=>{}),d.appendChild(n),t.appendChild(d),t.appendChild(h("p","text-sm text-[var(--text-muted)] mb-4","Average unit costs derived from won estimates. Use this data to benchmark new estimates against historical actuals.")),t.appendChild(vt((i,e)=>{}));const a=[];t.appendChild(ft(a)),r.appendChild(t)}},gt=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),$=r=>r.toLocaleString("en-US",{style:"currency",currency:"USD"}),P=r=>`${r.toFixed(1)}%`;function b(r,t,d){const n=document.createElement(r);return t&&(n.className=t),d!==void 0&&(n.textContent=d),n}function yt(r){const t=b("div","grid grid-cols-5 gap-4 mb-6"),d=(n,a,i,e)=>{const o=b("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4 text-center");return o.appendChild(b("div","text-xs text-[var(--text-muted)] uppercase tracking-wider",n)),o.appendChild(b("div",`text-2xl font-bold mt-1 font-mono ${e??"text-[var(--text)]"}`,a)),i&&o.appendChild(b("div","text-xs text-[var(--text-muted)] mt-1",i)),o};return t.appendChild(d("Win Rate",P(r.winRate),`${r.totalWon}W / ${r.totalLost}L`,r.winRate>=30?"text-emerald-400":"text-red-400")),t.appendChild(d("Total Estimates",String(r.totalEstimates),`${r.totalPending} pending`)),t.appendChild(d("Won Value",$(r.totalWonValue),void 0,"text-emerald-400")),t.appendChild(d("Lost Value",$(r.totalLostValue),void 0,"text-red-400")),t.appendChild(d("Avg Margin (Won)",P(r.averageMarginWon),`Lost avg: ${P(r.averageMarginLost)}`)),t}function wt(r){const t=b("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=b("table","w-full text-sm"),n=b("thead"),a=b("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const o of["Estimate","Client","Total Price","Margin","Status","Bid Date","Lost Reason","Competitor","Competitor $"]){const p=["Total Price","Margin","Competitor $"].includes(o)?"py-2 px-3 font-medium text-right":"py-2 px-3 font-medium";a.appendChild(b("th",p,o))}n.appendChild(a),d.appendChild(n);const i={draft:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20",submitted:"bg-blue-500/10 text-blue-400 border border-blue-500/20",won:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",lost:"bg-red-500/10 text-red-400 border border-red-500/20",withdrawn:"bg-amber-500/10 text-amber-400 border border-amber-500/20"},e=b("tbody");if(r.length===0){const o=b("tr"),p=b("td","py-8 px-3 text-center text-[var(--text-muted)]","No estimate data available for analysis.");p.setAttribute("colspan","9"),o.appendChild(p),e.appendChild(o)}for(const o of r){const p=b("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors"),m=b("td","py-2 px-3"),v=b("a","text-[var(--accent)] hover:underline",o.name);v.href=`#/estimating/${o.id}`,m.appendChild(v),p.appendChild(m),p.appendChild(b("td","py-2 px-3 text-[var(--text)]",o.clientName)),p.appendChild(b("td","py-2 px-3 text-right font-mono",$(o.totalPrice)));const C=o.marginPct>=15?"text-emerald-400":o.marginPct>=5?"text-amber-400":"text-red-400";p.appendChild(b("td",`py-2 px-3 text-right font-mono ${C}`,P(o.marginPct)));const f=b("td","py-2 px-3"),g=b("span",`px-2 py-0.5 rounded-full text-xs font-medium ${i[o.status]??i.draft}`,o.status.charAt(0).toUpperCase()+o.status.slice(1));f.appendChild(g),p.appendChild(f),p.appendChild(b("td","py-2 px-3 text-[var(--text-muted)]",o.bidDate??"")),p.appendChild(b("td","py-2 px-3 text-[var(--text-muted)]",o.lostReason??"")),p.appendChild(b("td","py-2 px-3 text-[var(--text-muted)]",o.competitorName??"")),p.appendChild(b("td","py-2 px-3 text-right font-mono",o.competitorPrice>0?$(o.competitorPrice):"")),e.appendChild(p)}return d.appendChild(e),t.appendChild(d),t}function Lt(r){const t=b("div","flex flex-wrap items-center gap-3 mb-4"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]";t.appendChild(b("label","text-sm text-[var(--text-muted)]","From:"));const n=b("input",d);n.type="date",t.appendChild(n),t.appendChild(b("label","text-sm text-[var(--text-muted)]","To:"));const a=b("input",d);a.type="date",t.appendChild(a);const i=b("button","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Apply");return i.addEventListener("click",()=>{r(n.value,a.value)}),t.appendChild(i),t}const St={render(r){r.innerHTML="";const t=b("div","space-y-0"),d=b("div","flex items-center justify-between mb-4");d.appendChild(b("h1","text-2xl font-bold text-[var(--text)]","Win/Loss Analysis"));const n=b("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text)] hover:bg-[var(--surface)]","Export Report");n.addEventListener("click",()=>{}),d.appendChild(n),t.appendChild(d),t.appendChild(Lt((e,o)=>{}));const a={totalEstimates:0,totalWon:0,totalLost:0,totalPending:0,winRate:0,totalWonValue:0,totalLostValue:0,averageMarginWon:0,averageMarginLost:0};t.appendChild(yt(a)),t.appendChild(b("h2","text-lg font-semibold text-[var(--text)] mb-3","Estimate Details"));const i=[];t.appendChild(wt(i)),r.appendChild(t)}},Et=Object.freeze(Object.defineProperty({__proto__:null,default:St},Symbol.toStringTag,{value:"Module"}));export{_t as e};
