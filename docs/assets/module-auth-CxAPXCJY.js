import{_}from"./module-gl-DpMMjp0h.js";const ke={id:"concrete.auth",name:"Authentication & Authorization",description:"User management, role-based access control, session management, API keys, audit logging, MFA, and security settings",version:"1.0.0",phase:16,dependencies:["concrete.entity"],collections:["auth/user","auth/role","auth/session","auth/apiKey","auth/auditLog"],routes:[{path:"/auth/users",component:()=>_(()=>Promise.resolve().then(()=>z),void 0,import.meta.url),title:"Users",icon:"users"},{path:"/auth/users/new",component:()=>_(()=>Promise.resolve().then(()=>M),void 0,import.meta.url),title:"New User",icon:"user-plus"},{path:"/auth/users/:id",component:()=>_(()=>Promise.resolve().then(()=>M),void 0,import.meta.url),title:"Edit User",icon:"edit"},{path:"/auth/roles",component:()=>_(()=>Promise.resolve().then(()=>X),void 0,import.meta.url),title:"Roles",icon:"shield"},{path:"/auth/roles/:id",component:()=>_(()=>Promise.resolve().then(()=>ae),void 0,import.meta.url),title:"Edit Role",icon:"edit"},{path:"/auth/sessions",component:()=>_(()=>Promise.resolve().then(()=>ue),void 0,import.meta.url),title:"Sessions",icon:"monitor"},{path:"/auth/api-keys",component:()=>_(()=>Promise.resolve().then(()=>he),void 0,import.meta.url),title:"API Keys",icon:"key"},{path:"/auth/audit-log",component:()=>_(()=>Promise.resolve().then(()=>we),void 0,import.meta.url),title:"Audit Log",icon:"list"},{path:"/auth/settings",component:()=>_(()=>Promise.resolve().then(()=>_e),void 0,import.meta.url),title:"Auth Settings",icon:"settings"}],navItems:[{id:"auth",label:"Auth",icon:"shield",path:"/auth/users",order:160},{id:"auth-users",label:"Users",icon:"users",path:"/auth/users",order:1,parent:"auth"},{id:"auth-roles",label:"Roles",icon:"shield",path:"/auth/roles",order:2,parent:"auth"},{id:"auth-sessions",label:"Sessions",icon:"monitor",path:"/auth/sessions",order:3,parent:"auth"},{id:"auth-api-keys",label:"API Keys",icon:"key",path:"/auth/api-keys",order:4,parent:"auth"},{id:"auth-audit-log",label:"Audit Log",icon:"list",path:"/auth/audit-log",order:5,parent:"auth"},{id:"auth-settings",label:"Settings",icon:"settings",path:"/auth/settings",order:6,parent:"auth"}],dashboardWidgets:[],settings:[],permissions:[{resource:"auth.user",actions:["create","read","update","delete","export"],description:"User management"},{resource:"auth.role",actions:["create","read","update","delete"],description:"Role management"},{resource:"auth.session",actions:["read","delete"],description:"Session management"},{resource:"auth.apiKey",actions:["create","read","delete"],description:"API key management"},{resource:"auth.auditLog",actions:["read","export"],description:"Audit log access"},{resource:"auth.settings",actions:["read","update"],description:"Auth settings management"}],workflows:[],importTypes:[],exportTypes:[{id:"auth-users",label:"Export Users",collection:"auth/user",defaultFields:["username","email","displayName","status","department","title"]},{id:"auth-audit-log",label:"Export Audit Log",collection:"auth/auditLog",defaultFields:["timestamp","username","action","resource","severity"]}],hooks:[]};function c(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}const $=[{value:"",label:"All Statuses"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"locked",label:"Locked"},{value:"pending",label:"Pending"}],F=[{value:"",label:"All Roles"},{value:"Admin",label:"Admin"},{value:"Controller",label:"Controller"},{value:"PM",label:"PM"},{value:"AP Clerk",label:"AP Clerk"},{value:"Payroll",label:"Payroll"},{value:"Field",label:"Field"},{value:"Read-Only",label:"Read-Only"}],U={active:"bg-emerald-500/10 text-emerald-400 border border-emerald-500/20",inactive:"bg-zinc-500/10 text-zinc-400 border border-zinc-500/20",locked:"bg-red-500/10 text-red-400 border border-red-500/20",pending:"bg-amber-500/10 text-amber-400 border border-amber-500/20"};function B(n){const e=c("div","flex flex-wrap items-center gap-3 mb-4"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",t=c("input",d);t.type="text",t.placeholder="Search users...",e.appendChild(t);const i=c("select",d);for(const a of $){const l=c("option","",a.label);l.value=a.value,i.appendChild(l)}e.appendChild(i);const o=c("select",d);for(const a of F){const l=c("option","",a.label);l.value=a.value,o.appendChild(l)}e.appendChild(o);const r=()=>n(i.value,o.value,t.value);return i.addEventListener("change",r),o.addEventListener("change",r),t.addEventListener("input",r),e}function G(n){const e=c("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=c("table","w-full text-sm"),t=c("thead"),i=c("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const r of["Username","Name","Email","Role","Department","Status","MFA","Last Login","Actions"])i.appendChild(c("th","py-2 px-3 font-medium",r));t.appendChild(i),d.appendChild(t);const o=c("tbody");if(n.length===0){const r=c("tr"),a=c("td","py-8 px-3 text-center text-[var(--text-muted)]","No users found. Create your first user to get started.");a.setAttribute("colspan","9"),r.appendChild(a),o.appendChild(r)}for(const r of n){const a=c("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors"),l=c("td","py-2 px-3 font-mono"),p=c("a","text-[var(--accent)] hover:underline",r.username);p.href=`#/auth/users/${r.id}`,l.appendChild(p),a.appendChild(l),a.appendChild(c("td","py-2 px-3 font-medium text-[var(--text)]",r.displayName)),a.appendChild(c("td","py-2 px-3 text-[var(--text-muted)]",r.email)),a.appendChild(c("td","py-2 px-3 text-[var(--text)]",r.role)),a.appendChild(c("td","py-2 px-3 text-[var(--text-muted)]",r.department));const s=c("td","py-2 px-3"),x=c("span",`px-2 py-0.5 rounded-full text-xs font-medium ${U[r.status]??U.active}`,r.status.charAt(0).toUpperCase()+r.status.slice(1));s.appendChild(x),a.appendChild(s);const h=c("td","py-2 px-3");r.mfaEnabled?h.appendChild(c("span","px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20","On")):h.appendChild(c("span","text-[var(--text-muted)] text-xs","Off")),a.appendChild(h),a.appendChild(c("td","py-2 px-3 text-[var(--text-muted)] text-xs",r.lastLogin||"Never"));const g=c("td","py-2 px-3"),S=c("a","text-[var(--accent)] hover:underline text-sm","Edit");S.href=`#/auth/users/${r.id}`,g.appendChild(S),a.appendChild(g),o.appendChild(a)}return d.appendChild(o),e.appendChild(d),e}function j(){const n=c("div","grid grid-cols-4 gap-4 mb-4"),e=(d,t,i)=>{const o=c("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4");return o.appendChild(c("div","text-sm text-[var(--text-muted)] mb-1",d)),o.appendChild(c("div",`text-xl font-bold ${i?"text-[var(--accent)]":"text-[var(--text)]"}`,t)),o};return n.appendChild(e("Total Users","0")),n.appendChild(e("Active","0",!0)),n.appendChild(e("Locked","0")),n.appendChild(e("Pending","0")),n}const q={render(n){n.innerHTML="";const e=c("div","space-y-0"),d=c("div","flex items-center justify-between mb-4");d.appendChild(c("h1","text-2xl font-bold text-[var(--text)]","Users"));const t=c("a","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90");t.href="#/auth/users/new",t.textContent="New User",d.appendChild(t),e.appendChild(d),e.appendChild(j()),e.appendChild(B((o,r,a)=>{}));const i=[];e.appendChild(G(i)),n.appendChild(e)}},z=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));function y(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}const K=[{value:"",label:"Select Role"},{value:"admin",label:"Admin"},{value:"controller",label:"Controller"},{value:"pm",label:"PM"},{value:"ap-clerk",label:"AP Clerk"},{value:"payroll",label:"Payroll"},{value:"field",label:"Field"},{value:"read-only",label:"Read-Only"}],V=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"locked",label:"Locked"},{value:"pending",label:"Pending"}],H=[{value:"none",label:"None (Password)"},{value:"saml",label:"SAML"},{value:"oidc",label:"OpenID Connect"},{value:"google",label:"Google"},{value:"microsoft",label:"Microsoft"}];function w(n,e,d){const t=y("div","");return t.appendChild(y("label","block text-sm font-medium text-[var(--text-muted)] mb-1",n)),t.appendChild(e),t}function E(n,e,d){const t=y("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return t.type=d??"text",t.name=n,e&&(t.placeholder=e),t}function I(n,e){const d=y("select","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");d.name=n;for(const t of e){const i=y("option","",t.label);i.value=t.value,d.appendChild(i)}return d}function J(n,e){const d=y("div","flex items-center gap-2"),t=y("input","rounded border-[var(--border)]");return t.type="checkbox",t.name=n,d.appendChild(t),d.appendChild(y("span","text-sm text-[var(--text)]",e)),d}const W={render(n){n.innerHTML="";const e=y("div","space-y-0"),d=y("div","flex items-center justify-between mb-6");d.appendChild(y("h1","text-2xl font-bold text-[var(--text)]","User Details"));const t=y("a","text-sm text-[var(--text-muted)] hover:text-[var(--text)]","Back to Users");t.href="#/auth/users",d.appendChild(t),e.appendChild(d);const i=y("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-6"),o=y("form","space-y-6");o.appendChild(y("h2","text-lg font-semibold text-[var(--text)] mb-2","Account Information"));const r=y("div","grid grid-cols-2 gap-4");r.appendChild(w("Username",E("username","Enter username"))),r.appendChild(w("Email",E("email","user@example.com","email"))),r.appendChild(w("Display Name",E("displayName","Full name"))),r.appendChild(w("Password",E("password","Set password","password"))),o.appendChild(r),o.appendChild(y("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Role & Status"));const a=y("div","grid grid-cols-2 gap-4");a.appendChild(w("Role",I("roleId",K))),a.appendChild(w("Status",I("status",V))),o.appendChild(a),o.appendChild(y("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Profile Information"));const l=y("div","grid grid-cols-2 gap-4");l.appendChild(w("Phone",E("phone","(555) 555-5555","tel"))),l.appendChild(w("Department",E("department","Department"))),l.appendChild(w("Title",E("title","Job title"))),l.appendChild(w("Avatar URL",E("avatar","https://"))),o.appendChild(l),o.appendChild(y("h2","text-lg font-semibold text-[var(--text)] mt-6 mb-2","Authentication"));const p=y("div","grid grid-cols-2 gap-4");p.appendChild(w("SSO Provider",I("ssoProvider",H))),p.appendChild(w("SSO External ID",E("ssoExternalId","External user ID")));const s=y("div","col-span-2 flex items-center gap-6 mt-2");s.appendChild(J("mfaEnabled","Enable Multi-Factor Authentication (MFA)")),p.appendChild(s),o.appendChild(p);const x=y("div","flex items-center gap-3 mt-6"),h=y("button","px-6 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Save User");h.type="button",h.addEventListener("click",()=>{}),x.appendChild(h);const g=y("button","px-6 py-2 rounded-md text-sm font-medium text-red-400 border border-red-400/30 hover:bg-red-400/10","Deactivate");g.type="button",g.addEventListener("click",()=>{}),x.appendChild(g);const S=y("a","px-6 py-2 rounded-md text-sm font-medium text-[var(--text-muted)] hover:text-[var(--text)] border border-[var(--border)]","Cancel");S.href="#/auth/users",x.appendChild(S),o.appendChild(x),i.appendChild(o),e.appendChild(i),n.appendChild(e)}},M=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));function C(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}function Y(n){const e=C("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=C("table","w-full text-sm"),t=C("thead"),i=C("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const r of["Name","Description","Type","Priority","Users","Permissions","Actions"]){const a=r==="Priority"||r==="Users"||r==="Permissions"?"py-2 px-3 font-medium text-center":"py-2 px-3 font-medium";i.appendChild(C("th",a,r))}t.appendChild(i),d.appendChild(t);const o=C("tbody");if(n.length===0){const r=C("tr"),a=C("td","py-8 px-3 text-center text-[var(--text-muted)]","No roles found. Initialize built-in roles to get started.");a.setAttribute("colspan","7"),r.appendChild(a),o.appendChild(r)}for(const r of n){const a=C("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors"),l=C("td","py-2 px-3 font-medium"),p=C("a","text-[var(--accent)] hover:underline",r.name);p.href=`#/auth/roles/${r.id}`,l.appendChild(p),a.appendChild(l),a.appendChild(C("td","py-2 px-3 text-[var(--text-muted)]",r.description));const s=C("td","py-2 px-3");r.isBuiltIn?s.appendChild(C("span","px-2 py-0.5 rounded-full text-xs font-medium bg-blue-500/10 text-blue-400 border border-blue-500/20","Built-in")):s.appendChild(C("span","px-2 py-0.5 rounded-full text-xs font-medium bg-zinc-500/10 text-zinc-400 border border-zinc-500/20","Custom")),a.appendChild(s),a.appendChild(C("td","py-2 px-3 text-center text-[var(--text)]",String(r.priority))),a.appendChild(C("td","py-2 px-3 text-center text-[var(--text)]",String(r.userCount))),a.appendChild(C("td","py-2 px-3 text-center text-[var(--text)]",String(r.permissionCount)));const x=C("td","py-2 px-3"),h=C("a","text-[var(--accent)] hover:underline text-sm","Edit");if(h.href=`#/auth/roles/${r.id}`,x.appendChild(h),!r.isBuiltIn){const g=C("button","text-red-400 hover:underline text-sm ml-2","Delete");g.type="button",g.addEventListener("click",()=>{}),x.appendChild(g)}a.appendChild(x),o.appendChild(a)}return d.appendChild(o),e.appendChild(d),e}const Q={render(n){n.innerHTML="";const e=C("div","space-y-0"),d=C("div","flex items-center justify-between mb-4");d.appendChild(C("h1","text-2xl font-bold text-[var(--text)]","Roles"));const t=C("div","flex items-center gap-2"),i=C("a","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90");i.href="#/auth/roles/new",i.textContent="New Role",t.appendChild(i);const o=C("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text-muted)] hover:text-[var(--text)]","Init Built-in Roles");o.type="button",o.addEventListener("click",()=>{}),t.appendChild(o),d.appendChild(t),e.appendChild(d);const r=[];e.appendChild(Y(r)),n.appendChild(e)}},X=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));function m(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}const Z=[{id:"gl.*",label:"General Ledger"},{id:"ap.*",label:"Accounts Payable"},{id:"ar.*",label:"Accounts Receivable"},{id:"payroll.*",label:"Payroll"},{id:"job.*",label:"Job Costing"},{id:"sub.*",label:"Subcontracts"},{id:"equip.*",label:"Equipment"},{id:"hr.employee",label:"HR / Employees"},{id:"safety.*",label:"Safety"},{id:"report.*",label:"Reports"},{id:"auth.user",label:"User Management"},{id:"auth.role",label:"Role Management"},{id:"auth.session",label:"Sessions"},{id:"auth.apiKey",label:"API Keys"},{id:"auth.auditLog",label:"Audit Log"},{id:"auth.settings",label:"Auth Settings"}],O=["create","read","update","delete","export","approve","admin"];function T(n,e){const d=m("div","");return d.appendChild(m("label","block text-sm font-medium text-[var(--text-muted)] mb-1",n)),d.appendChild(e),d}function ee(n,e){const d=m("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.type="text",d.name=n,d.placeholder=e,d}function te(n,e){const d=m("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.type="number",d.name=n,d.placeholder=e,d}function de(n,e){const d=m("textarea","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return d.name=n,d.rows=e,d}function re(){const n=m("div","mt-4");n.appendChild(m("h2","text-lg font-semibold text-[var(--text)] mb-3","Permissions")),n.appendChild(m("p","text-sm text-[var(--text-muted)] mb-4","Select the actions allowed for each resource. Check the boxes to grant access."));const e=m("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=m("table","w-full text-sm"),t=m("thead"),i=m("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");i.appendChild(m("th","py-2 px-3 font-medium","Resource"));for(const l of O){const p=m("th","py-2 px-3 font-medium text-center text-xs uppercase");p.textContent=l,i.appendChild(p)}t.appendChild(i),d.appendChild(t);const o=m("tbody");for(const l of Z){const p=m("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors");p.appendChild(m("td","py-2 px-3 text-[var(--text)] font-medium",l.label));for(const s of O){const x=m("td","py-2 px-3 text-center"),h=m("input","rounded border-[var(--border)] text-[var(--accent)]");h.type="checkbox",h.name=`perm_${l.id}_${s}`,h.dataset.resource=l.id,h.dataset.action=s,x.appendChild(h),p.appendChild(x)}o.appendChild(p)}const r=m("tr","border-t-2 border-[var(--border)] bg-[var(--surface)]"),a=m("td","py-2 px-3 text-[var(--text)] font-semibold","Select All");r.appendChild(a);for(const l of O){const p=m("td","py-2 px-3 text-center"),s=m("input","rounded border-[var(--border)] text-[var(--accent)]");s.type="checkbox",s.addEventListener("change",()=>{o.querySelectorAll(`input[data-action="${l}"]`).forEach(h=>{h.checked=s.checked})}),p.appendChild(s),r.appendChild(p)}return o.appendChild(r),d.appendChild(o),e.appendChild(d),n.appendChild(e),n}const ne={render(n){n.innerHTML="";const e=m("div","space-y-0"),d=m("div","flex items-center justify-between mb-6");d.appendChild(m("h1","text-2xl font-bold text-[var(--text)]","Role Details"));const t=m("a","text-sm text-[var(--text-muted)] hover:text-[var(--text)]","Back to Roles");t.href="#/auth/roles",d.appendChild(t),e.appendChild(d);const i=m("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-6"),o=m("form","space-y-6");o.appendChild(m("h2","text-lg font-semibold text-[var(--text)] mb-2","Role Information"));const r=m("div","grid grid-cols-2 gap-4");r.appendChild(T("Role Name",ee("name","Enter role name"))),r.appendChild(T("Priority",te("priority","0"))),o.appendChild(r),o.appendChild(T("Description",de("description",3))),o.appendChild(re());const a=m("div","flex items-center gap-3 mt-6"),l=m("button","px-6 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Save Role");l.type="button",l.addEventListener("click",()=>{}),a.appendChild(l);const p=m("a","px-6 py-2 rounded-md text-sm font-medium text-[var(--text-muted)] hover:text-[var(--text)] border border-[var(--border)]","Cancel");p.href="#/auth/roles",a.appendChild(p),o.appendChild(a),i.appendChild(o),e.appendChild(i),n.appendChild(e)}},ae=Object.freeze(Object.defineProperty({__proto__:null,default:ne},Symbol.toStringTag,{value:"Module"}));function b(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}function oe(n){return n?new Date(n).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}function ie(n){if(!n)return"N/A";const e=Date.now()-new Date(n).getTime(),d=Math.floor(e/6e4);if(d<1)return"Just now";if(d<60)return`${d}m ago`;const t=Math.floor(d/60);return t<24?`${t}h ago`:`${Math.floor(t/24)}d ago`}function le(){const n=b("div","grid grid-cols-3 gap-4 mb-4"),e=(d,t,i)=>{const o=b("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-4");return o.appendChild(b("div","text-sm text-[var(--text-muted)] mb-1",d)),o.appendChild(b("div",`text-xl font-bold ${i?"text-[var(--accent)]":"text-[var(--text)]"}`,t)),o};return n.appendChild(e("Active Sessions","0",!0)),n.appendChild(e("Unique Users","0")),n.appendChild(e("Expired (Today)","0")),n}function pe(n){const e=b("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=b("table","w-full text-sm"),t=b("thead"),i=b("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const r of["User","IP Address","User Agent","Last Activity","Expires At","Status","Actions"])i.appendChild(b("th","py-2 px-3 font-medium",r));t.appendChild(i),d.appendChild(t);const o=b("tbody");if(n.length===0){const r=b("tr"),a=b("td","py-8 px-3 text-center text-[var(--text-muted)]","No active sessions.");a.setAttribute("colspan","7"),r.appendChild(a),o.appendChild(r)}for(const r of n){const a=b("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors"),l=b("td","py-2 px-3");l.appendChild(b("div","font-medium text-[var(--text)]",r.displayName)),l.appendChild(b("div","text-xs text-[var(--text-muted)]",r.username)),a.appendChild(l),a.appendChild(b("td","py-2 px-3 font-mono text-[var(--text-muted)] text-xs",r.ipAddress||"Unknown"));const p=b("td","py-2 px-3 text-[var(--text-muted)] text-xs max-w-[200px] truncate");p.textContent=r.userAgent||"Unknown",p.title=r.userAgent||"Unknown",a.appendChild(p),a.appendChild(b("td","py-2 px-3 text-[var(--text-muted)] text-xs",ie(r.lastActivityAt))),a.appendChild(b("td","py-2 px-3 text-[var(--text-muted)] text-xs",oe(r.expiresAt)));const s=b("td","py-2 px-3");r.isActive?s.appendChild(b("span","px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20","Active")):s.appendChild(b("span","px-2 py-0.5 rounded-full text-xs font-medium bg-zinc-500/10 text-zinc-400 border border-zinc-500/20","Expired")),a.appendChild(s);const x=b("td","py-2 px-3");if(r.isActive){const h=b("button","text-red-400 hover:underline text-sm","Terminate");h.type="button",h.addEventListener("click",()=>{}),x.appendChild(h)}a.appendChild(x),o.appendChild(a)}return d.appendChild(o),e.appendChild(d),e}const se={render(n){n.innerHTML="";const e=b("div","space-y-0"),d=b("div","flex items-center justify-between mb-4");d.appendChild(b("h1","text-2xl font-bold text-[var(--text)]","Sessions"));const t=b("div","flex items-center gap-2"),i=b("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text-muted)] hover:text-[var(--text)]","Clean Expired");i.type="button",i.addEventListener("click",()=>{}),t.appendChild(i);const o=b("button","px-4 py-2 rounded-md text-sm font-medium text-red-400 border border-red-400/30 hover:bg-red-400/10","Terminate All");o.type="button",o.addEventListener("click",()=>{}),t.appendChild(o),d.appendChild(t),e.appendChild(d),e.appendChild(le());const r=[];e.appendChild(pe(r)),n.appendChild(e)}},ue=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));function u(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}function D(n){return n?new Date(n).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}function ce(){const n=u("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-6 mb-4");n.appendChild(u("h2","text-lg font-semibold text-[var(--text)] mb-4","Generate New API Key"));const e=u("div","grid grid-cols-3 gap-4"),d="w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",t=u("div","");t.appendChild(u("label","block text-sm font-medium text-[var(--text-muted)] mb-1","Key Name"));const i=u("input",d);i.type="text",i.placeholder="e.g., CI/CD Pipeline",t.appendChild(i),e.appendChild(t);const o=u("div","");o.appendChild(u("label","block text-sm font-medium text-[var(--text-muted)] mb-1","Expiry (days)"));const r=u("input",d);r.type="number",r.value="365",r.min="1",o.appendChild(r),e.appendChild(o);const a=u("div","flex items-end"),l=u("button","px-4 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Generate Key");l.type="button",l.addEventListener("click",()=>{}),a.appendChild(l),e.appendChild(a),n.appendChild(e);const p=u("div","mt-4 hidden");p.id="api-key-display";const s=u("div","bg-amber-500/10 border border-amber-500/20 rounded-md p-4");s.appendChild(u("div","text-sm font-medium text-amber-400 mb-2","Copy your API key now. It will not be shown again."));const x=u("code","block bg-[var(--surface)] rounded px-3 py-2 text-sm font-mono text-[var(--text)] select-all");return x.id="api-key-value",x.textContent="",s.appendChild(x),p.appendChild(s),n.appendChild(p),n}function xe(n){const e=u("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=u("table","w-full text-sm"),t=u("thead"),i=u("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const r of["Name","Key Prefix","User","Created","Expires","Last Used","Status","Actions"])i.appendChild(u("th","py-2 px-3 font-medium",r));t.appendChild(i),d.appendChild(t);const o=u("tbody");if(n.length===0){const r=u("tr"),a=u("td","py-8 px-3 text-center text-[var(--text-muted)]","No API keys found. Generate your first key above.");a.setAttribute("colspan","8"),r.appendChild(a),o.appendChild(r)}for(const r of n){const a=u("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors");a.appendChild(u("td","py-2 px-3 font-medium text-[var(--text)]",r.name)),a.appendChild(u("td","py-2 px-3 font-mono text-[var(--text-muted)] text-xs",r.keyPrefix+"...")),a.appendChild(u("td","py-2 px-3 text-[var(--text-muted)]",r.username)),a.appendChild(u("td","py-2 px-3 text-[var(--text-muted)] text-xs",D(r.createdAt))),a.appendChild(u("td","py-2 px-3 text-[var(--text-muted)] text-xs",D(r.expiresAt))),a.appendChild(u("td","py-2 px-3 text-[var(--text-muted)] text-xs",D(r.lastUsedAt)));const l=u("td","py-2 px-3");r.isRevoked?l.appendChild(u("span","px-2 py-0.5 rounded-full text-xs font-medium bg-red-500/10 text-red-400 border border-red-500/20","Revoked")):l.appendChild(u("span","px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-500/10 text-emerald-400 border border-emerald-500/20","Active")),a.appendChild(l);const p=u("td","py-2 px-3");if(!r.isRevoked){const s=u("button","text-red-400 hover:underline text-sm","Revoke");s.type="button",s.addEventListener("click",()=>{}),p.appendChild(s)}a.appendChild(p),o.appendChild(a)}return d.appendChild(o),e.appendChild(d),e}const me={render(n){n.innerHTML="";const e=u("div","space-y-0"),d=u("div","flex items-center justify-between mb-4");d.appendChild(u("h1","text-2xl font-bold text-[var(--text)]","API Keys")),d.appendChild(u("span","text-sm text-[var(--text-muted)]","Manage API keys for external integrations")),e.appendChild(d),e.appendChild(ce());const t=[];e.appendChild(xe(t)),n.appendChild(e)}},he=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));function v(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}function be(n){return n?new Date(n).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"N/A"}const N={info:"bg-blue-500/10 text-blue-400 border border-blue-500/20",warning:"bg-amber-500/10 text-amber-400 border border-amber-500/20",critical:"bg-red-500/10 text-red-400 border border-red-500/20"},ve=[{value:"",label:"All Actions"},{value:"login.success",label:"Login Success"},{value:"login.failed",label:"Login Failed"},{value:"logout",label:"Logout"},{value:"user.created",label:"User Created"},{value:"user.updated",label:"User Updated"},{value:"user.deactivated",label:"User Deactivated"},{value:"role.created",label:"Role Created"},{value:"role.updated",label:"Role Updated"},{value:"role.deleted",label:"Role Deleted"},{value:"password.changed",label:"Password Changed"},{value:"password.reset",label:"Password Reset"},{value:"mfa.enabled",label:"MFA Enabled"},{value:"mfa.disabled",label:"MFA Disabled"},{value:"apikey.created",label:"API Key Created"},{value:"apikey.revoked",label:"API Key Revoked"},{value:"settings.updated",label:"Settings Updated"}],fe=[{value:"",label:"All Severity"},{value:"info",label:"Info"},{value:"warning",label:"Warning"},{value:"critical",label:"Critical"}];function Ce(n){const e=v("div","flex flex-wrap items-center gap-3 mb-4"),d="bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]",t=v("input",d);t.type="text",t.placeholder="Filter by user...",e.appendChild(t);const i=v("select",d);for(const x of ve){const h=v("option","",x.label);h.value=x.value,i.appendChild(h)}e.appendChild(i);const o=v("select",d);for(const x of fe){const h=v("option","",x.label);h.value=x.value,o.appendChild(h)}e.appendChild(o);const r=v("span","text-sm text-[var(--text-muted)]","From:");e.appendChild(r);const a=v("input",d);a.type="date",e.appendChild(a);const l=v("span","text-sm text-[var(--text-muted)]","To:");e.appendChild(l);const p=v("input",d);p.type="date",e.appendChild(p);const s=()=>n(i.value,o.value,t.value,a.value,p.value);return i.addEventListener("change",s),o.addEventListener("change",s),t.addEventListener("input",s),a.addEventListener("change",s),p.addEventListener("change",s),e}function ye(n){const e=v("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg overflow-hidden"),d=v("table","w-full text-sm"),t=v("thead"),i=v("tr","text-left text-[var(--text-muted)] border-b border-[var(--border)]");for(const r of["Timestamp","Severity","User","Action","Resource","Details","IP Address"])i.appendChild(v("th","py-2 px-3 font-medium",r));t.appendChild(i),d.appendChild(t);const o=v("tbody");if(n.length===0){const r=v("tr"),a=v("td","py-8 px-3 text-center text-[var(--text-muted)]","No audit log entries found.");a.setAttribute("colspan","7"),r.appendChild(a),o.appendChild(r)}for(const r of n){const a=v("tr","border-b border-[var(--border)] hover:bg-[var(--surface)] transition-colors");a.appendChild(v("td","py-2 px-3 text-[var(--text-muted)] text-xs font-mono whitespace-nowrap",be(r.timestamp)));const l=v("td","py-2 px-3"),p=N[r.severity]??N.info;l.appendChild(v("span",`px-2 py-0.5 rounded-full text-xs font-medium ${p}`,r.severity.charAt(0).toUpperCase()+r.severity.slice(1))),a.appendChild(l),a.appendChild(v("td","py-2 px-3 text-[var(--text)]",r.username||"System")),a.appendChild(v("td","py-2 px-3 font-mono text-[var(--text)] text-xs",r.action));const s=v("td","py-2 px-3 text-[var(--text-muted)] text-xs");s.textContent=r.resource+(r.resourceId?` #${r.resourceId.slice(0,8)}`:""),a.appendChild(s);const x=v("td","py-2 px-3 text-[var(--text-muted)] text-xs max-w-[200px] truncate");x.textContent=r.details,x.title=r.details,a.appendChild(x),a.appendChild(v("td","py-2 px-3 font-mono text-[var(--text-muted)] text-xs",r.ipAddress||"-")),o.appendChild(a)}return d.appendChild(o),e.appendChild(d),e}const ge={render(n){n.innerHTML="";const e=v("div","space-y-0"),d=v("div","flex items-center justify-between mb-4");d.appendChild(v("h1","text-2xl font-bold text-[var(--text)]","Audit Log"));const t=v("button","px-4 py-2 rounded-md text-sm font-medium border border-[var(--border)] text-[var(--text-muted)] hover:text-[var(--text)]","Export CSV");t.type="button",t.addEventListener("click",()=>{}),d.appendChild(t),e.appendChild(d),e.appendChild(Ce((o,r,a,l,p)=>{}));const i=[];e.appendChild(ye(i)),n.appendChild(e)}},we=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));function f(n,e,d){const t=document.createElement(n);return e&&(t.className=e),d!==void 0&&(t.textContent=d),t}function k(n,e,d){const t=f("div","");return t.appendChild(f("label","block text-sm font-medium text-[var(--text-muted)] mb-1",n)),t.appendChild(e),d&&t.appendChild(f("p","text-xs text-[var(--text-muted)] mt-1",d)),t}function L(n,e,d){const t=f("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return t.type="number",t.name=n,t.value=e,d&&(t.min=d),t}function Ae(n,e,d){const t=f("input","w-full bg-[var(--surface)] border border-[var(--border)] rounded-md px-3 py-2 text-sm text-[var(--text)]");return t.type="text",t.name=n,t.value=e,t.placeholder=d,t}function A(n,e,d){const t=f("div","flex items-center gap-2"),i=f("input","rounded border-[var(--border)]");return i.type="checkbox",i.name=n,i.checked=d,t.appendChild(i),t.appendChild(f("span","text-sm text-[var(--text)]",e)),t}function P(n,e,d){const t=f("div","bg-[var(--surface-raised)] border border-[var(--border)] rounded-lg p-6");return t.appendChild(f("h2","text-lg font-semibold text-[var(--text)] mb-1",n)),t.appendChild(f("p","text-sm text-[var(--text-muted)] mb-4",e)),t.appendChild(d),t}const Se={render(n){n.innerHTML="";const e=f("div","space-y-6"),d=f("div","flex items-center justify-between mb-4");d.appendChild(f("h1","text-2xl font-bold text-[var(--text)]","Auth Settings")),e.appendChild(d);const t=f("div","grid grid-cols-2 gap-4");t.appendChild(k("Session Timeout (minutes)",L("sessionTimeoutMinutes","480","1"),"How long before an idle session expires.")),t.appendChild(k("Max Failed Login Attempts",L("maxFailedLoginAttempts","5","1"),"Number of failed attempts before account lockout.")),t.appendChild(k("Lockout Duration (minutes)",L("lockoutDurationMinutes","30","1"),"How long an account stays locked after exceeding max attempts.")),e.appendChild(P("Session & Lockout","Configure session timeout and account lockout policy.",t));const i=f("div","space-y-4"),o=f("div","grid grid-cols-2 gap-4");o.appendChild(k("Minimum Password Length",L("passwordMinLength","8","4"))),o.appendChild(k("Password Expiry (days)",L("passwordExpiryDays","90","0"),"Set to 0 for no expiry.")),i.appendChild(o);const r=f("div","flex flex-wrap gap-6 mt-2");r.appendChild(A("passwordRequireUppercase","Require uppercase letter",!0)),r.appendChild(A("passwordRequireLowercase","Require lowercase letter",!0)),r.appendChild(A("passwordRequireNumber","Require number",!0)),r.appendChild(A("passwordRequireSpecial","Require special character",!1)),i.appendChild(r),e.appendChild(P("Password Policy","Set password complexity and expiration requirements.",i));const a=f("div","space-y-4");a.appendChild(A("mfaRequired","Require MFA for all users",!1)),a.appendChild(f("p","text-xs text-[var(--text-muted)]","When enabled, all users must set up multi-factor authentication before accessing the system.")),e.appendChild(P("Multi-Factor Authentication","Configure MFA requirements.",a));const l=f("div","space-y-4"),p=f("div","flex flex-wrap gap-6");p.appendChild(A("sso_saml","SAML 2.0",!1)),p.appendChild(A("sso_oidc","OpenID Connect",!1)),p.appendChild(A("sso_google","Google",!1)),p.appendChild(A("sso_microsoft","Microsoft",!1)),l.appendChild(p),e.appendChild(P("Single Sign-On (SSO)","Enable SSO providers for federated authentication.",l));const s=f("div","grid grid-cols-2 gap-4");s.appendChild(k("Allowed Origins",Ae("corsAllowedOrigins","*","Comma-separated origins or * for all"),"CORS allowed origins for API requests.")),s.appendChild(k("Rate Limit (requests/min)",L("rateLimitRequestsPerMinute","100","1"),"Maximum API requests per minute per user.")),e.appendChild(P("CORS & Rate Limiting","Configure cross-origin access and request rate limits.",s));const x=f("div","grid grid-cols-2 gap-4");x.appendChild(k("Default API Key Expiry (days)",L("apiKeyExpiryDays","365","1"),"Default expiration for newly generated API keys.")),e.appendChild(P("API Keys","Configure default settings for API key generation.",x));const h=f("div","space-y-4");h.appendChild(A("encryptAtRest","Encrypt data at rest (localStorage)",!1)),h.appendChild(A("encryptExports","Encrypt exported files",!1)),h.appendChild(f("p","text-xs text-[var(--text-muted)]","Note: Client-side encryption provides limited security. For production use, enable server-side encryption.")),e.appendChild(P("Data Encryption","Configure encryption settings for stored data.",h));const g=f("div","flex items-center gap-3"),S=f("button","px-6 py-2 rounded-md text-sm font-medium bg-[var(--accent)] text-white hover:opacity-90","Save Settings");S.type="button",S.addEventListener("click",()=>{}),g.appendChild(S);const R=f("button","px-6 py-2 rounded-md text-sm font-medium text-[var(--text-muted)] hover:text-[var(--text)] border border-[var(--border)]","Reset to Defaults");R.type="button",R.addEventListener("click",()=>{}),g.appendChild(R),e.appendChild(g),n.appendChild(e)}},_e=Object.freeze(Object.defineProperty({__proto__:null,default:Se},Symbol.toStringTag,{value:"Module"}));export{ke as a};
