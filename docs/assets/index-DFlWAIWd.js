const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./indexeddb-B_pSjGdP.js","./vendor-idb-Dob3nYDb.js","./module-gl-DpMMjp0h.js"])))=>i.map(i=>d[i]);
import{_ as C,g as $}from"./module-gl-DpMMjp0h.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();class S{entries=[];maxEntries;minLevel;static LEVELS={debug:0,info:1,warn:2,error:3,fatal:4};constructor(e="info",t=500){this.minLevel=e,this.maxEntries=t}debug(e,t,n){this.log("debug",e,t,n)}info(e,t,n){this.log("info",e,t,n)}warn(e,t,n){this.log("warn",e,t,n)}error(e,t,n){this.log("error",e,t,n)}fatal(e,t,n){this.log("fatal",e,t,n)}log(e,t,n,r){if(S.LEVELS[e]<S.LEVELS[this.minLevel])return;let i;r instanceof Error&&(i=r.stack);const a={level:e,module:t,message:n,data:r instanceof Error?{name:r.name,message:r.message}:r,timestamp:Date.now(),stack:i};this.entries.push(a),this.entries.length>this.maxEntries&&this.entries.splice(0,this.entries.length-this.maxEntries);const o=`[${e.toUpperCase()}][${t}]`;switch(e){case"debug":console.debug(o,n,r??"");break;case"info":console.info(o,n,r??"");break;case"warn":console.warn(o,n,r??"");break;case"error":console.error(o,n,r??"");break;case"fatal":console.error(`${o} FATAL:`,n,r??"");break}}getEntries(e){let t=[...this.entries];if(e?.level){const n=S.LEVELS[e.level];t=t.filter(r=>S.LEVELS[r.level]>=n)}if(e?.module){const n=e.module;t=t.filter(r=>r.module===n)}return e?.limit&&e.limit>0&&(t=t.slice(-e.limit)),t}clear(){this.entries=[]}export(){return[...this.entries]}setLevel(e){this.minLevel=e}getLevel(){return this.minLevel}count(){return this.entries.length}}class L{logger;installed=!1;toastContainer=null;errorHandler=null;rejectionHandler=null;constructor(e){this.logger=e}install(){this.installed||(this.installed=!0,this.errorHandler=(e,t,n,r,i)=>{const a=i??new Error(typeof e=="string"?e:"Unknown error");return this.logger.error("ErrorBoundary",`Unhandled error: ${a.message}`,{source:t,lineno:n,colno:r,stack:a.stack}),this.showError(a,"Unhandled exception"),!0},window.onerror=this.errorHandler,this.rejectionHandler=e=>{const t=e.reason,n=t instanceof Error?t:new Error(String(t??"Unhandled promise rejection"));this.logger.error("ErrorBoundary",`Unhandled promise rejection: ${n.message}`,{stack:n.stack}),this.showError(n,"Unhandled promise rejection")},window.addEventListener("unhandledrejection",this.rejectionHandler))}uninstall(){this.installed&&(this.installed=!1,window.onerror=null,this.rejectionHandler&&(window.removeEventListener("unhandledrejection",this.rejectionHandler),this.rejectionHandler=null),this.errorHandler=null)}showFatalError(e){this.logger.fatal("ErrorBoundary",`Fatal error: ${e.message}`,e);const n=this.logger.getEntries({limit:50}).map(i=>{const a=new Date(i.timestamp).toISOString(),o=i.data?` | ${JSON.stringify(i.data)}`:"";return`<div style="font-family:monospace;font-size:12px;padding:2px 0;color:${this.getLevelColor(i.level)}">[${a}][${i.level.toUpperCase()}][${i.module}] ${this.escapeHtml(i.message)}${this.escapeHtml(o)}</div>`}).join(""),r=`
      <div style="
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        max-width: 800px;
        margin: 60px auto;
        padding: 40px;
        background: #1a1a2e;
        color: #e0e0e0;
        border-radius: 12px;
        border: 1px solid #333;
      ">
        <h1 style="color: #ff6b6b; margin-top: 0; font-size: 24px;">
          Something went wrong
        </h1>
        <p style="color: #aaa; font-size: 16px; line-height: 1.6;">
          The application encountered a fatal error and cannot continue.
          Please try reloading the page.
        </p>
        <div style="
          background: #0d0d1a;
          border-radius: 8px;
          padding: 16px;
          margin: 20px 0;
          overflow-x: auto;
        ">
          <code style="color: #ff6b6b; font-size: 14px;">
            ${this.escapeHtml(e.message)}
          </code>
          ${e.stack?`<pre style="color: #888; font-size: 12px; margin-top: 8px; white-space: pre-wrap;">${this.escapeHtml(e.stack)}</pre>`:""}
        </div>
        <div style="margin-top: 20px;">
          <button onclick="window.location.reload()" style="
            background: #4a90d9;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 8px;
          ">
            Reload Application
          </button>
          <button onclick="localStorage.removeItem('concrete_data'); window.location.reload()" style="
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
          ">
            Reset & Reload
          </button>
        </div>
        <details style="margin-top: 30px;">
          <summary style="cursor: pointer; color: #888; font-size: 14px;">
            Diagnostic Logs (last 50 entries)
          </summary>
          <div style="
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
            background: #0d0d1a;
            border-radius: 8px;
            padding: 12px;
          ">
            ${n||'<div style="color:#666;">No log entries available</div>'}
          </div>
        </details>
      </div>
    `;document.body.innerHTML=r}showError(e,t){this.logger.error("ErrorBoundary",t?`${t}: ${e.message}`:e.message,e),this.toastContainer||(this.toastContainer=document.createElement("div"),this.toastContainer.id="concrete-error-toasts",Object.assign(this.toastContainer.style,{position:"fixed",top:"16px",right:"16px",zIndex:"10000",display:"flex",flexDirection:"column",gap:"8px",maxWidth:"420px"}),document.body.appendChild(this.toastContainer));const n=document.createElement("div");Object.assign(n.style,{background:"#2d1b1b",color:"#ff8888",border:"1px solid #ff4444",borderRadius:"8px",padding:"12px 16px",fontSize:"14px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",boxShadow:"0 4px 12px rgba(0,0,0,0.3)",animation:"fadeIn 0.3s ease-out",position:"relative"});const r=t??"Error";n.innerHTML=`
      <div style="font-weight: 600; margin-bottom: 4px;">${this.escapeHtml(r)}</div>
      <div style="color: #cc8888; font-size: 13px;">${this.escapeHtml(e.message)}</div>
      <button style="
        position: absolute;
        top: 8px;
        right: 8px;
        background: none;
        border: none;
        color: #ff8888;
        cursor: pointer;
        font-size: 16px;
        padding: 0;
        line-height: 1;
      " aria-label="Dismiss">&times;</button>
    `;const i=n.querySelector("button");i&&i.addEventListener("click",()=>{this.dismissToast(n)}),this.toastContainer.appendChild(n),setTimeout(()=>{this.dismissToast(n)},8e3)}dismissToast(e){e.parentElement&&(e.style.opacity="0",e.style.transition="opacity 0.3s ease-out",setTimeout(()=>{e.remove(),this.toastContainer&&this.toastContainer.children.length===0&&(this.toastContainer.remove(),this.toastContainer=null)},300))}escapeHtml(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,n=>t[n]??n)}getLevelColor(e){switch(e){case"debug":return"#888";case"info":return"#4a90d9";case"warn":return"#f0ad4e";case"error":return"#ff6b6b";case"fatal":return"#ff0000";default:return"#ccc"}}}class M{config={};storageKey="concrete_config";events;constructor(e){this.events=e}async load(){const e=localStorage.getItem(this.storageKey);if(e)try{this.config=JSON.parse(e)}catch{this.config=this.getDefaults(),this.persist()}else this.config=this.getDefaults()}get(e,t){const n=e.split(".");let r=this.config;for(const i of n){if(r==null||typeof r!="object")return t;r=r[i]}return r??t}set(e,t){const n=e.split(".");let r=this.config;for(let i=0;i<n.length-1;i++)n[i]in r||(r[n[i]]={}),r=r[n[i]];r[n[n.length-1]]=t,this.persist(),this.events.emit("config.changed",{key:e,value:t})}getAll(){return{...this.config}}reset(){this.config=this.getDefaults(),this.persist()}export(){return JSON.stringify(this.config,null,2)}import(e){this.config=JSON.parse(e),this.persist()}persist(){localStorage.setItem(this.storageKey,JSON.stringify(this.config))}getDefaults(){return{org:{name:"My Company",currency:"USD",fiscalYearStart:1,dateFormat:"MM/DD/YYYY",mode:"full"},locale:"en-US",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,theme:"dark",features:{intercompanyElimination:!0,budgetTracking:!0,alertsEnabled:!0,fuzzyMatching:!0,anomalyDetection:!1},ui:{sidebarCollapsed:!1,defaultPeriod:"ytd",defaultEntity:"__all__"}}}}class O{config;constructor(e){this.config=e}isEnabled(e){return this.config.get(`features.${e}`,!1)}enable(e){this.config.set(`features.${e}`,!0)}disable(e){this.config.set(`features.${e}`,!1)}toggle(e){const t=this.isEnabled(e);return t?this.disable(e):this.enable(e),!t}getAll(){return{...this.config.get("features",{})}}}class _{mode;buildTarget;isDev;isProd;isStaging;isStatic;hasBackend;constructor(){this.mode="production",this.buildTarget="static",this.isDev=this.mode==="development",this.isProd=this.mode==="production",this.isStaging=this.mode==="staging",this.isStatic=this.buildTarget==="static",this.hasBackend=this.buildTarget==="cloudflare"||this.buildTarget==="php"}}let x=0;function A(){return x+=1,`listener_${x}`}function R(s,e){if(s==="*")return!0;const n="^"+s.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")+"$";return new RegExp(n).test(e)}class B{listeners;history;maxHistory;constructor(e=1e3){this.listeners=new Map,this.history=[],this.maxHistory=e}emit(e,t){this.recordHistory(e,t);const n=this.collectHandlers(e);for(const r of n){try{const i=r.handler(t);i&&typeof i.catch=="function"&&i.catch(()=>{})}catch{}r.once&&this.removeListener(r.pattern,r.id)}}async emitAsync(e,t){this.recordHistory(e,t);const n=this.collectHandlers(e),r=[];for(const i of n){try{const a=i.handler(t);a&&typeof a.then=="function"&&r.push(a)}catch(a){r.push(Promise.reject(a))}i.once&&this.removeListener(i.pattern,i.id)}await Promise.all(r)}on(e,t,n=0){const r={id:A(),handler:t,priority:n,once:!1};return this.addListener(e,r),()=>{this.removeListener(e,r.id)}}once(e,t,n=0){const r={id:A(),handler:t,priority:n,once:!0};return this.addListener(e,r),()=>{this.removeListener(e,r.id)}}off(e){this.listeners.delete(e)}clear(){this.listeners.clear()}getHistory(e){return e?this.history.filter(t=>t.event===e?!0:e.includes("*")?R(e,t.event):!1):[...this.history]}debounce(e,t){let n=null;return r=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{n=null,this.emit(e,r)},t)}}throttle(e,t){let n=0,r=null;return i=>{const a=Date.now(),o=a-n;o>=t?(n=a,this.emit(e,i)):r===null&&(r=setTimeout(()=>{n=Date.now(),r=null,this.emit(e,i)},t-o))}}addListener(e,t){const n=this.listeners.get(e);n?n.push(t):this.listeners.set(e,[t])}removeListener(e,t){const n=this.listeners.get(e);if(!n)return;const r=n.findIndex(i=>i.id===t);r!==-1&&n.splice(r,1),n.length===0&&this.listeners.delete(e)}collectHandlers(e){const t=[];for(const[n,r]of this.listeners){const i=n===e,a=!i&&n.includes("*")&&R(n,e);if(i||a)for(const o of r)t.push({...o,pattern:n,isExact:i})}return t.sort((n,r)=>r.priority!==n.priority?r.priority-n.priority:n.isExact&&!r.isExact?-1:!n.isExact&&r.isExact?1:0),t}recordHistory(e,t){this.history.push({event:e,payload:t,timestamp:Date.now()}),this.history.length>this.maxHistory&&(this.history=this.history.slice(this.history.length-this.maxHistory))}}function v(s,e){const t=e.split(".");let n=s;for(const r of t){if(n==null||typeof n!="object")return;n=n[r]}return n}function F(s,e){const t=v(s,e.field),n=e.value;switch(e.operator){case"=":return t===n;case"!=":return t!==n;case">":return t>n;case"<":return t<n;case">=":return t>=n;case"<=":return t<=n;case"in":return Array.isArray(n)&&n.includes(t);case"notIn":return Array.isArray(n)&&!n.includes(t);case"contains":return typeof t=="string"&&typeof n=="string"&&t.includes(n);case"startsWith":return typeof t=="string"&&typeof n=="string"&&t.startsWith(n);case"between":{if(!Array.isArray(n)||n.length!==2)return!1;const r=t;return r>=n[0]&&r<=n[1]}case"isNull":return t==null;case"isNotNull":return t!=null;default:return e.operator,!1}}function k(s,e){return s.filter(t=>e.every(n=>F(t,n)))}function H(s,e){const t=[...s];return t.sort((n,r)=>{for(const{field:i,direction:a}of e){const o=v(n,i),l=v(r,i);let c=0;if(o==null&&l==null?c=0:o==null?c=-1:l==null?c=1:typeof o=="string"&&typeof l=="string"?c=o.localeCompare(l):typeof o=="number"&&typeof l=="number"?c=o-l:c=String(o).localeCompare(String(l)),c!==0)return a==="desc"?-c:c}return 0}),t}const N="concrete",U=100;class z{cache=new Map;loaded=!1;persistTimer=null;ensureLoaded(){if(!this.loaded){try{const e=localStorage.getItem(N);if(e){const t=JSON.parse(e);for(const[n,r]of Object.entries(t))Array.isArray(r)&&this.cache.set(n,r)}}catch{this.cache.clear()}this.loaded=!0}}schedulePersist(){this.persistTimer!==null&&clearTimeout(this.persistTimer),this.persistTimer=setTimeout(()=>{this.persistTimer=null,this.persistNow()},U)}persistNow(){const e={};for(const[t,n]of this.cache.entries())e[t]=n;try{localStorage.setItem(N,JSON.stringify(e))}catch(t){if(t instanceof DOMException&&(t.name==="QuotaExceededError"||t.code===22))console.warn("[LocalStorageAdapter] localStorage quota exceeded. Data persisted only in memory.");else throw t}}flush(){this.persistTimer!==null&&(clearTimeout(this.persistTimer),this.persistTimer=null),this.persistNow()}getCollection(e){return this.ensureLoaded(),this.cache.has(e)||this.cache.set(e,[]),this.cache.get(e)}async get(e,t){return this.getCollection(e).find(r=>r.id===t)??null}async getAll(e){return[...this.getCollection(e)]}async insert(e,t){const n=this.getCollection(e),r={...t};return n.push(r),this.schedulePersist(),r}async update(e,t,n){const r=this.getCollection(e),i=r.findIndex(o=>o.id===t);if(i===-1)throw new Error(`[LocalStorageAdapter] Record not found: ${e}/${t}`);const a={...r[i],...n};return r[i]=a,this.schedulePersist(),a}async upsert(e,t){const n=t.id;return n&&await this.get(e,n)?this.update(e,n,t):this.insert(e,t)}async remove(e,t){const n=this.getCollection(e),r=n.findIndex(i=>i.id===t);r!==-1&&(n.splice(r,1),this.schedulePersist())}async query(e,t){let n=[...this.getCollection(e)];return t.filters&&t.filters.length>0&&(n=k(n,t.filters)),t.orderBy&&t.orderBy.length>0&&(n=H(n,t.orderBy)),t.offset!=null&&t.offset>0&&(n=n.slice(t.offset)),t.limit!=null&&t.limit>0&&(n=n.slice(0,t.limit)),n}async count(e,t){let n=this.getCollection(e);return t&&t.length>0&&(n=k(n,t)),n.length}async bulkInsert(e,t,n){const r=this.getCollection(e),i=[],a=t.length;for(let o=0;o<a;o++){const l={...t[o]};r.push(l),i.push(l),n?.onProgress&&a>0&&n.onProgress(Math.round((o+1)/a*100))}return this.schedulePersist(),i}async bulkUpdate(e,t,n){const r=this.getCollection(e),i=[],a=t.length;for(let o=0;o<a;o++){const{id:l,changes:c}=t[o],y=r.findIndex(d=>d.id===l);if(y===-1)throw new Error(`[LocalStorageAdapter] Record not found: ${e}/${l}`);const h={...r[y],...c};r[y]=h,i.push(h),n?.onProgress&&a>0&&n.onProgress(Math.round((o+1)/a*100))}return this.schedulePersist(),i}async bulkRemove(e,t,n){const r=this.getCollection(e),i=new Set(t),a=t.length;let o=0;for(let l=r.length-1;l>=0;l--)i.has(r[l].id)&&(r.splice(l,1),o++,n?.onProgress&&a>0&&n.onProgress(Math.round(o/a*100)));this.schedulePersist()}async aggregate(e,t){let n=[...this.getCollection(e)];t.filters&&t.filters.length>0&&(n=k(n,t.filters));const r=t.groupBy??[],i=new Map;for(const o of n){const l=r.map(c=>String(v(o,c)??"")).join("||");i.has(l)||i.set(l,[]),i.get(l).push(o)}r.length===0&&!i.has("")&&i.set("",n);const a=[];for(const[o,l]of i.entries()){const c={};if(r.length>0){const h=o.split("||");for(let d=0;d<r.length;d++)c[r[d]]=h[d]}const y={};for(const h of t.aggregates){const d=`${h.fn}_${h.field}`;switch(h.fn){case"count":y[d]=l.length;break;case"sum":{let u=0;for(const m of l){const p=v(m,h.field);typeof p=="number"&&(u+=p)}y[d]=u;break}case"avg":{let u=0,m=0;for(const p of l){const b=v(p,h.field);typeof b=="number"&&(u+=b,m++)}y[d]=m>0?u/m:0;break}case"min":{let u=1/0;for(const m of l){const p=v(m,h.field);typeof p=="number"&&p<u&&(u=p)}y[d]=u===1/0?0:u;break}case"max":{let u=-1/0;for(const m of l){const p=v(m,h.field);typeof p=="number"&&p>u&&(u=p)}y[d]=u===-1/0?0:u;break}}}a.push({groups:c,values:y})}return a}async clear(e){this.cache.set(e,[]),this.schedulePersist()}async exportCollection(e){return[...this.getCollection(e)]}async importCollection(e,t,n=!1){if(n){const r=this.getCollection(e),i=new Set(r.map(a=>a.id));for(const a of t){const o=a.id;if(o&&i.has(o)){const l=r.findIndex(c=>c.id===o);r[l]={...r[l],...a}}else r.push({...a})}}else this.cache.set(e,t.map(r=>({...r})));this.schedulePersist()}}function f(){return`${Date.now().toString(36)}-${Math.random().toString(36).slice(2,9)}`}function g(){return new Date().toISOString()}class D{_collection;adapter;_filters=[];_orderBy=[];_limit;_offset;_includes=[];constructor(e,t){this._collection=e,this.adapter=t}where(e,t,n){return this._filters.push({field:e,operator:t,value:n}),this}whereEq(e,t){return this.where(e,"=",t)}whereIn(e,t){return this.where(e,"in",t)}whereNull(e){return this.where(e,"isNull",null)}whereNotNull(e){return this.where(e,"isNotNull",null)}whereBetween(e,t,n){return this.where(e,"between",[t,n])}orderBy(e,t="asc"){return this._orderBy.push({field:e,direction:t}),this}limit(e){return this._limit=e,this}offset(e){return this._offset=e,this}include(e){return this._includes.push(e),this}build(){const e={};return this._filters.length>0&&(e.filters=[...this._filters]),this._orderBy.length>0&&(e.orderBy=[...this._orderBy]),this._limit!=null&&(e.limit=this._limit),this._offset!=null&&(e.offset=this._offset),this._includes.length>0&&(e.include=[...this._includes]),e}async execute(){return await this.adapter.query(this._collection,this.build())}async first(){const e=this._limit;this._limit=1;const t=await this.execute();return this._limit=e,t.length>0?t[0]:null}async count(){return this.adapter.count(this._collection,this._filters)}async sum(e){const t=await this.adapter.aggregate(this._collection,{aggregates:[{field:e,fn:"sum"}],filters:this._filters.length>0?this._filters:void 0});return t.length>0?t[0].values[`sum_${e}`]??0:0}async avg(e){const t=await this.adapter.aggregate(this._collection,{aggregates:[{field:e,fn:"avg"}],filters:this._filters.length>0?this._filters:void 0});return t.length>0?t[0].values[`avg_${e}`]??0:0}async min(e){const t=await this.adapter.aggregate(this._collection,{aggregates:[{field:e,fn:"min"}],filters:this._filters.length>0?this._filters:void 0});return t.length>0?t[0].values[`min_${e}`]??0:0}async max(e){const t=await this.adapter.aggregate(this._collection,{aggregates:[{field:e,fn:"max"}],filters:this._filters.length>0?this._filters:void 0});return t.length>0?t[0].values[`max_${e}`]??0:0}}class J{name;adapter;schemas;events;constructor(e,t,n,r){this.name=e,this.adapter=t,this.schemas=n,this.events=r}async get(e){const t=await this.adapter.get(this.name,e);return!t||t.deletedAt!=null?null:t}async getIncludingDeleted(e){const t=await this.adapter.get(this.name,e);return t||null}async getAll(){return(await this.adapter.getAll(this.name)).filter(t=>t.deletedAt==null)}query(){const e=new D(this.name,this.adapter);return e.whereNull("deletedAt"),e}queryIncludingDeleted(){return new D(this.name,this.adapter)}async count(e){const t=[{field:"deletedAt",operator:"isNull",value:null},...e??[]];return this.adapter.count(this.name,t)}async insert(e){const t={...e,id:e.id??f(),createdAt:g(),updatedAt:g(),deletedAt:null,version:1};this.validate(t),this.events.emit(`${this.name}.before.insert`,{collection:this.name,record:t});const n=await this.adapter.insert(this.name,t);return this.events.emit(`${this.name}.after.insert`,{collection:this.name,record:n}),this.events.emit(`${this.name}.change`,{type:"insert",collection:this.name,records:[n]}),n}async update(e,t){const n=await this.adapter.get(this.name,e);if(!n)throw new Error(`[Collection:${this.name}] Record not found: ${e}`);const r={...n,...t,id:e,updatedAt:g(),version:(n.version??0)+1};this.validate(r),this.events.emit(`${this.name}.before.update`,{collection:this.name,id:e,changes:t,previous:n});const i=await this.adapter.update(this.name,e,{...t,updatedAt:r.updatedAt,version:r.version});return this.events.emit(`${this.name}.after.update`,{collection:this.name,record:i,previous:n}),this.events.emit(`${this.name}.change`,{type:"update",collection:this.name,records:[i]}),i}async upsert(e){const t=e.id;return t&&await this.adapter.get(this.name,t)?this.update(t,e):this.insert(e)}async remove(e){const t=await this.adapter.get(this.name,e);if(!t)throw new Error(`[Collection:${this.name}] Record not found: ${e}`);this.events.emit(`${this.name}.before.remove`,{collection:this.name,id:e,record:t}),await this.adapter.update(this.name,e,{deletedAt:g(),updatedAt:g(),version:(t.version??0)+1}),this.events.emit(`${this.name}.after.remove`,{collection:this.name,id:e,record:t}),this.events.emit(`${this.name}.change`,{type:"remove",collection:this.name,ids:[e]})}async hardRemove(e){const t=await this.adapter.get(this.name,e);if(!t)throw new Error(`[Collection:${this.name}] Record not found: ${e}`);this.events.emit(`${this.name}.before.hardRemove`,{collection:this.name,id:e,record:t}),await this.adapter.remove(this.name,e),this.events.emit(`${this.name}.after.hardRemove`,{collection:this.name,id:e,record:t}),this.events.emit(`${this.name}.change`,{type:"remove",collection:this.name,ids:[e]})}async restore(e){const t=await this.adapter.get(this.name,e);if(!t)throw new Error(`[Collection:${this.name}] Record not found: ${e}`);if(t.deletedAt==null)throw new Error(`[Collection:${this.name}] Record is not deleted: ${e}`);this.events.emit(`${this.name}.before.restore`,{collection:this.name,id:e});const n=await this.adapter.update(this.name,e,{deletedAt:null,updatedAt:g(),version:(t.version??0)+1});return this.events.emit(`${this.name}.after.restore`,{collection:this.name,record:n}),this.events.emit(`${this.name}.change`,{type:"restore",collection:this.name,records:[n]}),n}async bulkInsert(e,t){const n=e.map(i=>{const a={...i,id:i.id??f(),createdAt:g(),updatedAt:g(),deletedAt:null,version:1};return this.validate(a),a});this.events.emit(`${this.name}.before.bulkInsert`,{collection:this.name,count:n.length});const r=await this.adapter.bulkInsert(this.name,n,t);return this.events.emit(`${this.name}.after.bulkInsert`,{collection:this.name,records:r}),this.events.emit(`${this.name}.change`,{type:"bulkInsert",collection:this.name,records:r}),r}async bulkUpdate(e,t){const n=[];for(const{id:i,changes:a}of e){const o=await this.adapter.get(this.name,i);if(!o)throw new Error(`[Collection:${this.name}] Record not found: ${i}`);n.push({id:i,changes:{...a,updatedAt:g(),version:(o.version??0)+1}})}this.events.emit(`${this.name}.before.bulkUpdate`,{collection:this.name,count:n.length});const r=await this.adapter.bulkUpdate(this.name,n,t);return this.events.emit(`${this.name}.after.bulkUpdate`,{collection:this.name,records:r}),this.events.emit(`${this.name}.change`,{type:"bulkUpdate",collection:this.name,records:r}),r}async bulkRemove(e,t){const n=[];for(const r of e){const i=await this.adapter.get(this.name,r);i&&n.push({id:r,changes:{deletedAt:g(),updatedAt:g(),version:(i.version??0)+1}})}this.events.emit(`${this.name}.before.bulkRemove`,{collection:this.name,ids:e}),n.length>0&&await this.adapter.bulkUpdate(this.name,n,t),this.events.emit(`${this.name}.after.bulkRemove`,{collection:this.name,ids:e}),this.events.emit(`${this.name}.change`,{type:"bulkRemove",collection:this.name,ids:e})}onChange(e){return this.events.on(`${this.name}.change`,e)}async exportJSON(){return await this.adapter.exportCollection(this.name)}async importJSON(e,t={}){const n=e.map(r=>({...r,id:r.id??f(),createdAt:r.createdAt??g(),updatedAt:r.updatedAt??g(),deletedAt:r.deletedAt??null,version:r.version??1}));await this.adapter.importCollection(this.name,n,t.merge??!1),this.events.emit(`${this.name}.change`,{type:"bulkInsert",collection:this.name,records:n})}validate(e){try{this.schemas.get(this.name)&&this.schemas.validate(this.name,e)}catch{}}}class V{operations=[];committed=!1;rolledBack=!1;enqueue(e){if(this.committed||this.rolledBack)throw new Error("[Transaction] Cannot enqueue: transaction already finalized.");this.operations.push(e)}async commit(){if(this.committed)throw new Error("[Transaction] Already committed.");if(this.rolledBack)throw new Error("[Transaction] Already rolled back.");this.committed=!0;for(const e of this.operations)await e()}rollback(){this.rolledBack=!0,this.operations=[]}}const W=5e3;class Q{schemas;events;logger;adapter=null;collections=new Map;initialized=!1;constructor(e,t,n){this.schemas=e,this.events=t,this.logger=n}async initialize(){if(this.initialized){this.logger.warn("store","Store already initialized");return}if(this.logger.info("store","Initializing data store..."),this.adapter=new z,this.shouldUseIndexedDB())try{const{IndexedDBAdapter:e}=await C(async()=>{const{IndexedDBAdapter:n}=await import("./indexeddb-B_pSjGdP.js");return{IndexedDBAdapter:n}},__vite__mapDeps([0,1,2]),import.meta.url),t=new e;await this.migrateAdapter(this.adapter,t),this.adapter=t,this.logger.info("store","Upgraded to IndexedDB adapter for large dataset")}catch(e){this.logger.warn("store","IndexedDB not available, staying with localStorage",e)}this.initialized=!0,this.events.emit("store.initialized",{adapter:this.adapter.constructor.name}),this.logger.info("store",`Store initialized with ${this.adapter.constructor.name}`)}shouldUseIndexedDB(){if(typeof indexedDB>"u")return!1;try{const e=localStorage.getItem("concrete");if(!e)return!1;const t=JSON.parse(e);let n=0;for(const r of Object.values(t))Array.isArray(r)&&(n+=r.length);return n>W}catch{return!1}}async migrateAdapter(e,t){try{const n=localStorage.getItem("concrete");if(!n)return;const r=JSON.parse(n);for(const[i,a]of Object.entries(r))Array.isArray(a)&&a.length>0&&await t.importCollection(i,a)}catch(n){throw this.logger.error("store","Migration failed",n),n}}setAdapter(e){this.adapter=e,this.collections.clear(),this.logger.info("store",`Adapter switched to ${e.constructor.name}`)}getAdapter(){return this.ensureInitialized(),this.adapter}ensureInitialized(){if(!this.initialized||!this.adapter)throw new Error("[Store] Not initialized. Call initialize() first.")}collection(e){if(this.ensureInitialized(),!this.collections.has(e)){const t=new J(e,this.adapter,this.schemas,this.events);this.collections.set(e,t)}return this.collections.get(e)}async transaction(e){const t=new V;try{await e(t),await t.commit(),this.events.emit("store.transaction.commit")}catch(n){throw t.rollback(),this.events.emit("store.transaction.rollback",{error:n}),n}}async exportAll(){this.ensureInitialized();const e={};for(const[t,n]of this.collections.entries())e[t]=await n.exportJSON();try{const t=localStorage.getItem("concrete");if(t){const n=JSON.parse(t);for(const[r,i]of Object.entries(n))!e[r]&&Array.isArray(i)&&(e[r]=i)}}catch{}return e}async importAll(e){this.ensureInitialized();const t=e.__version??1,n=this.migrateData(e,t);for(const[r,i]of Object.entries(n)){if(r.startsWith("__")||!Array.isArray(i))continue;await this.collection(r).importJSON(i,{merge:!1})}this.events.emit("store.imported",{collections:Object.keys(n)}),this.logger.info("store","Data imported successfully")}migrateData(e,t){return e}async seed(e){this.ensureInitialized(),this.logger.info("store",`Seeding data with profile: ${e}`),this.events.emit("store.seed",{profile:e})}async reset(){this.ensureInitialized(),this.logger.warn("store","Resetting all store data");for(const[e]of this.collections.entries())await this.adapter.clear(e);try{localStorage.removeItem("concrete")}catch{}this.collections.clear(),this.events.emit("store.reset"),this.logger.info("store","Store reset complete")}async getStats(){this.ensureInitialized();const e={};for(const[t]of this.collections.entries())e[t]=await this.adapter.count(t);try{const t=localStorage.getItem("concrete");if(t){const n=JSON.parse(t);for(const[r,i]of Object.entries(n))!e[r]&&Array.isArray(i)&&(e[r]=i.length)}}catch{}return e}}function G(s,e){if(e.required&&(s==null||s===""))return`${e.label??e.name} is required`;if(s==null)return null;switch(e.type){case"string":case"id":case"date":{if(typeof s!="string")return`${e.label??e.name} must be a string`;break}case"number":case"currency":case"percentage":{if(typeof s!="number"||Number.isNaN(s))return`${e.label??e.name} must be a number`;break}case"boolean":{if(typeof s!="boolean")return`${e.label??e.name} must be a boolean`;break}case"enum":{if(e.enum&&!e.enum.includes(s))return`${e.label??e.name} must be one of: ${e.enum.join(", ")}`;break}case"array":{if(!Array.isArray(s))return`${e.label??e.name} must be an array`;break}case"object":{if(typeof s!="object"||Array.isArray(s))return`${e.label??e.name} must be an object`;break}}if((e.type==="number"||e.type==="currency"||e.type==="percentage")&&typeof s=="number"){if(e.min!==void 0&&s<e.min)return`${e.label??e.name} must be at least ${e.min}`;if(e.max!==void 0&&s>e.max)return`${e.label??e.name} must be at most ${e.max}`}if(e.type==="string"&&typeof s=="string"){if(e.min!==void 0&&s.length<e.min)return`${e.label??e.name} must be at least ${e.min} characters`;if(e.max!==void 0&&s.length>e.max)return`${e.label??e.name} must be at most ${e.max} characters`}if(e.pattern&&typeof s=="string"&&!new RegExp(e.pattern).test(s))return`${e.label??e.name} does not match the required pattern`;if(e.validators)for(const t of e.validators){const n=t(s,e,{});if(n)return n}return null}function Y(s,e){const t=[];for(const n of e.fields){const r=s[n.name],i=G(r,n);if(i&&t.push(i),n.validators)for(const a of n.validators){const o=a(r,n,s);o&&!t.includes(o)&&t.push(o)}}if(e.validators)for(const n of e.validators){const r=n(s,e);t.push(...r)}return t}class Z{schemas;constructor(e){this.schemas=e}getCurrentVersion(e){const t=this.schemas.get(e);if(!t)throw new Error(`Schema not found for collection: ${e}`);return t.version}getMigrations(e,t,n){const r=this.schemas.get(e);if(!r)throw new Error(`Schema not found for collection: ${e}`);return(r.migrations??[]).filter(a=>a.version>t&&a.version<=n).sort((a,o)=>a.version-o.version)}run(e,t,n,r){const i=this.getMigrations(e,n,r);if(i.length===0)return t;let a=[...t];for(const o of i)a=o.up(a);return a}}const X=[{collection:"core/company",module:"core",version:1,fields:[{name:"name",type:"string",required:!0,label:"Company Name"},{name:"legalName",type:"string",label:"Legal Name"},{name:"taxId",type:"string",label:"Tax ID / EIN"},{name:"status",type:"enum",enum:["active","inactive","suspended"],label:"Status"}],relations:[]},{collection:"core/user",module:"core",version:1,fields:[{name:"email",type:"string",required:!0,label:"Email"},{name:"displayName",type:"string",required:!0,label:"Display Name"},{name:"roleIds",type:"array",label:"Role IDs"},{name:"status",type:"enum",enum:["active","inactive","locked"],label:"Status"}],relations:[{foreignKey:"roleIds",collection:"core/role",type:"manyToMany",cascade:"nullify"}]},{collection:"core/role",module:"core",version:1,fields:[{name:"name",type:"string",required:!0,label:"Role Name"},{name:"description",type:"string",label:"Description"},{name:"permissions",type:"array",label:"Permissions"}],relations:[]},{collection:"core/permission",module:"core",version:1,fields:[{name:"resource",type:"string",required:!0,label:"Resource"},{name:"action",type:"string",required:!0,label:"Action"},{name:"description",type:"string",label:"Description"}],relations:[]},{collection:"core/auditLog",module:"core",version:1,fields:[{name:"userId",type:"id",required:!0,label:"User"},{name:"action",type:"string",required:!0,label:"Action"},{name:"collection",type:"string",label:"Collection"},{name:"recordId",type:"id",label:"Record ID"}],relations:[{foreignKey:"userId",collection:"core/user",type:"belongsTo",cascade:"nullify"}]},{collection:"core/config",module:"core",version:1,fields:[{name:"key",type:"string",required:!0,label:"Key"},{name:"value",type:"object",label:"Value"},{name:"scope",type:"enum",enum:["system","tenant","user"],label:"Scope"}],relations:[]},{collection:"core/notification",module:"core",version:1,fields:[{name:"title",type:"string",required:!0,label:"Title"},{name:"message",type:"string",required:!0,label:"Message"},{name:"type",type:"enum",enum:["critical","warning","info","success","action-required"],label:"Type"},{name:"read",type:"boolean",label:"Read"}],relations:[]},{collection:"core/attachment",module:"core",version:1,fields:[{name:"fileName",type:"string",required:!0,label:"File Name"},{name:"mimeType",type:"string",label:"MIME Type"},{name:"size",type:"number",label:"File Size"},{name:"entityId",type:"id",label:"Attached To"}],relations:[]},{collection:"core/comment",module:"core",version:1,fields:[{name:"text",type:"string",required:!0,label:"Comment"},{name:"authorId",type:"id",required:!0,label:"Author"},{name:"entityId",type:"id",required:!0,label:"Entity"}],relations:[{foreignKey:"authorId",collection:"core/user",type:"belongsTo",cascade:"nullify"}]},{collection:"core/tag",module:"core",version:1,fields:[{name:"name",type:"string",required:!0,label:"Tag Name"},{name:"color",type:"string",label:"Color"}],relations:[]},{collection:"core/customField",module:"core",version:1,fields:[{name:"name",type:"string",required:!0,label:"Field Name"},{name:"type",type:"enum",enum:["string","number","boolean","date","enum"],label:"Field Type"},{name:"collection",type:"string",required:!0,label:"Target Collection"}],relations:[]},{collection:"core/savedFilter",module:"core",version:1,fields:[{name:"name",type:"string",required:!0,label:"Filter Name"},{name:"collection",type:"string",required:!0,label:"Collection"},{name:"filters",type:"object",required:!0,label:"Filter Criteria"}],relations:[]}],ee=[{collection:"gl/account",module:"gl",version:2,fields:[{name:"number",type:"string",required:!0,label:"Account Number"},{name:"name",type:"string",required:!0,label:"Account Name"},{name:"type",type:"enum",enum:["asset","liability","equity","revenue","expense","costOfRevenue"],required:!0,label:"Account Type"},{name:"normalBalance",type:"enum",enum:["debit","credit"],required:!0,label:"Normal Balance"},{name:"parentId",type:"id",label:"Parent Account"},{name:"description",type:"string",label:"Description"},{name:"isActive",type:"boolean",label:"Active"},{name:"depth",type:"number",label:"Hierarchy Depth"},{name:"path",type:"string",label:"Account Path"},{name:"isSummary",type:"boolean",label:"Summary Account"}],relations:[{foreignKey:"parentId",collection:"gl/account",type:"belongsTo",cascade:"nullify"}]},{collection:"gl/journalEntry",module:"gl",version:2,fields:[{name:"entryNumber",type:"string",required:!0,label:"Entry Number"},{name:"date",type:"date",required:!0,label:"Entry Date"},{name:"reference",type:"string",label:"Reference"},{name:"description",type:"string",label:"Description"},{name:"status",type:"enum",enum:["draft","posted","voided"],label:"Status"},{name:"totalDebit",type:"currency",label:"Total Debit"},{name:"totalCredit",type:"currency",label:"Total Credit"},{name:"postedAt",type:"date",label:"Posted At"},{name:"voidedAt",type:"date",label:"Voided At"},{name:"voidReason",type:"string",label:"Void Reason"},{name:"sourceModule",type:"string",label:"Source Module"},{name:"sourceId",type:"string",label:"Source ID"},{name:"fiscalPeriodId",type:"id",label:"Fiscal Period"},{name:"isAutoGenerated",type:"boolean",label:"Auto-Generated"}],relations:[{foreignKey:"fiscalPeriodId",collection:"gl/fiscalPeriod",type:"belongsTo",cascade:"restrict"}]},{collection:"gl/journalLine",module:"gl",version:2,fields:[{name:"journalEntryId",type:"id",required:!0,label:"Journal Entry"},{name:"accountId",type:"id",required:!0,label:"Account"},{name:"accountNumber",type:"string",label:"Account Number"},{name:"accountName",type:"string",label:"Account Name"},{name:"debit",type:"currency",label:"Debit"},{name:"credit",type:"currency",label:"Credit"},{name:"description",type:"string",label:"Line Description"},{name:"lineOrder",type:"number",label:"Line Order"}],relations:[{foreignKey:"journalEntryId",collection:"gl/journalEntry",type:"belongsTo",cascade:"cascade"},{foreignKey:"accountId",collection:"gl/account",type:"belongsTo",cascade:"restrict"}]},{collection:"gl/fiscalPeriod",module:"gl",version:2,fields:[{name:"name",type:"string",required:!0,label:"Period Name"},{name:"year",type:"number",required:!0,label:"Fiscal Year"},{name:"month",type:"number",label:"Month Number"},{name:"startDate",type:"date",required:!0,label:"Start Date"},{name:"endDate",type:"date",required:!0,label:"End Date"},{name:"status",type:"enum",enum:["open","closed","locked"],label:"Status"},{name:"closedAt",type:"date",label:"Closed At"}],relations:[]},{collection:"gl/recurringEntry",module:"gl",version:2,fields:[{name:"name",type:"string",required:!0,label:"Name"},{name:"description",type:"string",label:"Description"},{name:"frequency",type:"enum",enum:["daily","weekly","monthly","quarterly","yearly"],required:!0,label:"Frequency"},{name:"isActive",type:"boolean",label:"Active"},{name:"nextRunDate",type:"date",label:"Next Run Date"},{name:"lastRunDate",type:"date",label:"Last Run Date"},{name:"endDate",type:"date",label:"End Date"},{name:"templateLines",type:"array",label:"Template Lines"},{name:"runCount",type:"number",label:"Run Count"}],relations:[]},{collection:"gl/closingEntry",module:"gl",version:2,fields:[{name:"fiscalPeriodId",type:"id",required:!0,label:"Fiscal Period"},{name:"journalEntryId",type:"id",required:!0,label:"Journal Entry"},{name:"type",type:"enum",enum:["income-summary","retained-earnings"],label:"Closing Type"},{name:"periodName",type:"string",label:"Period Name"},{name:"totalAmount",type:"currency",label:"Total Amount"}],relations:[{foreignKey:"fiscalPeriodId",collection:"gl/fiscalPeriod",type:"belongsTo",cascade:"restrict"},{foreignKey:"journalEntryId",collection:"gl/journalEntry",type:"belongsTo",cascade:"cascade"}]}],te=[{collection:"job/job",module:"job",version:1,fields:[{name:"number",type:"string",required:!0,label:"Job Number"},{name:"name",type:"string",required:!0,label:"Job Name"},{name:"status",type:"enum",enum:["bidding","awarded","active","complete","closed"],label:"Status"},{name:"customerId",type:"id",label:"Customer"}],relations:[{foreignKey:"customerId",collection:"ar/customer",type:"belongsTo",cascade:"nullify"}]},{collection:"job/costCode",module:"job",version:1,fields:[{name:"code",type:"string",required:!0,label:"Cost Code"},{name:"description",type:"string",required:!0,label:"Description"},{name:"category",type:"enum",enum:["labor","material","equipment","subcontract","other"],label:"Category"}],relations:[]},{collection:"job/budget",module:"job",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"name",type:"string",required:!0,label:"Budget Name"},{name:"status",type:"enum",enum:["draft","approved","revised"],label:"Status"},{name:"totalAmount",type:"currency",label:"Total Amount"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"cascade"}]},{collection:"job/budgetLine",module:"job",version:1,fields:[{name:"budgetId",type:"id",required:!0,label:"Budget"},{name:"costCodeId",type:"id",required:!0,label:"Cost Code"},{name:"amount",type:"currency",required:!0,label:"Amount"}],relations:[{foreignKey:"budgetId",collection:"job/budget",type:"belongsTo",cascade:"cascade"},{foreignKey:"costCodeId",collection:"job/costCode",type:"belongsTo",cascade:"restrict"}]},{collection:"job/wip",module:"job",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"periodId",type:"id",label:"Fiscal Period"},{name:"earnedRevenue",type:"currency",label:"Earned Revenue"},{name:"actualCost",type:"currency",label:"Actual Cost"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"cascade"}]},{collection:"job/estimate",module:"job",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"name",type:"string",required:!0,label:"Estimate Name"},{name:"totalAmount",type:"currency",label:"Total Amount"},{name:"status",type:"enum",enum:["draft","submitted","accepted","rejected"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"cascade"}]},{collection:"job/estimateLine",module:"job",version:1,fields:[{name:"estimateId",type:"id",required:!0,label:"Estimate"},{name:"description",type:"string",required:!0,label:"Description"},{name:"quantity",type:"number",label:"Quantity"},{name:"unitPrice",type:"currency",label:"Unit Price"}],relations:[{foreignKey:"estimateId",collection:"job/estimate",type:"belongsTo",cascade:"cascade"}]},{collection:"job/bid",module:"job",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"bidAmount",type:"currency",required:!0,label:"Bid Amount"},{name:"dueDate",type:"date",label:"Due Date"},{name:"status",type:"enum",enum:["preparing","submitted","won","lost","no-bid"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"cascade"}]}],ne=[{collection:"entity/entity",module:"entity",version:1,fields:[{name:"name",type:"string",required:!0,label:"Entity Name"},{name:"type",type:"enum",enum:["company","division","branch","department"],required:!0,label:"Entity Type"},{name:"parentId",type:"id",label:"Parent Entity"},{name:"status",type:"enum",enum:["active","inactive"],label:"Status"}],relations:[{foreignKey:"parentId",collection:"entity/entity",type:"belongsTo",cascade:"nullify"}]},{collection:"entity/hierarchy",module:"entity",version:1,fields:[{name:"name",type:"string",required:!0,label:"Hierarchy Name"},{name:"rootEntityId",type:"id",required:!0,label:"Root Entity"},{name:"type",type:"enum",enum:["legal","management","reporting"],label:"Hierarchy Type"}],relations:[{foreignKey:"rootEntityId",collection:"entity/entity",type:"belongsTo",cascade:"restrict"}]},{collection:"entity/alias",module:"entity",version:1,fields:[{name:"entityId",type:"id",required:!0,label:"Entity"},{name:"alias",type:"string",required:!0,label:"Alias Name"},{name:"source",type:"string",label:"Source System"}],relations:[{foreignKey:"entityId",collection:"entity/entity",type:"belongsTo",cascade:"cascade"}]}],re=[{collection:"ap/vendor",module:"ap",version:1,fields:[{name:"name",type:"string",required:!0,label:"Vendor Name"},{name:"taxId",type:"string",label:"Tax ID"},{name:"status",type:"enum",enum:["active","inactive","hold"],label:"Status"},{name:"defaultTerms",type:"string",label:"Default Terms"}],relations:[]},{collection:"ap/invoice",module:"ap",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Vendor"},{name:"invoiceNumber",type:"string",required:!0,label:"Invoice Number"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["draft","pending","approved","paid","voided"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"}]},{collection:"ap/invoiceLine",module:"ap",version:1,fields:[{name:"invoiceId",type:"id",required:!0,label:"Invoice"},{name:"description",type:"string",label:"Description"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"costCodeId",type:"id",label:"Cost Code"}],relations:[{foreignKey:"invoiceId",collection:"ap/invoice",type:"belongsTo",cascade:"cascade"},{foreignKey:"costCodeId",collection:"job/costCode",type:"belongsTo",cascade:"nullify"}]},{collection:"ap/payment",module:"ap",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Vendor"},{name:"date",type:"date",required:!0,label:"Payment Date"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"method",type:"enum",enum:["check","ach","wire","credit-card"],label:"Method"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"}]},{collection:"ap/paymentLine",module:"ap",version:1,fields:[{name:"paymentId",type:"id",required:!0,label:"Payment"},{name:"invoiceId",type:"id",required:!0,label:"Invoice"},{name:"amount",type:"currency",required:!0,label:"Amount Applied"}],relations:[{foreignKey:"paymentId",collection:"ap/payment",type:"belongsTo",cascade:"cascade"},{foreignKey:"invoiceId",collection:"ap/invoice",type:"belongsTo",cascade:"restrict"}]},{collection:"ap/lienWaiver",module:"ap",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Vendor"},{name:"jobId",type:"id",label:"Job"},{name:"type",type:"enum",enum:["conditional","unconditional","partial","final"],label:"Waiver Type"},{name:"status",type:"enum",enum:["requested","received","expired"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"ap/complianceCert",module:"ap",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Vendor"},{name:"type",type:"string",required:!0,label:"Certificate Type"},{name:"expirationDate",type:"date",label:"Expiration Date"},{name:"status",type:"enum",enum:["valid","expired","pending"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"cascade"}]},{collection:"ap/retention",module:"ap",version:1,fields:[{name:"invoiceId",type:"id",required:!0,label:"Invoice"},{name:"amount",type:"currency",required:!0,label:"Retained Amount"},{name:"releaseDate",type:"date",label:"Release Date"},{name:"status",type:"enum",enum:["held","released","partial"],label:"Status"}],relations:[{foreignKey:"invoiceId",collection:"ap/invoice",type:"belongsTo",cascade:"cascade"}]}],ie=[{collection:"ar/customer",module:"ar",version:1,fields:[{name:"name",type:"string",required:!0,label:"Customer Name"},{name:"contactEmail",type:"string",label:"Contact Email"},{name:"status",type:"enum",enum:["active","inactive","hold"],label:"Status"},{name:"creditLimit",type:"currency",label:"Credit Limit"}],relations:[]},{collection:"ar/invoice",module:"ar",version:1,fields:[{name:"customerId",type:"id",required:!0,label:"Customer"},{name:"invoiceNumber",type:"string",required:!0,label:"Invoice Number"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["draft","sent","partial","paid","overdue","voided"],label:"Status"}],relations:[{foreignKey:"customerId",collection:"ar/customer",type:"belongsTo",cascade:"restrict"}]},{collection:"ar/invoiceLine",module:"ar",version:1,fields:[{name:"invoiceId",type:"id",required:!0,label:"Invoice"},{name:"description",type:"string",label:"Description"},{name:"quantity",type:"number",label:"Quantity"},{name:"unitPrice",type:"currency",label:"Unit Price"}],relations:[{foreignKey:"invoiceId",collection:"ar/invoice",type:"belongsTo",cascade:"cascade"}]},{collection:"ar/payment",module:"ar",version:1,fields:[{name:"customerId",type:"id",required:!0,label:"Customer"},{name:"date",type:"date",required:!0,label:"Payment Date"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"method",type:"enum",enum:["check","ach","wire","credit-card"],label:"Method"}],relations:[{foreignKey:"customerId",collection:"ar/customer",type:"belongsTo",cascade:"restrict"}]},{collection:"ar/aiaApplication",module:"ar",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"applicationNumber",type:"number",required:!0,label:"Application Number"},{name:"periodTo",type:"date",label:"Period To"},{name:"status",type:"enum",enum:["draft","submitted","approved","paid"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"restrict"}]},{collection:"ar/retainage",module:"ar",version:1,fields:[{name:"invoiceId",type:"id",required:!0,label:"Invoice"},{name:"amount",type:"currency",required:!0,label:"Retainage Amount"},{name:"percentage",type:"percentage",label:"Retainage Percentage"},{name:"status",type:"enum",enum:["held","released","partial"],label:"Status"}],relations:[{foreignKey:"invoiceId",collection:"ar/invoice",type:"belongsTo",cascade:"cascade"}]},{collection:"ar/billingSchedule",module:"ar",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"name",type:"string",required:!0,label:"Schedule Name"},{name:"frequency",type:"enum",enum:["monthly","milestone","progress"],label:"Frequency"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"cascade"}]},{collection:"ar/billingMilestone",module:"ar",version:1,fields:[{name:"scheduleId",type:"id",required:!0,label:"Billing Schedule"},{name:"description",type:"string",required:!0,label:"Milestone Description"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["pending","reached","billed","paid"],label:"Status"}],relations:[{foreignKey:"scheduleId",collection:"ar/billingSchedule",type:"belongsTo",cascade:"cascade"}]}],ae=[{collection:"payroll/employee",module:"payroll",version:1,fields:[{name:"employeeNumber",type:"string",required:!0,label:"Employee Number"},{name:"name",type:"string",required:!0,label:"Full Name"},{name:"status",type:"enum",enum:["active","inactive","terminated","leave"],label:"Status"},{name:"hireDate",type:"date",label:"Hire Date"}],relations:[]},{collection:"payroll/timeEntry",module:"payroll",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"date",type:"date",required:!0,label:"Date"},{name:"hours",type:"number",required:!0,label:"Hours"},{name:"jobId",type:"id",label:"Job"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"payroll/payRun",module:"payroll",version:1,fields:[{name:"periodStart",type:"date",required:!0,label:"Period Start"},{name:"periodEnd",type:"date",required:!0,label:"Period End"},{name:"status",type:"enum",enum:["draft","processing","approved","posted"],label:"Status"},{name:"totalGross",type:"currency",label:"Total Gross"}],relations:[]},{collection:"payroll/payCheck",module:"payroll",version:1,fields:[{name:"payRunId",type:"id",required:!0,label:"Pay Run"},{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"grossPay",type:"currency",required:!0,label:"Gross Pay"},{name:"netPay",type:"currency",required:!0,label:"Net Pay"}],relations:[{foreignKey:"payRunId",collection:"payroll/payRun",type:"belongsTo",cascade:"cascade"},{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"}]},{collection:"payroll/earning",module:"payroll",version:1,fields:[{name:"payCheckId",type:"id",required:!0,label:"Paycheck"},{name:"type",type:"enum",enum:["regular","overtime","bonus","commission","per-diem"],label:"Earning Type"},{name:"hours",type:"number",label:"Hours"},{name:"amount",type:"currency",required:!0,label:"Amount"}],relations:[{foreignKey:"payCheckId",collection:"payroll/payCheck",type:"belongsTo",cascade:"cascade"}]},{collection:"payroll/deduction",module:"payroll",version:1,fields:[{name:"payCheckId",type:"id",required:!0,label:"Paycheck"},{name:"type",type:"string",required:!0,label:"Deduction Type"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"preTax",type:"boolean",label:"Pre-Tax"}],relations:[{foreignKey:"payCheckId",collection:"payroll/payCheck",type:"belongsTo",cascade:"cascade"}]},{collection:"payroll/benefit",module:"payroll",version:1,fields:[{name:"name",type:"string",required:!0,label:"Benefit Name"},{name:"type",type:"enum",enum:["health","dental","vision","life","401k","other"],label:"Benefit Type"},{name:"employerContribution",type:"currency",label:"Employer Contribution"}],relations:[]},{collection:"payroll/taxTable",module:"payroll",version:1,fields:[{name:"name",type:"string",required:!0,label:"Tax Table Name"},{name:"jurisdiction",type:"string",required:!0,label:"Jurisdiction"},{name:"effectiveDate",type:"date",required:!0,label:"Effective Date"}],relations:[]},{collection:"payroll/taxFiling",module:"payroll",version:1,fields:[{name:"type",type:"string",required:!0,label:"Filing Type"},{name:"period",type:"string",required:!0,label:"Period"},{name:"status",type:"enum",enum:["pending","filed","accepted","rejected"],label:"Status"},{name:"amount",type:"currency",label:"Amount"}],relations:[]},{collection:"payroll/w2",module:"payroll",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"year",type:"number",required:!0,label:"Tax Year"},{name:"wagesTips",type:"currency",label:"Wages & Tips"},{name:"federalTax",type:"currency",label:"Federal Tax Withheld"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"}]},{collection:"payroll/workerComp",module:"payroll",version:1,fields:[{name:"classCode",type:"string",required:!0,label:"Class Code"},{name:"description",type:"string",label:"Description"},{name:"rate",type:"percentage",required:!0,label:"Rate"},{name:"effectiveDate",type:"date",label:"Effective Date"}],relations:[]}],oe=[{collection:"union/union",module:"union",version:1,fields:[{name:"name",type:"string",required:!0,label:"Union Name"},{name:"localNumber",type:"string",label:"Local Number"},{name:"trade",type:"string",label:"Trade"},{name:"status",type:"enum",enum:["active","inactive"],label:"Status"}],relations:[]},{collection:"union/rateTable",module:"union",version:1,fields:[{name:"unionId",type:"id",required:!0,label:"Union"},{name:"effectiveDate",type:"date",required:!0,label:"Effective Date"},{name:"expirationDate",type:"date",label:"Expiration Date"}],relations:[{foreignKey:"unionId",collection:"union/union",type:"belongsTo",cascade:"cascade"}]},{collection:"union/rateTableLine",module:"union",version:1,fields:[{name:"rateTableId",type:"id",required:!0,label:"Rate Table"},{name:"classification",type:"string",required:!0,label:"Classification"},{name:"baseRate",type:"currency",required:!0,label:"Base Rate"},{name:"overtimeRate",type:"currency",label:"Overtime Rate"}],relations:[{foreignKey:"rateTableId",collection:"union/rateTable",type:"belongsTo",cascade:"cascade"}]},{collection:"union/fringeBenefit",module:"union",version:1,fields:[{name:"unionId",type:"id",required:!0,label:"Union"},{name:"name",type:"string",required:!0,label:"Benefit Name"},{name:"ratePerHour",type:"currency",required:!0,label:"Rate Per Hour"}],relations:[{foreignKey:"unionId",collection:"union/union",type:"belongsTo",cascade:"cascade"}]},{collection:"union/prevailingWage",module:"union",version:1,fields:[{name:"jurisdiction",type:"string",required:!0,label:"Jurisdiction"},{name:"classification",type:"string",required:!0,label:"Classification"},{name:"wageRate",type:"currency",required:!0,label:"Wage Rate"},{name:"effectiveDate",type:"date",label:"Effective Date"}],relations:[]},{collection:"union/certifiedPayroll",module:"union",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"weekEnding",type:"date",required:!0,label:"Week Ending"},{name:"status",type:"enum",enum:["draft","certified","submitted"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"restrict"}]},{collection:"union/apprentice",module:"union",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"unionId",type:"id",required:!0,label:"Union"},{name:"level",type:"number",label:"Apprentice Level"},{name:"startDate",type:"date",label:"Start Date"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"},{foreignKey:"unionId",collection:"union/union",type:"belongsTo",cascade:"restrict"}]},{collection:"union/remittance",module:"union",version:1,fields:[{name:"unionId",type:"id",required:!0,label:"Union"},{name:"periodEnd",type:"date",required:!0,label:"Period End"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["pending","paid","overdue"],label:"Status"}],relations:[{foreignKey:"unionId",collection:"union/union",type:"belongsTo",cascade:"restrict"}]}],se=[{collection:"equip/equipment",module:"equip",version:1,fields:[{name:"code",type:"string",required:!0,label:"Equipment Code"},{name:"description",type:"string",required:!0,label:"Description"},{name:"status",type:"enum",enum:["available","in-use","maintenance","retired"],label:"Status"},{name:"category",type:"string",label:"Category"}],relations:[]},{collection:"equip/rateTable",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"hourlyRate",type:"currency",label:"Hourly Rate"},{name:"dailyRate",type:"currency",label:"Daily Rate"},{name:"effectiveDate",type:"date",label:"Effective Date"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"cascade"}]},{collection:"equip/usage",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"jobId",type:"id",label:"Job"},{name:"date",type:"date",required:!0,label:"Date"},{name:"hours",type:"number",label:"Hours Used"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"equip/maintenance",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"type",type:"enum",enum:["preventive","corrective","inspection"],label:"Maintenance Type"},{name:"scheduledDate",type:"date",label:"Scheduled Date"},{name:"status",type:"enum",enum:["scheduled","in-progress","complete"],label:"Status"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"cascade"}]},{collection:"equip/workOrder",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"description",type:"string",required:!0,label:"Description"},{name:"priority",type:"enum",enum:["low","medium","high","urgent"],label:"Priority"},{name:"status",type:"enum",enum:["open","assigned","in-progress","complete"],label:"Status"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"cascade"}]},{collection:"equip/fuelLog",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"date",type:"date",required:!0,label:"Date"},{name:"gallons",type:"number",required:!0,label:"Gallons"},{name:"cost",type:"currency",label:"Cost"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"cascade"}]},{collection:"equip/depreciation",module:"equip",version:1,fields:[{name:"equipmentId",type:"id",required:!0,label:"Equipment"},{name:"method",type:"enum",enum:["straight-line","declining-balance","units-of-production"],label:"Method"},{name:"currentValue",type:"currency",label:"Current Value"},{name:"usefulLife",type:"number",label:"Useful Life (months)"}],relations:[{foreignKey:"equipmentId",collection:"equip/equipment",type:"belongsTo",cascade:"cascade"}]}],le=[{collection:"sub/subcontract",module:"sub",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Subcontractor"},{name:"jobId",type:"id",required:!0,label:"Job"},{name:"amount",type:"currency",required:!0,label:"Contract Amount"},{name:"status",type:"enum",enum:["draft","executed","complete","terminated"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"restrict"}]},{collection:"sub/changeOrder",module:"sub",version:1,fields:[{name:"subcontractId",type:"id",required:!0,label:"Subcontract"},{name:"number",type:"number",required:!0,label:"CO Number"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["pending","approved","rejected","voided"],label:"Status"}],relations:[{foreignKey:"subcontractId",collection:"sub/subcontract",type:"belongsTo",cascade:"cascade"}]},{collection:"sub/payApp",module:"sub",version:1,fields:[{name:"subcontractId",type:"id",required:!0,label:"Subcontract"},{name:"applicationNumber",type:"number",required:!0,label:"Application Number"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["draft","submitted","approved","paid"],label:"Status"}],relations:[{foreignKey:"subcontractId",collection:"sub/subcontract",type:"belongsTo",cascade:"cascade"}]},{collection:"sub/backcharge",module:"sub",version:1,fields:[{name:"subcontractId",type:"id",required:!0,label:"Subcontract"},{name:"description",type:"string",required:!0,label:"Description"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["pending","approved","deducted","disputed"],label:"Status"}],relations:[{foreignKey:"subcontractId",collection:"sub/subcontract",type:"belongsTo",cascade:"cascade"}]},{collection:"sub/prequalification",module:"sub",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Subcontractor"},{name:"status",type:"enum",enum:["pending","qualified","disqualified","expired"],label:"Status"},{name:"expirationDate",type:"date",label:"Expiration Date"},{name:"bondingCapacity",type:"currency",label:"Bonding Capacity"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"}]},{collection:"sub/compliance",module:"sub",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Subcontractor"},{name:"type",type:"string",required:!0,label:"Compliance Type"},{name:"status",type:"enum",enum:["compliant","non-compliant","pending-review"],label:"Status"},{name:"expirationDate",type:"date",label:"Expiration Date"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"}]}],ce=[{collection:"po/purchaseOrder",module:"po",version:1,fields:[{name:"number",type:"string",required:!0,label:"PO Number"},{name:"vendorId",type:"id",required:!0,label:"Vendor"},{name:"jobId",type:"id",label:"Job"},{name:"status",type:"enum",enum:["draft","issued","partial","received","closed","cancelled"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"po/poLine",module:"po",version:1,fields:[{name:"purchaseOrderId",type:"id",required:!0,label:"Purchase Order"},{name:"description",type:"string",required:!0,label:"Description"},{name:"quantity",type:"number",required:!0,label:"Quantity"},{name:"unitPrice",type:"currency",required:!0,label:"Unit Price"}],relations:[{foreignKey:"purchaseOrderId",collection:"po/purchaseOrder",type:"belongsTo",cascade:"cascade"}]},{collection:"po/receipt",module:"po",version:1,fields:[{name:"purchaseOrderId",type:"id",required:!0,label:"Purchase Order"},{name:"date",type:"date",required:!0,label:"Receipt Date"},{name:"receivedBy",type:"string",label:"Received By"}],relations:[{foreignKey:"purchaseOrderId",collection:"po/purchaseOrder",type:"belongsTo",cascade:"cascade"}]},{collection:"po/receiptLine",module:"po",version:1,fields:[{name:"receiptId",type:"id",required:!0,label:"Receipt"},{name:"poLineId",type:"id",required:!0,label:"PO Line"},{name:"quantityReceived",type:"number",required:!0,label:"Quantity Received"}],relations:[{foreignKey:"receiptId",collection:"po/receipt",type:"belongsTo",cascade:"cascade"},{foreignKey:"poLineId",collection:"po/poLine",type:"belongsTo",cascade:"restrict"}]},{collection:"po/amendment",module:"po",version:1,fields:[{name:"purchaseOrderId",type:"id",required:!0,label:"Purchase Order"},{name:"number",type:"number",required:!0,label:"Amendment Number"},{name:"description",type:"string",label:"Description"},{name:"amountChange",type:"currency",label:"Amount Change"}],relations:[{foreignKey:"purchaseOrderId",collection:"po/purchaseOrder",type:"belongsTo",cascade:"cascade"}]}],de=[{collection:"doc/document",module:"doc",version:1,fields:[{name:"title",type:"string",required:!0,label:"Title"},{name:"category",type:"string",label:"Category"},{name:"status",type:"enum",enum:["draft","review","approved","archived"],label:"Status"},{name:"jobId",type:"id",label:"Job"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"doc/revision",module:"doc",version:1,fields:[{name:"documentId",type:"id",required:!0,label:"Document"},{name:"revisionNumber",type:"number",required:!0,label:"Revision Number"},{name:"description",type:"string",label:"Change Description"},{name:"fileName",type:"string",label:"File Name"}],relations:[{foreignKey:"documentId",collection:"doc/document",type:"belongsTo",cascade:"cascade"}]},{collection:"doc/template",module:"doc",version:1,fields:[{name:"name",type:"string",required:!0,label:"Template Name"},{name:"category",type:"string",label:"Category"},{name:"content",type:"string",label:"Template Content"}],relations:[]},{collection:"doc/transmittal",module:"doc",version:1,fields:[{name:"number",type:"string",required:!0,label:"Transmittal Number"},{name:"to",type:"string",required:!0,label:"To"},{name:"subject",type:"string",label:"Subject"},{name:"status",type:"enum",enum:["draft","sent","acknowledged"],label:"Status"}],relations:[]},{collection:"doc/photo",module:"doc",version:1,fields:[{name:"fileName",type:"string",required:!0,label:"File Name"},{name:"jobId",type:"id",label:"Job"},{name:"caption",type:"string",label:"Caption"},{name:"takenDate",type:"date",label:"Date Taken"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]}],ue=[{collection:"proj/project",module:"proj",version:1,fields:[{name:"name",type:"string",required:!0,label:"Project Name"},{name:"jobId",type:"id",label:"Job"},{name:"startDate",type:"date",label:"Start Date"},{name:"status",type:"enum",enum:["planning","active","on-hold","complete"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"proj/phase",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"name",type:"string",required:!0,label:"Phase Name"},{name:"order",type:"number",label:"Sort Order"},{name:"status",type:"enum",enum:["pending","active","complete"],label:"Status"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/task",module:"proj",version:1,fields:[{name:"phaseId",type:"id",label:"Phase"},{name:"name",type:"string",required:!0,label:"Task Name"},{name:"assigneeId",type:"id",label:"Assignee"},{name:"status",type:"enum",enum:["todo","in-progress","done","blocked"],label:"Status"}],relations:[{foreignKey:"phaseId",collection:"proj/phase",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/milestone",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"name",type:"string",required:!0,label:"Milestone Name"},{name:"dueDate",type:"date",label:"Due Date"},{name:"status",type:"enum",enum:["upcoming","reached","missed"],label:"Status"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/rfi",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"number",type:"number",required:!0,label:"RFI Number"},{name:"subject",type:"string",required:!0,label:"Subject"},{name:"status",type:"enum",enum:["draft","open","answered","closed"],label:"Status"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/submittal",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"number",type:"number",required:!0,label:"Submittal Number"},{name:"description",type:"string",label:"Description"},{name:"status",type:"enum",enum:["pending","submitted","approved","rejected","revise-resubmit"],label:"Status"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/dailyLog",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"date",type:"date",required:!0,label:"Date"},{name:"weather",type:"string",label:"Weather"},{name:"notes",type:"string",label:"Notes"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/meetingMinutes",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"date",type:"date",required:!0,label:"Meeting Date"},{name:"subject",type:"string",required:!0,label:"Subject"},{name:"attendees",type:"array",label:"Attendees"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]},{collection:"proj/punchList",module:"proj",version:1,fields:[{name:"projectId",type:"id",required:!0,label:"Project"},{name:"description",type:"string",required:!0,label:"Description"},{name:"assigneeId",type:"id",label:"Assignee"},{name:"status",type:"enum",enum:["open","in-progress","complete","verified"],label:"Status"}],relations:[{foreignKey:"projectId",collection:"proj/project",type:"belongsTo",cascade:"cascade"}]}],me=[{collection:"svc/serviceAgreement",module:"svc",version:1,fields:[{name:"customerId",type:"id",required:!0,label:"Customer"},{name:"name",type:"string",required:!0,label:"Agreement Name"},{name:"startDate",type:"date",label:"Start Date"},{name:"status",type:"enum",enum:["active","expired","cancelled"],label:"Status"}],relations:[{foreignKey:"customerId",collection:"ar/customer",type:"belongsTo",cascade:"restrict"}]},{collection:"svc/workOrder",module:"svc",version:1,fields:[{name:"agreementId",type:"id",label:"Service Agreement"},{name:"description",type:"string",required:!0,label:"Description"},{name:"priority",type:"enum",enum:["low","medium","high","emergency"],label:"Priority"},{name:"status",type:"enum",enum:["new","assigned","in-progress","complete","invoiced"],label:"Status"}],relations:[{foreignKey:"agreementId",collection:"svc/serviceAgreement",type:"belongsTo",cascade:"nullify"}]},{collection:"svc/dispatch",module:"svc",version:1,fields:[{name:"workOrderId",type:"id",required:!0,label:"Work Order"},{name:"technicianId",type:"id",label:"Technician"},{name:"scheduledDate",type:"date",label:"Scheduled Date"},{name:"status",type:"enum",enum:["scheduled","dispatched","arrived","complete"],label:"Status"}],relations:[{foreignKey:"workOrderId",collection:"svc/workOrder",type:"belongsTo",cascade:"cascade"}]},{collection:"svc/call",module:"svc",version:1,fields:[{name:"customerId",type:"id",required:!0,label:"Customer"},{name:"subject",type:"string",required:!0,label:"Subject"},{name:"type",type:"enum",enum:["service-request","complaint","inquiry","emergency"],label:"Call Type"},{name:"status",type:"enum",enum:["new","assigned","resolved","closed"],label:"Status"}],relations:[{foreignKey:"customerId",collection:"ar/customer",type:"belongsTo",cascade:"restrict"}]},{collection:"svc/invoice",module:"svc",version:1,fields:[{name:"workOrderId",type:"id",required:!0,label:"Work Order"},{name:"amount",type:"currency",required:!0,label:"Amount"},{name:"status",type:"enum",enum:["draft","sent","paid","voided"],label:"Status"}],relations:[{foreignKey:"workOrderId",collection:"svc/workOrder",type:"belongsTo",cascade:"cascade"}]}],pe=[{collection:"inv/item",module:"inv",version:1,fields:[{name:"sku",type:"string",required:!0,label:"SKU"},{name:"description",type:"string",required:!0,label:"Description"},{name:"unitOfMeasure",type:"string",label:"Unit of Measure"},{name:"unitCost",type:"currency",label:"Unit Cost"}],relations:[]},{collection:"inv/location",module:"inv",version:1,fields:[{name:"name",type:"string",required:!0,label:"Location Name"},{name:"type",type:"enum",enum:["warehouse","jobsite","yard","vehicle"],label:"Location Type"},{name:"address",type:"string",label:"Address"}],relations:[]},{collection:"inv/receipt",module:"inv",version:1,fields:[{name:"itemId",type:"id",required:!0,label:"Item"},{name:"locationId",type:"id",required:!0,label:"Location"},{name:"quantity",type:"number",required:!0,label:"Quantity"},{name:"date",type:"date",required:!0,label:"Receipt Date"}],relations:[{foreignKey:"itemId",collection:"inv/item",type:"belongsTo",cascade:"restrict"},{foreignKey:"locationId",collection:"inv/location",type:"belongsTo",cascade:"restrict"}]},{collection:"inv/issue",module:"inv",version:1,fields:[{name:"itemId",type:"id",required:!0,label:"Item"},{name:"locationId",type:"id",required:!0,label:"From Location"},{name:"quantity",type:"number",required:!0,label:"Quantity"},{name:"jobId",type:"id",label:"Job"}],relations:[{foreignKey:"itemId",collection:"inv/item",type:"belongsTo",cascade:"restrict"},{foreignKey:"locationId",collection:"inv/location",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"inv/transfer",module:"inv",version:1,fields:[{name:"itemId",type:"id",required:!0,label:"Item"},{name:"fromLocationId",type:"id",required:!0,label:"From Location"},{name:"toLocationId",type:"id",required:!0,label:"To Location"},{name:"quantity",type:"number",required:!0,label:"Quantity"}],relations:[{foreignKey:"itemId",collection:"inv/item",type:"belongsTo",cascade:"restrict"},{foreignKey:"fromLocationId",collection:"inv/location",type:"belongsTo",cascade:"restrict"},{foreignKey:"toLocationId",collection:"inv/location",type:"belongsTo",cascade:"restrict"}]},{collection:"inv/count",module:"inv",version:1,fields:[{name:"locationId",type:"id",required:!0,label:"Location"},{name:"date",type:"date",required:!0,label:"Count Date"},{name:"status",type:"enum",enum:["draft","in-progress","complete","posted"],label:"Status"}],relations:[{foreignKey:"locationId",collection:"inv/location",type:"belongsTo",cascade:"restrict"}]}],ye=[{collection:"hr/position",module:"hr",version:1,fields:[{name:"title",type:"string",required:!0,label:"Position Title"},{name:"department",type:"string",label:"Department"},{name:"status",type:"enum",enum:["open","filled","closed"],label:"Status"},{name:"payGrade",type:"string",label:"Pay Grade"}],relations:[]},{collection:"hr/certification",module:"hr",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"name",type:"string",required:!0,label:"Certification Name"},{name:"issuedDate",type:"date",label:"Issued Date"},{name:"expirationDate",type:"date",label:"Expiration Date"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"cascade"}]},{collection:"hr/training",module:"hr",version:1,fields:[{name:"name",type:"string",required:!0,label:"Training Name"},{name:"type",type:"enum",enum:["required","optional","safety","professional"],label:"Training Type"},{name:"durationHours",type:"number",label:"Duration (Hours)"}],relations:[]},{collection:"hr/benefit",module:"hr",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"planId",type:"id",label:"Benefit Plan"},{name:"enrollmentDate",type:"date",label:"Enrollment Date"},{name:"status",type:"enum",enum:["active","waived","terminated"],label:"Status"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"cascade"}]},{collection:"hr/leave",module:"hr",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"type",type:"enum",enum:["vacation","sick","personal","fmla","bereavement"],label:"Leave Type"},{name:"startDate",type:"date",required:!0,label:"Start Date"},{name:"status",type:"enum",enum:["requested","approved","denied","cancelled"],label:"Status"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"cascade"}]},{collection:"hr/applicant",module:"hr",version:1,fields:[{name:"name",type:"string",required:!0,label:"Applicant Name"},{name:"positionId",type:"id",label:"Applied Position"},{name:"status",type:"enum",enum:["applied","screening","interview","offered","hired","rejected"],label:"Status"},{name:"applicationDate",type:"date",label:"Application Date"}],relations:[{foreignKey:"positionId",collection:"hr/position",type:"belongsTo",cascade:"nullify"}]}],he=[{collection:"safety/incident",module:"safety",version:1,fields:[{name:"date",type:"date",required:!0,label:"Incident Date"},{name:"description",type:"string",required:!0,label:"Description"},{name:"severity",type:"enum",enum:["near-miss","minor","moderate","serious","fatal"],label:"Severity"},{name:"jobId",type:"id",label:"Job"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"safety/inspection",module:"safety",version:1,fields:[{name:"jobId",type:"id",required:!0,label:"Job"},{name:"date",type:"date",required:!0,label:"Inspection Date"},{name:"inspectorId",type:"id",label:"Inspector"},{name:"result",type:"enum",enum:["pass","fail","conditional"],label:"Result"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"restrict"}]},{collection:"safety/oshaLog",module:"safety",version:1,fields:[{name:"year",type:"number",required:!0,label:"Year"},{name:"formType",type:"enum",enum:["300","300A","301"],required:!0,label:"Form Type"},{name:"status",type:"enum",enum:["draft","final","submitted"],label:"Status"}],relations:[]},{collection:"safety/toolboxTalk",module:"safety",version:1,fields:[{name:"topic",type:"string",required:!0,label:"Topic"},{name:"date",type:"date",required:!0,label:"Date"},{name:"jobId",type:"id",label:"Job"},{name:"attendees",type:"array",label:"Attendees"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"safety/corrective",module:"safety",version:1,fields:[{name:"incidentId",type:"id",label:"Incident"},{name:"description",type:"string",required:!0,label:"Corrective Action"},{name:"assigneeId",type:"id",label:"Assignee"},{name:"status",type:"enum",enum:["open","in-progress","complete","verified"],label:"Status"}],relations:[{foreignKey:"incidentId",collection:"safety/incident",type:"belongsTo",cascade:"cascade"}]},{collection:"safety/drugTest",module:"safety",version:1,fields:[{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"date",type:"date",required:!0,label:"Test Date"},{name:"type",type:"enum",enum:["pre-employment","random","post-incident","reasonable-suspicion"],label:"Test Type"},{name:"result",type:"enum",enum:["negative","positive","pending"],label:"Result"}],relations:[{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"}]}],ge=[{collection:"bond/surety",module:"bond",version:1,fields:[{name:"name",type:"string",required:!0,label:"Surety Name"},{name:"agentName",type:"string",label:"Agent Name"},{name:"bondingCapacity",type:"currency",label:"Bonding Capacity"},{name:"status",type:"enum",enum:["active","inactive"],label:"Status"}],relations:[]},{collection:"bond/bondPolicy",module:"bond",version:1,fields:[{name:"suretyId",type:"id",required:!0,label:"Surety"},{name:"jobId",type:"id",label:"Job"},{name:"type",type:"enum",enum:["bid","performance","payment","maintenance"],required:!0,label:"Bond Type"},{name:"amount",type:"currency",required:!0,label:"Bond Amount"}],relations:[{foreignKey:"suretyId",collection:"bond/surety",type:"belongsTo",cascade:"restrict"},{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"nullify"}]},{collection:"bond/claim",module:"bond",version:1,fields:[{name:"bondPolicyId",type:"id",required:!0,label:"Bond Policy"},{name:"claimantName",type:"string",required:!0,label:"Claimant"},{name:"amount",type:"currency",label:"Claim Amount"},{name:"status",type:"enum",enum:["filed","under-review","settled","denied"],label:"Status"}],relations:[{foreignKey:"bondPolicyId",collection:"bond/bondPolicy",type:"belongsTo",cascade:"restrict"}]},{collection:"bond/insurance",module:"bond",version:1,fields:[{name:"carrier",type:"string",required:!0,label:"Carrier"},{name:"policyNumber",type:"string",required:!0,label:"Policy Number"},{name:"type",type:"enum",enum:["general-liability","auto","umbrella","workers-comp","professional","builders-risk"],label:"Policy Type"},{name:"expirationDate",type:"date",label:"Expiration Date"}],relations:[]},{collection:"bond/coi",module:"bond",version:1,fields:[{name:"vendorId",type:"id",required:!0,label:"Vendor / Sub"},{name:"carrier",type:"string",label:"Carrier"},{name:"expirationDate",type:"date",required:!0,label:"Expiration Date"},{name:"status",type:"enum",enum:["valid","expired","pending"],label:"Status"}],relations:[{foreignKey:"vendorId",collection:"ap/vendor",type:"belongsTo",cascade:"restrict"}]}],be=[{collection:"bank/account",module:"bank",version:1,fields:[{name:"name",type:"string",required:!0,label:"Account Name"},{name:"accountNumber",type:"string",required:!0,label:"Account Number"},{name:"bankName",type:"string",label:"Bank Name"},{name:"type",type:"enum",enum:["checking","savings","money-market","line-of-credit"],label:"Account Type"}],relations:[]},{collection:"bank/statement",module:"bank",version:1,fields:[{name:"accountId",type:"id",required:!0,label:"Bank Account"},{name:"periodStart",type:"date",required:!0,label:"Period Start"},{name:"periodEnd",type:"date",required:!0,label:"Period End"},{name:"endingBalance",type:"currency",label:"Ending Balance"}],relations:[{foreignKey:"accountId",collection:"bank/account",type:"belongsTo",cascade:"cascade"}]},{collection:"bank/statementLine",module:"bank",version:1,fields:[{name:"statementId",type:"id",required:!0,label:"Statement"},{name:"date",type:"date",required:!0,label:"Date"},{name:"description",type:"string",label:"Description"},{name:"amount",type:"currency",required:!0,label:"Amount"}],relations:[{foreignKey:"statementId",collection:"bank/statement",type:"belongsTo",cascade:"cascade"}]},{collection:"bank/reconciliation",module:"bank",version:1,fields:[{name:"accountId",type:"id",required:!0,label:"Bank Account"},{name:"statementId",type:"id",label:"Statement"},{name:"date",type:"date",required:!0,label:"Reconciliation Date"},{name:"status",type:"enum",enum:["in-progress","balanced","unbalanced","posted"],label:"Status"}],relations:[{foreignKey:"accountId",collection:"bank/account",type:"belongsTo",cascade:"restrict"},{foreignKey:"statementId",collection:"bank/statement",type:"belongsTo",cascade:"nullify"}]},{collection:"bank/matchRule",module:"bank",version:1,fields:[{name:"name",type:"string",required:!0,label:"Rule Name"},{name:"pattern",type:"string",required:!0,label:"Match Pattern"},{name:"targetAccountId",type:"id",label:"Target GL Account"},{name:"priority",type:"number",label:"Priority"}],relations:[{foreignKey:"targetAccountId",collection:"gl/account",type:"belongsTo",cascade:"nullify"}]}],fe=[{collection:"contract/contract",module:"contract",version:1,fields:[{name:"number",type:"string",required:!0,label:"Contract Number"},{name:"jobId",type:"id",required:!0,label:"Job"},{name:"amount",type:"currency",required:!0,label:"Contract Amount"},{name:"status",type:"enum",enum:["draft","executed","active","complete","closed"],label:"Status"}],relations:[{foreignKey:"jobId",collection:"job/job",type:"belongsTo",cascade:"restrict"}]},{collection:"contract/sov",module:"contract",version:1,fields:[{name:"contractId",type:"id",required:!0,label:"Contract"},{name:"lineNumber",type:"number",required:!0,label:"Line Number"},{name:"description",type:"string",required:!0,label:"Description"},{name:"scheduledValue",type:"currency",required:!0,label:"Scheduled Value"}],relations:[{foreignKey:"contractId",collection:"contract/contract",type:"belongsTo",cascade:"cascade"}]},{collection:"contract/amendment",module:"contract",version:1,fields:[{name:"contractId",type:"id",required:!0,label:"Contract"},{name:"number",type:"number",required:!0,label:"Amendment Number"},{name:"amountChange",type:"currency",label:"Amount Change"},{name:"status",type:"enum",enum:["pending","approved","rejected"],label:"Status"}],relations:[{foreignKey:"contractId",collection:"contract/contract",type:"belongsTo",cascade:"cascade"}]},{collection:"contract/milestone",module:"contract",version:1,fields:[{name:"contractId",type:"id",required:!0,label:"Contract"},{name:"name",type:"string",required:!0,label:"Milestone Name"},{name:"dueDate",type:"date",label:"Due Date"},{name:"status",type:"enum",enum:["upcoming","reached","missed"],label:"Status"}],relations:[{foreignKey:"contractId",collection:"contract/contract",type:"belongsTo",cascade:"cascade"}]},{collection:"contract/closeout",module:"contract",version:1,fields:[{name:"contractId",type:"id",required:!0,label:"Contract"},{name:"status",type:"enum",enum:["pending","in-progress","complete"],label:"Status"},{name:"completionDate",type:"date",label:"Completion Date"}],relations:[{foreignKey:"contractId",collection:"contract/contract",type:"belongsTo",cascade:"cascade"}]},{collection:"contract/warranty",module:"contract",version:1,fields:[{name:"contractId",type:"id",required:!0,label:"Contract"},{name:"description",type:"string",required:!0,label:"Description"},{name:"startDate",type:"date",label:"Start Date"},{name:"expirationDate",type:"date",label:"Expiration Date"}],relations:[{foreignKey:"contractId",collection:"contract/contract",type:"belongsTo",cascade:"cascade"}]}],ve=[{collection:"fleet/asset",module:"fleet",version:1,fields:[{name:"vin",type:"string",required:!0,label:"VIN"},{name:"description",type:"string",required:!0,label:"Description"},{name:"type",type:"enum",enum:["truck","van","trailer","car","heavy-equipment"],label:"Vehicle Type"},{name:"status",type:"enum",enum:["active","maintenance","retired"],label:"Status"}],relations:[]},{collection:"fleet/inspection",module:"fleet",version:1,fields:[{name:"assetId",type:"id",required:!0,label:"Fleet Asset"},{name:"date",type:"date",required:!0,label:"Inspection Date"},{name:"type",type:"enum",enum:["pre-trip","post-trip","annual","dot"],label:"Inspection Type"},{name:"result",type:"enum",enum:["pass","fail","conditional"],label:"Result"}],relations:[{foreignKey:"assetId",collection:"fleet/asset",type:"belongsTo",cascade:"cascade"}]},{collection:"fleet/fuelCard",module:"fleet",version:1,fields:[{name:"cardNumber",type:"string",required:!0,label:"Card Number"},{name:"assetId",type:"id",label:"Assigned Vehicle"},{name:"status",type:"enum",enum:["active","suspended","cancelled"],label:"Status"}],relations:[{foreignKey:"assetId",collection:"fleet/asset",type:"belongsTo",cascade:"nullify"}]},{collection:"fleet/assignment",module:"fleet",version:1,fields:[{name:"assetId",type:"id",required:!0,label:"Fleet Asset"},{name:"employeeId",type:"id",required:!0,label:"Employee"},{name:"startDate",type:"date",required:!0,label:"Start Date"},{name:"endDate",type:"date",label:"End Date"}],relations:[{foreignKey:"assetId",collection:"fleet/asset",type:"belongsTo",cascade:"cascade"},{foreignKey:"employeeId",collection:"payroll/employee",type:"belongsTo",cascade:"restrict"}]},{collection:"fleet/depreciation",module:"fleet",version:1,fields:[{name:"assetId",type:"id",required:!0,label:"Fleet Asset"},{name:"method",type:"enum",enum:["straight-line","declining-balance","mileage-based"],label:"Method"},{name:"currentValue",type:"currency",label:"Current Value"},{name:"usefulLife",type:"number",label:"Useful Life (months)"}],relations:[{foreignKey:"assetId",collection:"fleet/asset",type:"belongsTo",cascade:"cascade"}]}],we=[{collection:"analytics/dashboard",module:"analytics",version:1,fields:[{name:"name",type:"string",required:!0,label:"Dashboard Name"},{name:"layout",type:"object",label:"Layout Configuration"},{name:"isDefault",type:"boolean",label:"Default Dashboard"}],relations:[]},{collection:"analytics/widget",module:"analytics",version:1,fields:[{name:"dashboardId",type:"id",required:!0,label:"Dashboard"},{name:"type",type:"enum",enum:["chart","kpi","table","list","map"],label:"Widget Type"},{name:"config",type:"object",label:"Widget Config"},{name:"position",type:"object",label:"Position"}],relations:[{foreignKey:"dashboardId",collection:"analytics/dashboard",type:"belongsTo",cascade:"cascade"}]},{collection:"analytics/savedReport",module:"analytics",version:1,fields:[{name:"name",type:"string",required:!0,label:"Report Name"},{name:"definition",type:"object",required:!0,label:"Report Definition"},{name:"schedule",type:"string",label:"Schedule (cron)"}],relations:[]},{collection:"analytics/kpiDef",module:"analytics",version:1,fields:[{name:"name",type:"string",required:!0,label:"KPI Name"},{name:"formula",type:"string",required:!0,label:"Formula"},{name:"unit",type:"enum",enum:["currency","percentage","number","days"],label:"Unit"},{name:"target",type:"number",label:"Target Value"}],relations:[]},{collection:"analytics/benchmark",module:"analytics",version:1,fields:[{name:"kpiDefId",type:"id",required:!0,label:"KPI Definition"},{name:"period",type:"string",required:!0,label:"Period"},{name:"value",type:"number",required:!0,label:"Benchmark Value"},{name:"source",type:"string",label:"Source"}],relations:[{foreignKey:"kpiDefId",collection:"analytics/kpiDef",type:"belongsTo",cascade:"cascade"}]}],qe=[{collection:"workflow/template",module:"workflow",version:1,fields:[{name:"name",type:"string",required:!0,label:"Template Name"},{name:"description",type:"string",label:"Description"},{name:"triggerCollection",type:"string",label:"Trigger Collection"},{name:"status",type:"enum",enum:["active","draft","archived"],label:"Status"}],relations:[]},{collection:"workflow/instance",module:"workflow",version:1,fields:[{name:"templateId",type:"id",required:!0,label:"Template"},{name:"entityId",type:"id",label:"Related Entity"},{name:"status",type:"enum",enum:["active","complete","cancelled","error"],label:"Status"},{name:"currentStepId",type:"id",label:"Current Step"}],relations:[{foreignKey:"templateId",collection:"workflow/template",type:"belongsTo",cascade:"restrict"}]},{collection:"workflow/step",module:"workflow",version:1,fields:[{name:"templateId",type:"id",required:!0,label:"Template"},{name:"name",type:"string",required:!0,label:"Step Name"},{name:"type",type:"enum",enum:["approval","notification","action","condition"],required:!0,label:"Step Type"},{name:"order",type:"number",label:"Sort Order"}],relations:[{foreignKey:"templateId",collection:"workflow/template",type:"belongsTo",cascade:"cascade"}]},{collection:"workflow/approval",module:"workflow",version:1,fields:[{name:"instanceId",type:"id",required:!0,label:"Workflow Instance"},{name:"stepId",type:"id",required:!0,label:"Step"},{name:"approverId",type:"id",label:"Approver"},{name:"decision",type:"enum",enum:["pending","approved","rejected","delegated"],label:"Decision"}],relations:[{foreignKey:"instanceId",collection:"workflow/instance",type:"belongsTo",cascade:"cascade"},{foreignKey:"stepId",collection:"workflow/step",type:"belongsTo",cascade:"restrict"}]},{collection:"workflow/escalation",module:"workflow",version:1,fields:[{name:"approvalId",type:"id",required:!0,label:"Approval"},{name:"escalatedToId",type:"id",label:"Escalated To"},{name:"reason",type:"string",label:"Reason"},{name:"status",type:"enum",enum:["pending","resolved"],label:"Status"}],relations:[{foreignKey:"approvalId",collection:"workflow/approval",type:"belongsTo",cascade:"cascade"}]}],Ie=[{collection:"integration/endpoint",module:"integration",version:1,fields:[{name:"name",type:"string",required:!0,label:"Endpoint Name"},{name:"url",type:"string",required:!0,label:"URL"},{name:"method",type:"enum",enum:["GET","POST","PUT","PATCH","DELETE"],label:"HTTP Method"},{name:"status",type:"enum",enum:["active","inactive","error"],label:"Status"}],relations:[]},{collection:"integration/webhook",module:"integration",version:1,fields:[{name:"name",type:"string",required:!0,label:"Webhook Name"},{name:"url",type:"string",required:!0,label:"Callback URL"},{name:"events",type:"array",label:"Subscribed Events"},{name:"status",type:"enum",enum:["active","inactive"],label:"Status"}],relations:[]},{collection:"integration/apiKey",module:"integration",version:1,fields:[{name:"name",type:"string",required:!0,label:"Key Name"},{name:"prefix",type:"string",required:!0,label:"Key Prefix"},{name:"expiresAt",type:"date",label:"Expires At"},{name:"status",type:"enum",enum:["active","revoked","expired"],label:"Status"}],relations:[]},{collection:"integration/syncLog",module:"integration",version:1,fields:[{name:"endpointId",type:"id",required:!0,label:"Endpoint"},{name:"direction",type:"enum",enum:["inbound","outbound"],required:!0,label:"Direction"},{name:"recordCount",type:"number",label:"Record Count"},{name:"status",type:"enum",enum:["success","partial","failed"],label:"Status"}],relations:[{foreignKey:"endpointId",collection:"integration/endpoint",type:"belongsTo",cascade:"cascade"}]},{collection:"integration/mapping",module:"integration",version:1,fields:[{name:"endpointId",type:"id",required:!0,label:"Endpoint"},{name:"sourceField",type:"string",required:!0,label:"Source Field"},{name:"targetField",type:"string",required:!0,label:"Target Field"},{name:"transform",type:"string",label:"Transform Expression"}],relations:[{foreignKey:"endpointId",collection:"integration/endpoint",type:"belongsTo",cascade:"cascade"}]}],Se=[{collection:"plugin/manifest",module:"plugin",version:1,fields:[{name:"name",type:"string",required:!0,label:"Plugin Name"},{name:"version",type:"string",required:!0,label:"Version"},{name:"author",type:"string",label:"Author"},{name:"status",type:"enum",enum:["installed","active","disabled","error"],label:"Status"}],relations:[]},{collection:"plugin/config",module:"plugin",version:1,fields:[{name:"pluginId",type:"id",required:!0,label:"Plugin"},{name:"key",type:"string",required:!0,label:"Key"},{name:"value",type:"object",label:"Value"}],relations:[{foreignKey:"pluginId",collection:"plugin/manifest",type:"belongsTo",cascade:"cascade"}]},{collection:"plugin/customObject",module:"plugin",version:1,fields:[{name:"pluginId",type:"id",required:!0,label:"Plugin"},{name:"name",type:"string",required:!0,label:"Object Name"},{name:"schema",type:"object",required:!0,label:"Schema Definition"}],relations:[{foreignKey:"pluginId",collection:"plugin/manifest",type:"belongsTo",cascade:"cascade"}]},{collection:"plugin/customField",module:"plugin",version:1,fields:[{name:"pluginId",type:"id",required:!0,label:"Plugin"},{name:"collection",type:"string",required:!0,label:"Target Collection"},{name:"fieldName",type:"string",required:!0,label:"Field Name"},{name:"fieldType",type:"enum",enum:["string","number","boolean","date","enum"],label:"Field Type"}],relations:[{foreignKey:"pluginId",collection:"plugin/manifest",type:"belongsTo",cascade:"cascade"}]},{collection:"plugin/script",module:"plugin",version:1,fields:[{name:"pluginId",type:"id",required:!0,label:"Plugin"},{name:"name",type:"string",required:!0,label:"Script Name"},{name:"trigger",type:"enum",enum:["beforeSave","afterSave","beforeDelete","afterDelete","scheduled"],label:"Trigger"},{name:"code",type:"string",label:"Script Code"}],relations:[{foreignKey:"pluginId",collection:"plugin/manifest",type:"belongsTo",cascade:"cascade"}]}],Te=[...X,...ee,...te,...ne,...re,...ie,...ae,...oe,...se,...le,...ce,...de,...ue,...me,...pe,...ye,...he,...ge,...be,...fe,...ve,...we,...qe,...Ie,...Se];class ke{schemas=new Map;migrationEngine;constructor(){this.migrationEngine=new Z(this.schemas)}register(e){if(this.schemas.has(e.collection))throw new Error(`Schema collision: collection "${e.collection}" is already registered`);this.schemas.set(e.collection,e)}get(e){return this.schemas.get(e)}getAll(){return Array.from(this.schemas.values())}getByModule(e){return this.getAll().filter(t=>t.module===e)}has(e){return this.schemas.has(e)}validate(e,t){const n=this.schemas.get(e);return n?Y(t,n):[`Unknown collection: ${e}`]}getRelationsFor(e){const t=this.schemas.get(e);return t?t.relations:[]}registerCoreSchemas(){for(const e of Te)this.schemas.has(e.collection)||this.schemas.set(e.collection,e)}migrate(e,t){const n=this.schemas.get(e);if(!n)throw new Error(`Schema not found for collection: ${e}`);return this.migrationEngine.run(e,t,0,n.version)}addField(e,t){const n=this.schemas.get(e);if(!n)throw new Error(`Cannot add field: collection "${e}" not found`);if(n.fields.some(i=>i.name===t.name))throw new Error(`Field "${t.name}" already exists in collection "${e}"`);n.fields.push(t)}addCollection(e){this.register(e)}}const Ee=new Set(["concrete.core","concrete.ui","concrete.store","concrete.router"]);class je{modules;events;store;schemas;logger;constructor(e,t,n,r){this.modules=new Map,this.events=e,this.store=t,this.schemas=n,this.logger=r}register(e){if(!e.id||typeof e.id!="string")throw new Error('Module manifest must have a non-empty string "id".');if(!e.name||typeof e.name!="string")throw new Error(`Module "${e.id}": manifest must have a non-empty "name".`);if(!e.version||typeof e.version!="string")throw new Error(`Module "${e.id}": manifest must have a "version" string.`);if(this.modules.has(e.id))throw new Error(`Module "${e.id}" is already registered. Disable and unregister it first if you need to replace it.`);this.modules.set(e.id,{manifest:e,status:"registered"}),this.logger.info("modules",`Registered module: ${e.id}@${e.version}`),this.events.emit("module.registered",{moduleId:e.id,version:e.version})}async enable(e){const t=this.modules.get(e);if(!t)throw new Error(`Cannot enable unknown module: ${e}`);if(t.status==="active"){this.logger.warn("modules",`Module "${e}" is already active.`);return}this.assertDependenciesMet(t.manifest),t.status="loading";try{const n=this.schemas;if(n&&typeof n.register=="function")for(const r of t.manifest.collections)n.register(r,t.manifest.id);for(const r of t.manifest.hooks)this.events.on(r.event,r.handler,r.priority??0);typeof t.manifest.activate=="function"&&await t.manifest.activate(),t.status="active",this.logger.info("modules",`Activated module: ${e}`),this.events.emit("module.activated",{moduleId:e,version:t.manifest.version})}catch(n){throw t.status="error",this.logger.error("modules",`Failed to activate module: ${e}`,n),this.events.emit("module.error",{moduleId:e,version:t.manifest.version,error:n instanceof Error?n:new Error(String(n))}),n}}async disable(e){const t=this.modules.get(e);if(!t)throw new Error(`Cannot disable unknown module: ${e}`);if(t.status==="disabled"){this.logger.warn("modules",`Module "${e}" is already disabled.`);return}if(this.isCoreModule(e))throw new Error(`Cannot disable core module: ${e}`);const n=this.getActiveDependants(e);if(n.length>0)throw new Error(`Cannot disable module "${e}" because the following active modules depend on it: `+n.join(", "));try{typeof t.manifest.deactivate=="function"&&await t.manifest.deactivate(),t.status="disabled",this.logger.info("modules",`Deactivated module: ${e}`),this.events.emit("module.deactivated",{moduleId:e})}catch(r){throw t.status="error",this.logger.error("modules",`Failed to deactivate module: ${e}`,r),r}}isEnabled(e){return this.modules.get(e)?.status==="active"}getStatus(e){return this.modules.get(e)?.status}getAll(){return Array.from(this.modules.values()).map(e=>({manifest:e.manifest,status:e.status}))}getActive(){const e=[];for(const t of this.modules.values())t.status==="active"&&e.push(t.manifest);return e}get(e){return this.modules.get(e)?.manifest}getStore(){return this.store}resolveDependencyOrder(e){const t=new Set(e),n=new Map,r=new Map;for(const o of e){n.has(o)||n.set(o,0),r.has(o)||r.set(o,[]);const l=this.modules.get(o);if(l)for(const c of l.manifest.dependencies)t.has(c)&&(r.has(c)||r.set(c,[]),r.get(c).push(o),n.set(o,(n.get(o)??0)+1))}const i=[];for(const[o,l]of n)l===0&&i.push(o);const a=[];for(;i.length>0;){const o=i.shift();a.push(o);for(const l of r.get(o)??[]){const c=(n.get(l)??1)-1;n.set(l,c),c===0&&i.push(l)}}if(a.length!==e.length){const o=e.filter(l=>!a.includes(l));throw new Error(`Cyclic dependency detected among modules: ${o.join(", ")}`)}return a}async healthCheck(){const e=new Map;for(const[t,n]of this.modules)if(n.status==="active")try{for(const r of n.manifest.dependencies)if(!this.isEnabled(r)){e.set(t,{healthy:!1,message:`Dependency "${r}" is not active.`});continue}e.has(t)||e.set(t,{healthy:!0})}catch(r){e.set(t,{healthy:!1,message:r instanceof Error?r.message:String(r)})}return e}isCoreModule(e){return Ee.has(e)}assertDependenciesMet(e){for(const t of e.dependencies){const n=this.modules.get(t);if(!n)throw new Error(`Module "${e.id}" depends on "${t}", which is not registered.`);if(n.status!=="active")throw new Error(`Module "${e.id}" depends on "${t}", which is not active (status: ${n.status}).`)}}getActiveDependants(e){const t=[];for(const[n,r]of this.modules)n!==e&&r.status==="active"&&r.manifest.dependencies.includes(e)&&t.push(n);return t}}function Ce(s,e){const t=s.split("/").filter(Boolean);if(t.length===0)return[{label:"Home",path:"/",active:!0}];const n=[],r=E("/",e)!==null;n.push({label:r?E("/",e).title??"Home":"Home",path:"/",active:!1});let i="";for(let a=0;a<t.length;a++){i+="/"+t[a];const o=a===t.length-1,c=E(i,e)?.title??xe(t[a]);n.push({label:c,path:o?void 0:i,active:o})}return n}function E(s,e){for(const[,t]of e)if(t.pattern.test(s))return t;return null}function xe(s){return/^[0-9a-f-]+$/i.test(s)&&/\d/.test(s)?s:s.replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase())}class Ae{routes=new Map;currentRoute=null;previousRoute=null;navigationHistory=[];globalFilters={};events;modules;permissions;started=!1;hashChangeHandler;constructor(e,t,n){this.events=e,this.modules=t,this.permissions=n,this.hashChangeHandler=this.onHashChange.bind(this)}register(e){const{paramNames:t,regex:n}=this.compilePath(e.path),r=()=>{const a=e.component();return a instanceof Promise?a:Promise.resolve(a)},i={path:e.path,pattern:n,paramNames:t,component:r,title:e.title,icon:e.icon,guard:e.guard,meta:e.meta};this.routes.set(e.path,i)}start(){if(this.started)return;this.started=!0,window.addEventListener("hashchange",this.hashChangeHandler);const{path:e,query:t}=this.parseHash(window.location.hash);this.navigate(e||"/",t)}stop(){this.started&&(this.started=!1,window.removeEventListener("hashchange",this.hashChangeHandler))}async navigate(e,t){const n=this.matchRoute(e);if(!n){this.handleNotFound(e);return}const r={...this.globalFilters,...t},i={route:n.route,params:n.params,query:r},a={to:i,from:this.currentRoute,cancelled:!1};if(this.events.emit("navigation.before",a),a.cancelled)return;if(n.route.guard){const c=n.route.guard(i,this.currentRoute);if(c===!1)return;if(typeof c=="string"){this.navigate(c);return}}const o=n.route.meta?.moduleId;if(o){const c=this.permissions;if(typeof c.canAccessModule=="function"&&!c.canAccessModule(o)){this.events.emit("navigation.forbidden",{path:e,moduleId:o});return}}const l="#"+this.buildHash(e,r);window.location.hash!==l&&(window.removeEventListener("hashchange",this.hashChangeHandler),window.location.hash=l,queueMicrotask(()=>{this.started&&window.addEventListener("hashchange",this.hashChangeHandler)})),this.previousRoute=this.currentRoute,this.currentRoute=i,this.navigationHistory.push(i),n.route.title&&(document.title=`${n.route.title} | Concrete`),this.events.emit("navigation.after",{to:i,from:this.previousRoute})}back(){if(this.previousRoute){const e=this.previousRoute.route.path;this.navigate(e,this.previousRoute.query)}else window.history.back()}getCurrent(){return this.currentRoute}getModules(){return this.modules}getPrevious(){return this.previousRoute}getBreadcrumbs(){if(!this.currentRoute)return[];const e=this.resolveCurrentPath();return Ce(e,this.routes)}getState(){return{currentRoute:this.currentRoute,history:[...this.navigationHistory],breadcrumbs:this.getBreadcrumbs()}}setGlobalFilter(e,t){this.globalFilters[e]=t,this.events.emit("navigation.filterChanged",{key:e,value:t,filters:{...this.globalFilters}})}removeGlobalFilter(e){delete this.globalFilters[e],this.events.emit("navigation.filterChanged",{key:e,value:void 0,filters:{...this.globalFilters}})}getGlobalFilters(){return{...this.globalFilters}}onHashChange(){const{path:e,query:t}=this.parseHash(window.location.hash);this.navigate(e||"/",t)}parseHash(e){let t=e.startsWith("#")?e.slice(1):e;t.startsWith("/")||(t="/"+t);const n=t.indexOf("?"),r=n>=0?t.slice(0,n):t,i=n>=0?t.slice(n+1):"",a={};return i&&new URLSearchParams(i).forEach((l,c)=>{a[c]=l}),{path:this.normalizePath(r),query:a}}buildHash(e,t){const n=this.normalizePath(e),r=Object.entries(t).filter(([,a])=>a!==void 0&&a!=="");if(r.length===0)return n;const i=new URLSearchParams(r).toString();return`${n}?${i}`}normalizePath(e){let t=e;return t.startsWith("/")||(t="/"+t),t.length>1&&t.endsWith("/")&&(t=t.slice(0,-1)),t}matchRoute(e){const t=this.normalizePath(e),n=[...this.routes.values()].sort((r,i)=>r.paramNames.length-i.paramNames.length);for(const r of n){const i=t.match(r.pattern);if(i){const a={};return r.paramNames.forEach((o,l)=>{a[o]=decodeURIComponent(i[l+1]??"")}),{route:r,params:a}}}return null}compilePath(e){const t=[],r=this.normalizePath(e).split("/").map(i=>i.startsWith(":")?(t.push(i.slice(1)),"([^/]+)"):i==="*"?(t.push("wildcard"),"(.*)"):i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("/");return{regex:new RegExp("^"+r+"$"),paramNames:t}}resolveCurrentPath(){if(!this.currentRoute)return"/";const e=this.currentRoute.route.path,t=this.currentRoute.params;return e.replace(/:([^/]+)/g,(n,r)=>t[r]??r)}handleNotFound(e){this.events.emit("navigation.notFound",{path:e});const t=this.routes.get("/*")??this.routes.get("*");if(t){const n={route:{path:t.path,pattern:t.pattern,component:t.component,title:t.title,icon:t.icon,guard:t.guard,meta:t.meta},params:{wildcard:e},query:{...this.globalFilters}};this.previousRoute=this.currentRoute,this.currentRoute=n,this.navigationHistory.push(n),this.events.emit("navigation.after",{to:n,from:this.previousRoute})}}}function j(s,e){if(s==="*"||s===e)return!0;if(s.includes("*")){const n="^"+s.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*")+"$";return new RegExp(n).test(e)}return!1}class Re{currentUser=null;roles=new Map;segregationRules=[];_store;events;constructor(e,t){this._store=e,this.events=t,this.registerDefaultRoles()}get store(){return this._store}setUser(e){this.currentUser=e,this.events.emit("permissions.user.changed",{userId:e.userId})}clearUser(){this.currentUser=null,this.events.emit("permissions.user.cleared",{})}registerRole(e){this.roles.set(e.id,e)}unregisterRole(e){this.roles.delete(e)}getRole(e){return this.roles.get(e)}getAllRoles(){return Array.from(this.roles.values())}addSegregationRule(e){this.segregationRules.push(e)}can(e,t,n){if(!this.currentUser)return{allowed:!0};if(!this.getEffectivePermissions().some(o=>j(o.resource,t)&&(o.action===e||o.action==="admin")))return{allowed:!1,reason:`Missing permission: ${e} on ${t}`};const a=this.checkSegregation(e,t,n);return a?{allowed:!1,reason:a}:{allowed:!0}}canDo(e,t){return this.can(e,t).allowed}canAccessEntity(e){return!this.currentUser||!this.currentUser.entityScope||this.currentUser.entityScope.length===0?!0:this.currentUser.entityScope.includes(e)}canSeeField(e,t){if(!this.currentUser)return"full";const n=this.currentUser.roles.map(i=>this.roles.get(i)).filter(Boolean);let r="full";for(const i of n){if(!i.fieldRestrictions)continue;const a=i.fieldRestrictions.find(o=>o.collection===e&&o.field===t);if(a){if(a.access==="hidden")return"hidden";a.access==="readonly"&&(r="readonly")}}return r}canAccessModule(e){return this.can("read",e).allowed}filterEntities(e){return e.filter(t=>this.canAccessEntity(t))}applyFieldRestrictions(e,t){const n={};for(const[r,i]of Object.entries(t))this.canSeeField(e,r)!=="hidden"&&(n[r]=i);return n}getCurrentUser(){return this.currentUser}getEffectivePermissions(){if(!this.currentUser)return[];const e=[...this.currentUser.directPermissions??[]];for(const t of this.currentUser.roles){const n=this.roles.get(t);n&&e.push(...n.permissions)}return e}checkSegregation(e,t,n){if(!this.currentUser||this.segregationRules.length===0)return null;const r=this.getEffectivePermissions();for(const i of this.segregationRules){if(!j(i.resource,t)||!i.actions.includes(e))continue;const a=i.actions.filter(o=>o!==e);for(const o of a)if(r.some(c=>j(c.resource,t)&&(c.action===o||c.action==="admin")))return`Segregation of duties violation: user cannot hold both "${e}" and "${o}" on "${t}"`}return null}registerDefaultRoles(){this.registerRole({id:"admin",name:"Administrator",description:"Full system access",permissions:[{resource:"*",action:"admin"}]}),this.registerRole({id:"controller",name:"Financial Controller",description:"Full financial access, module management",permissions:[{resource:"gl/*",action:"admin"},{resource:"job/*",action:"admin"},{resource:"ap/*",action:"admin"},{resource:"ar/*",action:"admin"},{resource:"payroll/*",action:"read"},{resource:"payroll/*",action:"approve"}]}),this.registerRole({id:"project_manager",name:"Project Manager",description:"Job and project management",permissions:[{resource:"job/*",action:"read"},{resource:"job/*",action:"update"},{resource:"sub/*",action:"read"},{resource:"sub/*",action:"update"},{resource:"proj/*",action:"admin"},{resource:"doc/*",action:"admin"}]}),this.registerRole({id:"ap_clerk",name:"AP Clerk",description:"Accounts payable data entry",permissions:[{resource:"ap/*",action:"create"},{resource:"ap/*",action:"read"},{resource:"ap/*",action:"update"}]}),this.registerRole({id:"ar_clerk",name:"AR Clerk",description:"Accounts receivable and billing",permissions:[{resource:"ar/*",action:"create"},{resource:"ar/*",action:"read"},{resource:"ar/*",action:"update"}]}),this.registerRole({id:"payroll_admin",name:"Payroll Administrator",description:"Full payroll access",permissions:[{resource:"payroll/*",action:"admin"},{resource:"union/*",action:"admin"}],fieldRestrictions:[]}),this.registerRole({id:"payroll_clerk",name:"Payroll Clerk",description:"Payroll data entry and time processing",permissions:[{resource:"payroll/timeEntry",action:"create"},{resource:"payroll/timeEntry",action:"read"},{resource:"payroll/timeEntry",action:"update"},{resource:"payroll/employee",action:"read"},{resource:"payroll/check",action:"read"},{resource:"union/rate",action:"read"}],fieldRestrictions:[{collection:"payroll/employee",field:"ssn",access:"hidden"},{collection:"payroll/employee",field:"salary",access:"hidden"}]}),this.registerRole({id:"estimator",name:"Estimator",description:"Estimating and bidding",permissions:[{resource:"job/estimate",action:"admin"},{resource:"job/bid",action:"admin"},{resource:"job/costCode",action:"read"},{resource:"sub/prequalification",action:"read"}]}),this.registerRole({id:"foreman",name:"Field Foreman",description:"Field operations",permissions:[{resource:"payroll/timeEntry",action:"create"},{resource:"payroll/timeEntry",action:"read"},{resource:"proj/dailyLog",action:"create"},{resource:"proj/dailyLog",action:"read"},{resource:"safety/*",action:"create"},{resource:"safety/*",action:"read"},{resource:"equip/usage",action:"create"}]}),this.registerRole({id:"technician",name:"Field Technician",description:"Equipment operation and maintenance logging",permissions:[{resource:"equip/usage",action:"create"},{resource:"equip/usage",action:"read"},{resource:"equip/maintenance",action:"create"},{resource:"equip/maintenance",action:"read"},{resource:"safety/incident",action:"create"},{resource:"safety/incident",action:"read"}]}),this.registerRole({id:"readonly",name:"Read Only",description:"View-only access to all data",permissions:[{resource:"*",action:"read"}]})}}const K={critical:0,"action-required":1,warning:2,info:3,success:4};class Ne{notifications=[];rules=[];preferences=new Map;events;_config;toastQueue=[];constructor(e,t){this.events=e,this._config=t}get config(){return this._config}notify(e){const t={id:f(),createdAt:g(),updatedAt:g(),version:1,type:e.type,title:e.title,message:e.message,source:e.source??"system",entityId:e.entityId,link:e.link,read:!1,acknowledged:!1,channel:e.channel??"panel"};return this.notifications.push(t),this.events.emit("notification.created",t),(e.type==="critical"||e.type==="action-required")&&(this.toastQueue.push(t),this.events.emit("toast.show",{id:t.id,type:e.type,title:e.title,message:e.message})),t}getAll(e){let t=[...this.notifications];return e?.unreadOnly&&(t=t.filter(n=>!n.read)),e?.type&&(t=t.filter(n=>n.type===e.type)),e?.source&&(t=t.filter(n=>n.source===e.source)),t.sort((n,r)=>{const i=K[n.type]??99,a=K[r.type]??99;return i!==a?i-a:r.createdAt.localeCompare(n.createdAt)}),e?.limit&&e.limit>0&&(t=t.slice(0,e.limit)),t}getUnreadCount(){return this.notifications.filter(e=>!e.read).length}getUnreadCountByType(){const e={critical:0,"action-required":0,warning:0,info:0,success:0};for(const t of this.notifications)t.read||(e[t.type]+=1);return e}getById(e){return this.notifications.find(t=>t.id===e)}markRead(e){const t=this.notifications.find(n=>n.id===e);t&&!t.read&&(t.read=!0,t.updatedAt=g(),t.version+=1,this.events.emit("notification.read",{id:e}))}markAllRead(){let e=!1;for(const t of this.notifications)t.read||(t.read=!0,t.updatedAt=g(),t.version+=1,e=!0);e&&this.events.emit("notification.allRead",{})}acknowledge(e){const t=this.notifications.find(n=>n.id===e);t&&!t.acknowledged&&(t.acknowledged=!0,t.read=!0,t.updatedAt=g(),t.version+=1,this.events.emit("notification.acknowledged",{id:e}))}snooze(e,t){const n=this.notifications.find(r=>r.id===e);n&&(n.snoozedUntil=t,n.read=!0,n.updatedAt=g(),n.version+=1,this.events.emit("notification.snoozed",{id:e,until:t}))}remove(e){const t=this.notifications.findIndex(n=>n.id===e);t!==-1&&(this.notifications.splice(t,1),this.events.emit("notification.removed",{id:e}))}clear(){this.notifications=[],this.toastQueue=[],this.events.emit("notification.cleared",{})}dequeueToast(){return this.toastQueue.shift()}peekToastQueue(){return this.toastQueue}addRule(e){const t=this.rules.findIndex(n=>n.id===e.id);t!==-1?this.rules[t]=e:this.rules.push(e),this.events.emit("alertRule.added",{id:e.id})}removeRule(e){const t=this.rules.findIndex(n=>n.id===e);t!==-1&&(this.rules.splice(t,1),this.events.emit("alertRule.removed",{id:e}))}toggleRule(e,t){const n=this.rules.find(r=>r.id===e);n&&(n.enabled=t)}getRules(){return[...this.rules]}evaluateRules(e,t){const n=[];for(const r of this.rules){if(!r.enabled||r.collection!==e)continue;const i=t[r.field];if(i==null)continue;let a=!1;switch(r.operator){case"<":a=typeof i=="number"&&typeof r.value=="number"&&i<r.value;break;case"<=":a=typeof i=="number"&&typeof r.value=="number"&&i<=r.value;break;case">":a=typeof i=="number"&&typeof r.value=="number"&&i>r.value;break;case">=":a=typeof i=="number"&&typeof r.value=="number"&&i>=r.value;break;case"=":a=i===r.value;break;case"!=":a=i!==r.value;break;case"contains":a=typeof i=="string"&&typeof r.value=="string"&&i.includes(r.value);break;case"not_contains":a=typeof i=="string"&&typeof r.value=="string"&&!i.includes(r.value);break}if(a){const o=this.notify({type:r.notificationType,title:r.name,message:`${r.field} is ${r.operator} ${String(r.value)} (current: ${String(i)})`,source:"alert-rule",entityId:t.id??void 0});n.push(o)}}return n}setPreference(e){const t=`${e.userId}::${e.notificationType}`;this.preferences.set(t,e)}getPreference(e,t){const n=`${e}::${t}`;return this.preferences.get(n)}getUserPreferences(e){const t=[];for(const n of this.preferences.values())n.userId===e&&t.push(n);return t}shouldDeliver(e,t,n){const r=this.getPreference(e,t);return r?r.enabled?r.channels.includes(n):!1:!0}}const De=new Set(["a","an","the","and","or","but","in","on","at","to","for","of","with","by","from","is","it","as","be","was","are","were","been","has","had","have","do","does","did","will","would","could","should","may","might","can","this","that","these","those","not","no","if","so","up","out","then"]);class Ke{index;titleCache;subtitleCache;dataCache;store;schemas;constructor(e,t){this.index=new Map,this.titleCache=new Map,this.subtitleCache=new Map,this.dataCache=new Map,this.store=e,this.schemas=t}async buildIndex(){this.index.clear(),this.titleCache.clear(),this.subtitleCache.clear(),this.dataCache.clear();const e=this.schemas.getAll();for(const t of e){const n=t.collection,r=t.fields.filter(a=>a.type==="string"||a.type==="id").map(a=>a.name);if(r.length===0)continue;let i;try{i=await this.store.getAll(n)}catch{continue}for(const a of i){if(a.deletedAt!=null)continue;const o=a.id;if(!o)continue;const l=`${n}:${o}`;this.dataCache.set(l,a);const c=a.name??a.title??a.description??a.number??o;this.titleCache.set(l,String(c));const y=[];a.number&&a.name&&y.push(String(a.number)),a.status&&y.push(String(a.status)),y.length>0&&this.subtitleCache.set(l,y.join(" | "));for(const h of r){const d=a[h];if(typeof d!="string"||d.length===0)continue;const u=this.tokenize(d);for(const m of u){const p=this.index.get(m),b={collection:n,id:o,field:h};p?p.push(b):this.index.set(m,[b])}}}}}updateRecord(e,t){const n=t.id;if(!n||(this.removeRecord(e,n),t.deletedAt!=null))return;const r=`${e}:${n}`;this.dataCache.set(r,t);const i=t.name??t.title??t.description??t.number??n;this.titleCache.set(r,String(i));const a=[];t.number&&t.name&&a.push(String(t.number)),t.status&&a.push(String(t.status)),a.length>0&&this.subtitleCache.set(r,a.join(" | "));const o=this.schemas.get(e),l=o?o.fields.filter(c=>c.type==="string"||c.type==="id").map(c=>c.name):Object.keys(t).filter(c=>typeof t[c]=="string");for(const c of l){const y=t[c];if(typeof y!="string"||y.length===0)continue;const h=this.tokenize(y);for(const d of h){const u=this.index.get(d),m={collection:e,id:n,field:c};u?u.push(m):this.index.set(d,[m])}}}removeRecord(e,t){const n=`${e}:${t}`;this.titleCache.delete(n),this.subtitleCache.delete(n),this.dataCache.delete(n);for(const[r,i]of this.index){const a=i.filter(o=>!(o.collection===e&&o.id===t));a.length===0?this.index.delete(r):a.length!==i.length&&this.index.set(r,a)}}search(e,t){if(!e||e.trim().length===0)return[];const n=this.tokenize(e);if(n.length===0)return[];const r=t?.limit??50,i=t?.fuzzy??!0,a=t?.collections?new Set(t.collections):null,o=new Map,l=new Map;for(const d of n){const u=new Set;for(const[m,p]of this.index){const b=this.scoreMatch(d,m,i);if(b!==0)for(const q of p){if(a&&!a.has(q.collection))continue;const w=`${q.collection}:${q.id}`;u.add(w);const I=o.get(w)??0;o.set(w,I+b)}}l.set(d,u)}const c=[...l.values()];if(c.length===0)return[];let y=c[0];for(let d=1;d<c.length;d++){const u=c[d],m=new Set;for(const p of y)u.has(p)&&m.add(p);y=m}const h=[];for(const d of y){const u=o.get(d)??0,[m,p]=this.splitCacheKey(d);h.push({id:p,collection:m,title:this.titleCache.get(d)??p,subtitle:this.subtitleCache.get(d),score:u,data:this.dataCache.get(d)})}return h.sort((d,u)=>u.score-d.score),h.slice(0,r)}tokenize(e){return e.toLowerCase().split(/[\s,.\-_/\\|;:!?'"()\[\]{}#@&*+=<>~`]+/).filter(r=>r.length>0&&r.length<=100&&!De.has(r))}scoreMatch(e,t,n){if(e===t)return 100;if(t.startsWith(e))return 80;if(t.includes(e))return 60;if(n&&e.length>=3&&t.length>=3){const r=this.levenshtein(e,t),i=Math.max(e.length,t.length),a=1-r/i;if(a>=.7)return Math.round(40*a)}return 0}levenshtein(e,t){const n=e.length,r=t.length,i=new Array(r+1),a=new Array(r+1);for(let o=0;o<=r;o++)i[o]=o;for(let o=1;o<=n;o++){a[0]=o;for(let l=1;l<=r;l++){const c=e[o-1]===t[l-1]?0:1;a[l]=Math.min(i[l]+1,a[l-1]+1,i[l-1]+c)}for(let l=0;l<=r;l++)i[l]=a[l]}return i[r]}splitCacheKey(e){const t=e.indexOf(":");return t===-1?[e,""]:[e.substring(0,t),e.substring(t+1)]}}class Pe{shortcuts=new Map;customBindings=new Map;activeScope="global";installed=!1;bindingsStorageKey="concrete_keybindings";keydownHandler;constructor(){this.keydownHandler=this.onKeydown.bind(this),this.loadCustomBindings()}install(){this.installed||(this.installed=!0,document.addEventListener("keydown",this.keydownHandler))}uninstall(){this.installed&&(this.installed=!1,document.removeEventListener("keydown",this.keydownHandler))}register(e){const t={...e,scope:e.scope??"global",enabled:e.enabled??!0},n=this.customBindings.get(e.id);n&&(t.keys=n),this.shortcuts.set(e.id,t)}unregister(e){this.shortcuts.delete(e)}setScope(e){this.activeScope=e}getScope(){return this.activeScope}getAll(){return[...this.shortcuts.values()]}getByScope(e){return[...this.shortcuts.values()].filter(t=>t.scope===e)}rebind(e,t){const n=this.shortcuts.get(e);n&&(n.keys=t),this.customBindings.set(e,t),this.persistCustomBindings()}resetBinding(e){this.customBindings.delete(e),this.persistCustomBindings()}registerDefaults(){this.register({id:"global.commandPalette",keys:"ctrl+k",description:"Open command palette",scope:"global",handler:e=>{e.preventDefault(),document.dispatchEvent(new CustomEvent("concrete:command-palette",{detail:{action:"toggle"}}))}}),this.register({id:"global.undo",keys:"ctrl+z",description:"Undo last action",scope:"global",handler:e=>{const t=e.target;this.isEditableElement(t)||(e.preventDefault(),document.dispatchEvent(new CustomEvent("concrete:undo")))}}),this.register({id:"global.redo",keys:"ctrl+shift+z",description:"Redo last undone action",scope:"global",handler:e=>{const t=e.target;this.isEditableElement(t)||(e.preventDefault(),document.dispatchEvent(new CustomEvent("concrete:redo")))}}),this.register({id:"global.save",keys:"ctrl+s",description:"Save current form",scope:"global",handler:e=>{e.preventDefault(),document.dispatchEvent(new CustomEvent("concrete:save"))}}),this.register({id:"global.escape",keys:"escape",description:"Close modal or dismiss",scope:"global",handler:e=>{document.dispatchEvent(new CustomEvent("concrete:escape"))}}),this.register({id:"global.help",keys:"shift+/",description:"Show keyboard shortcuts help",scope:"global",handler:e=>{const t=e.target;this.isEditableElement(t)||(e.preventDefault(),document.dispatchEvent(new CustomEvent("concrete:shortcuts-help")))}})}onKeydown(e){const t=this.parseEvent(e);for(const n of this.shortcuts.values()){if(!n.enabled||n.scope!=="global"&&n.scope!==this.activeScope)continue;const r=this.normalizeKeys(n.keys);if(t===r){n.handler(e);return}}}parseEvent(e){const t=[];(e.ctrlKey||e.metaKey)&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift");let n=e.key.toLowerCase();return n={escape:"escape",esc:"escape",enter:"enter",return:"enter",backspace:"backspace",delete:"delete",tab:"tab",arrowup:"up",arrowdown:"down",arrowleft:"left",arrowright:"right"," ":"space","/":"/"}[n]??n,["control","alt","shift","meta"].includes(n)||t.push(n),t.join("+")}normalizeKeys(e){const t=e.toLowerCase().split("+").map(i=>i.trim()),n=[];let r="";for(const i of t)["ctrl","cmd","meta","control"].includes(i)?n.push("ctrl"):i==="alt"||i==="option"?n.push("alt"):i==="shift"?n.push("shift"):r=i;return n.sort(),r&&n.push(r),n.join("+")}isEditableElement(e){const t=e.tagName.toLowerCase();return!!(t==="input"||t==="textarea"||t==="select"||e.isContentEditable)}loadCustomBindings(){try{if(typeof localStorage>"u")return;const e=localStorage.getItem(this.bindingsStorageKey);if(e){const t=JSON.parse(e);if(t&&typeof t=="object")for(const[n,r]of Object.entries(t))this.customBindings.set(n,r)}}catch{}}persistCustomBindings(){try{if(typeof localStorage>"u")return;const e={};for(const[t,n]of this.customBindings)e[t]=n;localStorage.setItem(this.bindingsStorageKey,JSON.stringify(e))}catch{}}}const $e=(s,e,t)=>{const n=s[e];return n?typeof n=="function"?n():Promise.resolve(n):new Promise((r,i)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(i.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};class Le{translations={};fallback={};locale="en-US";storageKey="concrete_locale";constructor(){this.restoreLocale()}async load(e){if(Object.keys(this.fallback).length===0)try{const t=await C(()=>import("./en-US-CtoLYdsg.js"),[],import.meta.url);this.fallback=this.flattenTranslations(t.default??t)}catch{}if(e==="en-US")this.translations={...this.fallback};else try{const t=await $e(Object.assign({"../../locales/en-US.json":()=>C(()=>import("./en-US-CtoLYdsg.js"),[],import.meta.url)}),`../../locales/${e}.json`,4);this.translations=this.flattenTranslations(t.default??t)}catch{this.translations={...this.fallback}}this.locale=e,this.persistLocale()}t(e,t){let n=this.translations[e]??this.fallback[e]??e;if(t)for(const[r,i]of Object.entries(t))n=n.replace(new RegExp(`\\{\\{${r}\\}\\}`,"g"),String(i));return n}getLocale(){return this.locale}async setLocale(e){await this.load(e)}registerTranslations(e,t){for(const[n,r]of Object.entries(t)){const i=`${e}.${n}`;this.translations[i]=r,this.locale==="en-US"&&(this.fallback[i]=r)}}has(e){return e in this.translations||e in this.fallback}getKeys(){return[...new Set([...Object.keys(this.translations),...Object.keys(this.fallback)])].sort()}getTranslations(){return{...this.fallback,...this.translations}}flattenTranslations(e,t=""){const n={};for(const[r,i]of Object.entries(e)){const a=t?`${t}.${r}`:r;typeof i=="string"?n[a]=i:i!==null&&typeof i=="object"&&!Array.isArray(i)&&Object.assign(n,this.flattenTranslations(i,a))}return n}persistLocale(){try{if(typeof localStorage>"u")return;localStorage.setItem(this.storageKey,this.locale)}catch{}}restoreLocale(){try{if(typeof localStorage>"u")return;const e=localStorage.getItem(this.storageKey);e&&(this.locale=e)}catch{}}}class Me{undoStack=[];redoStack=[];maxHistory;store;events;constructor(e,t,n=100){this.store=e,this.events=t,this.maxHistory=n}async execute(e){await e.execute(),this.undoStack.push(e),this.undoStack.length>this.maxHistory&&this.undoStack.splice(0,this.undoStack.length-this.maxHistory),this.redoStack=[],this.events.emit("history.executed",{timestamp:g(),commandId:e.id,description:e.description})}async undo(){const e=this.undoStack.pop();return e?(await e.undo(),this.redoStack.push(e),this.events.emit("history.undone",{timestamp:g(),commandId:e.id,description:e.description}),e):null}async redo(){const e=this.redoStack.pop();return e?(await e.execute(),this.undoStack.push(e),this.events.emit("history.redone",{timestamp:g(),commandId:e.id,description:e.description}),e):null}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}getUndoStack(){return this.undoStack.map(e=>({id:e.id,description:e.description,timestamp:e.timestamp}))}getRedoStack(){return this.redoStack.map(e=>({id:e.id,description:e.description,timestamp:e.timestamp}))}createInsertCommand(e,t){const n=this.store,r=t.id??f(),i={...t,id:r};return{id:f(),description:`Insert into ${e}`,timestamp:Date.now(),async execute(){await n.insert(e,i)},async undo(){await n.remove(e,r)}}}createUpdateCommand(e,t,n,r){const i=this.store,a={},o={};for(const l of Object.keys(r))r[l]!==n[l]&&(a[l]=r[l],o[l]=n[l]);return{id:f(),description:`Update ${e}/${t}`,timestamp:Date.now(),async execute(){await i.update(e,t,a)},async undo(){await i.update(e,t,o)}}}createDeleteCommand(e,t){const n=this.store,r=t.id,i={...t};return{id:f(),description:`Delete from ${e}/${r}`,timestamp:Date.now(),async execute(){await n.remove(e,r)},async undo(){await n.insert(e,i)}}}createBatchCommand(e,t){return{id:f(),description:e,timestamp:Date.now(),async execute(){for(const n of t)await n.execute()},async undo(){for(let n=t.length-1;n>=0;n--)await t[n].undo()}}}clear(){this.undoStack=[],this.redoStack=[],this.events.emit("history.cleared",{timestamp:g()})}}class Oe{static async register(){if(!("serviceWorker"in navigator))return null;try{const e=await navigator.serviceWorker.register("/sw.js",{scope:"/"});return e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{t.state==="activated"&&console.info("Concrete updated. Refresh for new version.")})}),e}catch(e){return console.warn("Service worker registration failed:",e),null}}static async unregister(){if(!("serviceWorker"in navigator))return;const e=await navigator.serviceWorker.getRegistrations();for(const t of e)await t.unregister()}static isOffline(){return!navigator.onLine}static onConnectivityChange(e){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t),window.addEventListener("offline",n),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}class _e{rootEl=null;topNav=null;contentArea=null;alertsPanel=null;modalLayer=null;mount(e){this.rootEl=e,e.innerHTML="",e.className="flex flex-col min-h-screen bg-[var(--surface)]",this.topNav=this.createTopNav(),e.appendChild(this.topNav),this.contentArea=document.createElement("main"),this.contentArea.id="content",this.contentArea.className="flex-1 overflow-auto p-4 lg:p-6",e.appendChild(this.contentArea),this.alertsPanel=this.createAlertsPanel(),e.appendChild(this.alertsPanel),this.modalLayer=document.createElement("div"),this.modalLayer.id="modal-layer",this.modalLayer.className="fixed inset-0 z-50 hidden",e.appendChild(this.modalLayer);const t=this.topNav.querySelector("#alerts-btn");t&&t.addEventListener("click",()=>this.toggleAlerts());const n=this.alertsPanel.querySelector("#close-alerts");n&&n.addEventListener("click",()=>this.toggleAlerts(!1))}getRoot(){return this.rootEl}getContentArea(){return this.contentArea}getModalLayer(){return this.modalLayer}getAlertsPanel(){return this.alertsPanel}getTopNav(){return this.topNav}createTopNav(){const e=document.createElement("nav");e.className="flex items-center gap-4 px-4 h-14 bg-[var(--surface-raised)] border-b border-[var(--border)] sticky top-0 z-40";const t=document.createElement("div");t.className="font-bold text-lg tracking-tight text-[var(--accent)] flex-shrink-0",t.textContent="Concrete",e.appendChild(t);const n=document.createElement("div");n.id="nav-tabs",n.className="flex items-center gap-1 overflow-x-auto flex-1 px-2",e.appendChild(n);const r=document.createElement("div");r.id="global-filters",r.className="flex items-center gap-2 flex-shrink-0",e.appendChild(r);const i=document.createElement("button");i.id="alerts-btn",i.className="btn-ghost relative p-2 rounded-md",i.setAttribute("aria-label","Notifications"),i.innerHTML='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>',e.appendChild(i);const a=document.createElement("button");return a.id="cmd-palette-btn",a.className="btn-ghost p-2 rounded-md text-xs",a.setAttribute("aria-label","Command palette"),a.innerHTML='<kbd class="px-1.5 py-0.5 bg-[var(--surface)] rounded text-2xs border border-[var(--border)]">K</kbd>',e.appendChild(a),e}createAlertsPanel(){const e=document.createElement("div");e.id="alerts-panel",e.className="fixed right-0 top-14 bottom-0 w-80 bg-[var(--surface-raised)] border-l border-[var(--border)] transform translate-x-full transition-transform z-30 overflow-y-auto";const t=document.createElement("div");t.className="flex items-center justify-between p-4 border-b border-[var(--border)]",t.innerHTML='<h2 class="font-semibold">Notifications</h2><button class="btn-ghost p-1 rounded" id="close-alerts">&times;</button>',e.appendChild(t);const n=document.createElement("div");return n.id="alerts-content",n.className="p-4 space-y-3",e.appendChild(n),e}toggleAlerts(e){if(!this.alertsPanel)return;const t=this.alertsPanel.classList.contains("translate-x-full"),n=e??t;this.alertsPanel.classList.toggle("translate-x-full",!n),this.alertsPanel.classList.toggle("translate-x-0",n)}}let T;async function P(){const s=new S,e=new L(s);e.install(),s.info("app","Concrete booting...");try{const t=new _,n=new B,r=new M(n),i=new O(r);await r.load(),s.info("app",`Environment: ${t.mode}, Build: ${t.buildTarget}`);const a=new ke;a.registerCoreSchemas();const o=new Q(a,n,s);await o.initialize();const l=new Le;await l.load(r.get("locale","en-US"));const c=new Re(o.getAdapter(),n),y=new Ne(n,r),h=new Ke(o.getAdapter(),a),d=new Me(o.getAdapter(),n),u=new Pe,m=new je(n,o,a,s);m.register($);const p=new Ae(n,m,c);for(const w of m.getAll())for(const I of w.manifest.routes)p.register({path:I.path,component:I.component,title:I.title,icon:I.icon});const b=new _e;T={logger:s,errorBoundary:e,config:r,features:i,env:t,events:n,store:o,schemas:a,modules:m,router:p,permissions:c,notifications:y,search:h,keyboard:u,i18n:l,undo:d,shell:b},t.isDev&&(window.concrete=T),n.emit("app.boot",{app:T}),t.isProd&&Oe.register().catch(w=>{s.warn("sw","Service worker registration failed",w)});const q=document.getElementById("app");q&&b.mount(q),p.start(),n.emit("app.ready",{app:T}),s.info("app","Concrete ready")}catch(t){s.fatal("app","Boot failed",t),e.showFatalError(t)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>void P()):P();export{k as a,H as b,v as g};
